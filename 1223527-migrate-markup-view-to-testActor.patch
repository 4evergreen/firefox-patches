# HG changeset patch
# User Grisha Pushkov <grisha@push.org.ru>
# Parent  489332006384610e3322739f66729448da0e98d9
Bug 1223527 - Migrate markup-view tests to use testActor

diff --git a/devtools/.eslintrc b/devtools/.eslintrc
--- a/devtools/.eslintrc
+++ b/devtools/.eslintrc
@@ -91,17 +91,17 @@
     // Enforces spacing between keys and values in object literal properties.
     "key-spacing": [1, {"beforeColon": false, "afterColon": true}],
     // Allow mixed 'LF' and 'CRLF' as linebreaks.
     "linebreak-style": 0,
     // Don't enforce the maximum depth that blocks can be nested. The complexity
     // rule is a better rule to check this.
     "max-depth": 0,
     // Maximum length of a line.
-    "max-len": [1, 80],
+    "max-len": [1, 80, 4, {"ignorePattern": ".{100,}"}],
     // Maximum depth callbacks can be nested.
     "max-nested-callbacks": [2, 3],
     // Don't limit the number of parameters that can be used in a function.
     "max-params": 0,
     // Don't limit the maximum number of statement allowed in a function. We
     // already have the complexity rule that's a better measurement.
     "max-statements": 0,
     // Require a capital letter for constructors, only check if all new
diff --git a/devtools/.eslintrc.mochitests b/devtools/.eslintrc.mochitests
--- a/devtools/.eslintrc.mochitests
+++ b/devtools/.eslintrc.mochitests
@@ -1,16 +1,17 @@
 // Parent config file for all devtools browser mochitest files.
 {
   "rules": {
     // Only disallow non-global unused vars, so that head.js does not produce
     // errors.
     "no-unused-vars": [2, {"vars": "local"}]
   },
   // All globals made available in the test environment.
+  // sort it!
   "globals": {
     "add_task": true,
     "Assert": true,
     "BrowserTestUtils": true,
     "content": true,
     "ContentTask": true,
     "document": true,
     "EventUtils": true,
@@ -35,10 +36,32 @@
     "SpecialPowers": true,
     "todo": true,
     "todo_is": true,
     "todo_isnot": true,
     "waitForClipboard": true,
     "waitForExplicitFinish": true,
     "waitForFocus": true,
     "window": true,
+    "TEST_URL_ROOT": true,
+    "getNodeFront": true,
+    "addTab": true,
+    "openInspector": true,
+    "selectNode": true,
+    "getContainerForNodeFront": true,
+    "undoChange": true,
+    "getContainerForSelector": true,
+    "waitForMultipleChildrenUpdates": true,
+    "wait": true,
+    "promiseNextTick": true,
+    "loadHelperScript": true,
+    "registerTabActor": true,
+    "unregisterActor": true,
+    "openToolbox": true,
+    "clickContainer": true,
+    "once": true,
+    "executeInContent": true,
+    "contextMenuClick": true,
+    "createTestHTTPServer": true,
+    "waitForChildrenUpdated": true,
+    "Node": true,
   }
 }
diff --git a/devtools/client/markupview/test/.eslintrc b/devtools/client/markupview/test/.eslintrc
--- a/devtools/client/markupview/test/.eslintrc
+++ b/devtools/client/markupview/test/.eslintrc
@@ -1,4 +1,26 @@
 {
   // Extend from the shared list of defined globals for mochitests.
-  "extends": "../../../.eslintrc.mochitests"
+  "extends": "../../../.eslintrc.mochitests",
+  "globals": {
+    "isEditingMenuDisabled": true,
+    "isEditingMenuEnabled": true,
+    "inplaceEditor": true,
+    "simulateNodeDrag": true,
+    "simulateNodeDragAndDrop": true,
+    "simulateNodeDrop": true,
+    "CHROME_BASE": true,
+    "runEventPopupTests": true,
+    "runEditOuterHTMLTests": true,
+    "checkFocusedAttribute": true,
+    "collapseSelectionAndTab": true,
+    "collapseSelectionAndShiftTab": true,
+    "setEditableFieldValue": true,
+    "addNewAttributes": true,
+    "setNodeAttribute": true,
+    "reloadPage": true,
+    "searchUsingSelectorSearch": true,
+    "runEditAttributesTests": true,
+    "runAddAttributesTests": true,
+    "assertAttributes": true,
+  }
 }
diff --git a/devtools/client/markupview/test/browser_markupview_anonymous_01.js b/devtools/client/markupview/test/browser_markupview_anonymous_01.js
--- a/devtools/client/markupview/test/browser_markupview_anonymous_01.js
+++ b/devtools/client/markupview/test/browser_markupview_anonymous_01.js
@@ -9,36 +9,36 @@ const TEST_URL = TEST_URL_ROOT + "doc_ma
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   let pseudo = yield getNodeFront("#pseudo", inspector);
 
   // Markup looks like: <div><::before /><span /><::after /></div>
   let children = yield inspector.walker.children(pseudo);
-  is (children.nodes.length, 3, "Children returned from walker");
+  is(children.nodes.length, 3, "Children returned from walker");
 
-  info ("Checking the ::before pseudo element");
+  info("Checking the ::before pseudo element");
   let before = children.nodes[0];
   yield isEditingMenuDisabled(before, inspector);
 
-  info ("Checking the normal child element");
+  info("Checking the normal child element");
   let span = children.nodes[1];
   yield isEditingMenuEnabled(span, inspector);
 
-  info ("Checking the ::after pseudo element");
+  info("Checking the ::after pseudo element");
   let after = children.nodes[2];
   yield isEditingMenuDisabled(after, inspector);
 
   let native = yield getNodeFront("#native", inspector);
 
   // Markup looks like: <div><video controls /></div>
   let nativeChildren = yield inspector.walker.children(native);
-  is (nativeChildren.nodes.length, 1, "Children returned from walker");
+  is(nativeChildren.nodes.length, 1, "Children returned from walker");
 
-  info ("Checking the video element");
+  info("Checking the video element");
   let video = nativeChildren.nodes[0];
-  ok (!video.isAnonymous, "<video> is not anonymous");
+  ok(!video.isAnonymous, "<video> is not anonymous");
 
   let videoChildren = yield inspector.walker.children(video);
-  is (videoChildren.nodes.length, 0,
+  is(videoChildren.nodes.length, 0,
     "No native children returned from walker for <video> by default");
 });
diff --git a/devtools/client/markupview/test/browser_markupview_anonymous_02.js b/devtools/client/markupview/test/browser_markupview_anonymous_02.js
--- a/devtools/client/markupview/test/browser_markupview_anonymous_02.js
+++ b/devtools/client/markupview/test/browser_markupview_anonymous_02.js
@@ -9,21 +9,21 @@ const TEST_URL = "chrome://devtools/cont
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   let toolbarbutton = yield getNodeFront("toolbarbutton", inspector);
   let children = yield inspector.walker.children(toolbarbutton);
 
   is(toolbarbutton.numChildren, 3, "Correct number of children");
-  is (children.nodes.length, 3, "Children returned from walker");
+  is(children.nodes.length, 3, "Children returned from walker");
 
   is(toolbarbutton.isAnonymous, false, "Toolbarbutton is not anonymous");
   yield isEditingMenuEnabled(toolbarbutton, inspector);
 
   for (let node of children.nodes) {
-    ok (node.isAnonymous, "Child is anonymous");
-    ok (node._form.isXBLAnonymous, "Child is XBL anonymous");
-    ok (!node._form.isShadowAnonymous, "Child is not shadow anonymous");
-    ok (!node._form.isNativeAnonymous, "Child is not native anonymous");
+    ok(node.isAnonymous, "Child is anonymous");
+    ok(node._form.isXBLAnonymous, "Child is XBL anonymous");
+    ok(!node._form.isShadowAnonymous, "Child is not shadow anonymous");
+    ok(!node._form.isNativeAnonymous, "Child is not native anonymous");
     yield isEditingMenuDisabled(node, inspector);
   }
 });
diff --git a/devtools/client/markupview/test/browser_markupview_anonymous_03.js b/devtools/client/markupview/test/browser_markupview_anonymous_03.js
--- a/devtools/client/markupview/test/browser_markupview_anonymous_03.js
+++ b/devtools/client/markupview/test/browser_markupview_anonymous_03.js
@@ -12,23 +12,23 @@ const TEST_URL = TEST_URL_ROOT + "doc_ma
 add_task(function*() {
   Services.prefs.setBoolPref("dom.webcomponents.enabled", true);
 
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   let shadow = yield getNodeFront("#shadow", inspector.markup);
   let children = yield inspector.walker.children(shadow);
 
-  is (shadow.numChildren, 3, "Children of the shadow root are counted");
-  is (children.nodes.length, 3, "Children returned from walker");
+  is(shadow.numChildren, 3, "Children of the shadow root are counted");
+  is(children.nodes.length, 3, "Children returned from walker");
 
-  info ("Checking the ::before pseudo element");
+  info("Checking the ::before pseudo element");
   let before = children.nodes[0];
   yield isEditingMenuDisabled(before, inspector);
 
-  info ("Checking the <h3> shadow element");
+  info("Checking the <h3> shadow element");
   let shadowChild1 = children.nodes[1];
   yield isEditingMenuDisabled(shadowChild1, inspector);
 
-  info ("Checking the <select> shadow element");
+  info("Checking the <select> shadow element");
   let shadowChild2 = children.nodes[2];
   yield isEditingMenuDisabled(shadowChild2, inspector);
 });
diff --git a/devtools/client/markupview/test/browser_markupview_anonymous_04.js b/devtools/client/markupview/test/browser_markupview_anonymous_04.js
--- a/devtools/client/markupview/test/browser_markupview_anonymous_04.js
+++ b/devtools/client/markupview/test/browser_markupview_anonymous_04.js
@@ -1,36 +1,37 @@
 /* vim: set ts=2 et sw=2 tw=80: */
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
-// Test native anonymous content in the markupview with devtools.inspector.showAllAnonymousContent
-// set to true
+// Test native anonymous content in the markupview with
+// devtools.inspector.showAllAnonymousContent set to true.
 const TEST_URL = TEST_URL_ROOT + "doc_markup_anonymous.html";
 
 add_task(function*() {
-  Services.prefs.setBoolPref("devtools.inspector.showAllAnonymousContent", true);
+  Services.prefs.setBoolPref(
+    "devtools.inspector.showAllAnonymousContent", true);
 
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   let native = yield getNodeFront("#native", inspector);
 
   // Markup looks like: <div><video controls /></div>
   let nativeChildren = yield inspector.walker.children(native);
-  is (nativeChildren.nodes.length, 1, "Children returned from walker");
+  is(nativeChildren.nodes.length, 1, "Children returned from walker");
 
-  info ("Checking the video element");
+  info("Checking the video element");
   let video = nativeChildren.nodes[0];
-  ok (!video.isAnonymous, "<video> is not anonymous");
+  ok(!video.isAnonymous, "<video> is not anonymous");
 
   let videoChildren = yield inspector.walker.children(video);
-  is (videoChildren.nodes.length, 3, "<video> has native anonymous children");
+  is(videoChildren.nodes.length, 3, "<video> has native anonymous children");
 
   for (let node of videoChildren.nodes) {
-    ok (node.isAnonymous, "Child is anonymous");
-    ok (!node._form.isXBLAnonymous, "Child is not XBL anonymous");
-    ok (!node._form.isShadowAnonymous, "Child is not shadow anonymous");
-    ok (node._form.isNativeAnonymous, "Child is native anonymous");
+    ok(node.isAnonymous, "Child is anonymous");
+    ok(!node._form.isXBLAnonymous, "Child is not XBL anonymous");
+    ok(!node._form.isShadowAnonymous, "Child is not shadow anonymous");
+    ok(node._form.isNativeAnonymous, "Child is native anonymous");
     yield isEditingMenuDisabled(node, inspector);
   }
 });
diff --git a/devtools/client/markupview/test/browser_markupview_copy_image_data.js b/devtools/client/markupview/test/browser_markupview_copy_image_data.js
--- a/devtools/client/markupview/test/browser_markupview_copy_image_data.js
+++ b/devtools/client/markupview/test/browser_markupview_copy_image_data.js
@@ -2,72 +2,72 @@
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
 // Test that image nodes have the "copy data-uri" contextual menu item enabled
 // and that clicking it puts the image data into the clipboard
 
-const PAGE_CONTENT = [
-  '<div></div>',
-  '<img class="data" src="data:image/png;base64,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" />',
-  '<canvas class="canvas" width="600" height="600"></canvas>'
-].join("\n");
+const TEST_URL = `
+  data:text/html;charset=utf-8,
+  <div></div>
+  <img class="data" src="data:image/png;base64,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">
+  <canvas class="canvas" width="600" height="600"></canvas>`;
 
 add_task(function*() {
-  yield addTab("data:text/html,markup view copy image as data-uri");
-  createDocument();
-  let doc = content.document;
-
-  let {inspector} = yield openInspector();
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
+  let expectedClipboard;
 
   yield selectNode("div", inspector);
   yield assertCopyImageDataNotAvailable(inspector);
 
+  expectedClipboard = yield testActor.getProperty("img", "src");
   yield selectNode("img", inspector);
   yield assertCopyImageDataAvailable(inspector);
-  yield triggerCopyImageUrlAndWaitForClipboard(doc.querySelector("img").src, inspector);
+  yield triggerCopyImageUrlAndWaitForClipboard(expectedClipboard, inspector);
 
+  yield drawOnCanvas(testActor);
+  expectedClipboard =
+    yield testActor.eval("document.querySelector('.canvas').toDataURL()");
   yield selectNode("canvas", inspector);
   yield assertCopyImageDataAvailable(inspector);
-  let canvas = doc.querySelector(".canvas");
-  yield triggerCopyImageUrlAndWaitForClipboard(canvas.toDataURL(), inspector);
+  yield triggerCopyImageUrlAndWaitForClipboard(expectedClipboard, inspector);
 
   // Check again that the menu isn't available on the DIV (to make sure our
   // menu updating mechanism works)
   yield selectNode("div", inspector);
   yield assertCopyImageDataNotAvailable(inspector);
 });
 
-function createDocument() {
-  let doc = content.document;
-
-  doc.body.innerHTML = PAGE_CONTENT;
-  let context = doc.querySelector(".canvas").getContext("2d");
-  context.beginPath();
-  context.moveTo(300, 0);
-  context.lineTo(600, 600);
-  context.lineTo(0, 600);
-  context.closePath();
-  context.fillStyle = "#ffc821";
-  context.fill();
+function* drawOnCanvas(testActor) {
+  yield testActor.eval(`
+    let context = document.querySelector(".canvas").getContext("2d");
+    context.beginPath();
+    context.moveTo(300, 0);
+    context.lineTo(600, 600);
+    context.lineTo(0, 600);
+    context.closePath();
+    context.fillStyle = "#ffc821";
+    context.fill();`);
 }
 
 function assertCopyImageDataNotAvailable(inspector) {
   return openNodeMenu(inspector).then(menu => {
-    let item = menu.getElementsByAttribute("id", "node-menu-copyimagedatauri")[0];
+    let item =
+      menu.getElementsByAttribute("id", "node-menu-copyimagedatauri")[0];
     ok(item, "The menu item was found in the contextual menu");
     is(item.getAttribute("disabled"), "true", "The menu item is disabled");
   }).then(() => closeNodeMenu(inspector));
 }
 
 function assertCopyImageDataAvailable(inspector) {
   return openNodeMenu(inspector).then(menu => {
-    let item = menu.getElementsByAttribute("id", "node-menu-copyimagedatauri")[0];
+    let item =
+      menu.getElementsByAttribute("id", "node-menu-copyimagedatauri")[0];
     ok(item, "The menu item was found in the contextual menu");
     is(item.getAttribute("disabled"), "", "The menu item is enabled");
   }).then(() => closeNodeMenu(inspector));
 }
 
 function openNodeMenu(inspector) {
   let def = promise.defer();
 
@@ -93,19 +93,22 @@ function closeNodeMenu(inspector) {
 
   return def.promise;
 }
 
 function triggerCopyImageUrlAndWaitForClipboard(expected, inspector) {
   let def = promise.defer();
 
   SimpleTest.waitForClipboard(expected, () => {
-    inspector.markup.getContainer(inspector.selection.nodeFront).copyImageDataUri();
+    inspector.markup.getContainer(inspector.selection.nodeFront)
+      .copyImageDataUri();
   }, () => {
-    ok(true, "The clipboard contains the expected value " + expected.substring(0, 50) + "...");
+    ok(true, "The clipboard contains the expected value "
+      + expected.substring(0, 50) + "...");
     def.resolve();
   }, () => {
-    ok(false, "The clipboard doesn't contain the expected value " + expected.substring(0, 50) + "...");
+    ok(false, "The clipboard doesn't contain the expected value "
+      + expected.substring(0, 50) + "...");
     def.resolve();
   });
 
   return def.promise;
 }
diff --git a/devtools/client/markupview/test/browser_markupview_css_completion_style_attribute.js b/devtools/client/markupview/test/browser_markupview_css_completion_style_attribute.js
--- a/devtools/client/markupview/test/browser_markupview_css_completion_style_attribute.js
+++ b/devtools/client/markupview/test/browser_markupview_css_completion_style_attribute.js
@@ -17,71 +17,71 @@ const TEST_URL = TEST_URL_ROOT + "doc_ma
 //  [
 //    what key to press,
 //    expected input box value after keypress,
 //    expected input.selectionStart,
 //    expected input.selectionEnd,
 //    is popup expected to be open ?
 //  ]
 const TEST_DATA = [
-  ['s', 's', 1, 1, false],
-  ['t', 'st', 2, 2, false],
-  ['y', 'sty', 3, 3, false],
-  ['l', 'styl', 4, 4, false],
-  ['e', 'style', 5, 5, false],
-  ['=', 'style=', 6, 6, false],
-  ['"', 'style="', 7, 7, false],
-  ['d', 'style="direction', 8, 16, true],
-  ['VK_DOWN', 'style="display', 8, 14, true],
-  ['VK_TAB', 'style="display', 14, 14, true],
-  ['VK_TAB', 'style="dominant-baseline', 24, 24, true],
-  ['VK_TAB', 'style="direction', 16, 16, true],
-  ['click_1', 'style="display', 14, 14, false],
-  [':', 'style="display:-moz-box', 15, 23, true],
-  ['n', 'style="display:none', 16, 19, false],
-  ['VK_BACK_SPACE', 'style="display:n', 16, 16, false],
-  ['VK_BACK_SPACE', 'style="display:', 15, 15, false],
-  [' ', 'style="display: -moz-box', 16, 24, true],
-  [' ', 'style="display:  -moz-box', 17, 25, true],
-  ['i', 'style="display:  inherit', 18, 24, true],
-  ['VK_RIGHT', 'style="display:  inherit', 24, 24, false],
-  [';', 'style="display:  inherit;', 25, 25, false],
-  [' ', 'style="display:  inherit; ', 26, 26, false],
-  [' ', 'style="display:  inherit;  ', 27, 27, false],
-  ['VK_LEFT', 'style="display:  inherit;  ', 26, 26, false],
-  ['c', 'style="display:  inherit; caption-side ', 27, 38, true],
-  ['o', 'style="display:  inherit; color ', 28, 31, true],
-  ['VK_RIGHT', 'style="display:  inherit; color ', 31, 31, false],
-  [' ', 'style="display:  inherit; color  ', 32, 32, false],
-  ['c', 'style="display:  inherit; color c ', 33, 33, false],
-  ['VK_BACK_SPACE', 'style="display:  inherit; color  ', 32, 32, false],
-  [':', 'style="display:  inherit; color :aliceblue ', 33, 42, true],
-  ['c', 'style="display:  inherit; color :cadetblue ', 34, 42, true],
-  ['VK_DOWN', 'style="display:  inherit; color :chartreuse ', 34, 43, true],
-  ['VK_RIGHT', 'style="display:  inherit; color :chartreuse ', 43, 43, false],
-  [' ', 'style="display:  inherit; color :chartreuse !important; ', 44, 55, true],
-  ['!', 'style="display:  inherit; color :chartreuse !important; ', 45, 55, false],
-  ['VK_RIGHT', 'style="display:  inherit; color :chartreuse !important; ', 55, 55, false],
-  ['VK_RETURN', 'style="display:  inherit; color :chartreuse !important;"', -1, -1, false]
+  ["s", "s", 1, 1, false],
+  ["t", "st", 2, 2, false],
+  ["y", "sty", 3, 3, false],
+  ["l", "styl", 4, 4, false],
+  ["e", "style", 5, 5, false],
+  ["=", "style=", 6, 6, false],
+  ["\"", "style='", 7, 7, false],
+  ["d", "style='direction", 8, 16, true],
+  ["VK_DOWN", "style='display", 8, 14, true],
+  ["VK_TAB", "style='display", 14, 14, true],
+  ["VK_TAB", "style='dominant-baseline", 24, 24, true],
+  ["VK_TAB", "style='direction", 16, 16, true],
+  ["click_1", "style='display", 14, 14, false],
+  [":", "style='display:-moz-box", 15, 23, true],
+  ["n", "style='display:none", 16, 19, false],
+  ["VK_BACK_SPACE", "style='display:n", 16, 16, false],
+  ["VK_BACK_SPACE", "style='display:", 15, 15, false],
+  [" ", "style='display: -moz-box", 16, 24, true],
+  [" ", "style='display:  -moz-box", 17, 25, true],
+  ["i", "style='display:  inherit", 18, 24, true],
+  ["VK_RIGHT", "style='display:  inherit", 24, 24, false],
+  [";", "style='display:  inherit;", 25, 25, false],
+  [" ", "style='display:  inherit; ", 26, 26, false],
+  [" ", "style='display:  inherit;  ", 27, 27, false],
+  ["VK_LEFT", "style='display:  inherit;  ", 26, 26, false],
+  ["c", "style='display:  inherit; caption-side ", 27, 38, true],
+  ["o", "style='display:  inherit; color ", 28, 31, true],
+  ["VK_RIGHT", "style='display:  inherit; color ", 31, 31, false],
+  [" ", "style='display:  inherit; color  ", 32, 32, false],
+  ["c", "style='display:  inherit; color c ", 33, 33, false],
+  ["VK_BACK_SPACE", "style='display:  inherit; color  ", 32, 32, false],
+  [":", "style='display:  inherit; color :aliceblue ", 33, 42, true],
+  ["c", "style='display:  inherit; color :cadetblue ", 34, 42, true],
+  ["VK_DOWN", "style='display:  inherit; color :chartreuse ", 34, 43, true],
+  ["VK_RIGHT", "style='display:  inherit; color :chartreuse ", 43, 43, false],
+  [" ", "style='display:  inherit; color :chartreuse !important; ", 44, 55, true],
+  ["!", "style='display:  inherit; color :chartreuse !important; ", 45, 55, false],
+  ["VK_RIGHT", "style='display:  inherit; color :chartreuse !important; ", 55, 55, false],
+  ["VK_RETURN", "style='display:  inherit; color :chartreuse !important;'", -1, -1, false]
 ];
 
 add_task(function*() {
   info("Opening the inspector on the test URL");
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   yield inspector.markup.expandAll();
 
   let nodeFront = yield getNodeFront("#node14", inspector);
   let container = getContainerForNodeFront(nodeFront, inspector);
   let attr = container.editor.newAttr;
   attr.focus();
   EventUtils.sendKey("return", inspector.panelWin);
   let editor = inplaceEditor(attr);
 
-  for (let i = 0; i < TEST_DATA.length; i ++) {
+  for (let i = 0; i < TEST_DATA.length; i++) {
     yield enterData(i, editor, inspector);
     yield checkData(i, editor, inspector);
   }
 
   while (inspector.markup.undo.canUndo()) {
     yield undoChange(inspector);
   }
 });
@@ -117,28 +117,31 @@ function enterData(index, editor, inspec
     });
   }
   EventUtils.synthesizeKey(key, {}, inspector.panelWin);
 
   return def.promise;
 }
 
 function* checkData(index, editor, inspector) {
-  let [key, completion, selStart, selEnd, popupOpen] = TEST_DATA[index];
+  let [completion, selStart, selEnd, popupOpen] = TEST_DATA[index];
   info("Test data " + index + " entered. Checking state.");
 
   if (selEnd != -1) {
     is(editor.input.value, completion, "Completed value is correct");
-    is(editor.input.selectionStart, selStart, "Selection start position is correct");
-    is(editor.input.selectionEnd, selEnd, "Selection end position is correct");
+    is(editor.input.selectionStart, selStart,
+      "Selection start position is correct");
+    is(editor.input.selectionEnd, selEnd,
+      "Selection end position is correct");
     if (popupOpen) {
       ok(editor.popup.isOpen, "Popup is open");
     } else {
-      ok(editor.popup._panel.state != "open" && editor.popup._panel.state != "showing",
-        "Popup is closed");
+      ok(editor.popup._panel.state != "open" &&
+         editor.popup._panel.state != "showing", "Popup is closed");
     }
   } else {
     let nodeFront = yield getNodeFront("#node14", inspector);
-    let editor = getContainerForNodeFront(nodeFront, inspector).editor;
+    editor = getContainerForNodeFront(nodeFront, inspector).editor;
     let attr = editor.attrElements.get("style").querySelector(".editable");
-    is(attr.textContent, completion, "Correct value is persisted after pressing Enter");
+    is(attr.textContent, completion,
+      "Correct value is persisted after pressing Enter");
   }
 }
diff --git a/devtools/client/markupview/test/browser_markupview_dragdrop_tooltip.js b/devtools/client/markupview/test/browser_markupview_dragdrop_tooltip.js
--- a/devtools/client/markupview/test/browser_markupview_dragdrop_tooltip.js
+++ b/devtools/client/markupview/test/browser_markupview_dragdrop_tooltip.js
@@ -15,20 +15,20 @@ add_task(function*() {
   info("Check that the src attribute of the image is a valid tooltip target");
   let isValid = yield markup.tooltip.isValidHoverTarget(target);
   ok(isValid, "The element is a valid tooltip target");
 
   info("Start dragging the test div");
   yield simulateNodeDrag(inspector, "div");
 
   info("Now check that the src attribute of the image isn't a valid target");
-  try{
+  try {
     yield markup.tooltip.isValidHoverTarget(target);
     isValid = true;
-  } catch(e) {
+  } catch (e) {
     isValid = false;
   }
   ok(!isValid, "The element is not a valid tooltip target");
 
   info("Stop dragging the test div");
   yield simulateNodeDrop(inspector, "div");
 
   info("Check again the src attribute of the image");
diff --git a/devtools/client/markupview/test/browser_markupview_events-overflow.js b/devtools/client/markupview/test/browser_markupview_events-overflow.js
--- a/devtools/client/markupview/test/browser_markupview_events-overflow.js
+++ b/devtools/client/markupview/test/browser_markupview_events-overflow.js
@@ -2,18 +2,20 @@
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 "use strict";
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_events-overflow.html";
 const TEST_DATA = [
   {
     desc: "editor overflows container",
-    initialScrollTop: -1, // scroll to bottom
-    headerToClick: 49, // last header
+    // scroll to bottom
+    initialScrollTop: -1,
+    // last header
+    headerToClick: 49,
     alignBottom: true,
     alignTop: false,
   },
   {
     desc: "header overflows the container",
     initialScrollTop: 2,
     headerToClick: 0,
     alignBottom: false,
@@ -31,17 +33,18 @@ const TEST_DATA = [
 add_task(function*() {
   let { inspector } = yield addTab(TEST_URL).then(openInspector);
 
   let markupContainer = yield getContainerForSelector("#events", inspector);
   let evHolder = markupContainer.elt.querySelector(".markupview-events");
   let tooltip = inspector.markup.tooltip;
 
   info("Clicking to open event tooltip.");
-  EventUtils.synthesizeMouseAtCenter(evHolder, {}, inspector.markup.doc.defaultView);
+  EventUtils.synthesizeMouseAtCenter(evHolder, {},
+    inspector.markup.doc.defaultView);
   yield tooltip.once("shown");
   info("EventTooltip visible.");
 
   let container = tooltip.content;
   let containerRect = container.getBoundingClientRect();
   let headers = container.querySelectorAll(".event-header");
 
   for (let data of TEST_DATA) {
@@ -70,21 +73,19 @@ add_task(function*() {
     // Wait for any scrolling to finish.
     yield promiseNextTick();
 
     if (data.alignTop) {
       let headerRect = header.getBoundingClientRect();
 
       is(Math.round(headerRect.top), Math.round(containerRect.top),
         "Clicked header is aligned with the container top.");
-
     } else if (data.alignBottom) {
       let editorRect = header.nextElementSibling.getBoundingClientRect();
 
       is(Math.round(editorRect.bottom), Math.round(containerRect.bottom),
         "Clicked event handler code is aligned with the container bottom.");
-
     } else {
       is(container.scrollTop, data.initialScrollTop,
         "Container did not scroll, as expected.");
     }
   }
 });
diff --git a/devtools/client/markupview/test/browser_markupview_events.js b/devtools/client/markupview/test/browser_markupview_events.js
--- a/devtools/client/markupview/test/browser_markupview_events.js
+++ b/devtools/client/markupview/test/browser_markupview_events.js
@@ -31,51 +31,51 @@ const TEST_DATA = [
     expected: [
       {
         type: "mouseover",
         filename: TEST_URL + ":62",
         attributes: [
           "Capturing",
           "DOM2"
         ],
-        handler: 'function mouseoverHandler(event) {\n' +
-                 '  if (event.target.id !== "container") {\n' +
-                 '    let output = document.getElementById("output");\n' +
-                 '    output.textContent = event.target.textContent;\n' +
-                 '  }\n' +
-                 '}'
+        handler: "function mouseoverHandler(event) {\n" +
+                 "  if (event.target.id !== \"container\") {\n" +
+                 "    let output = document.getElementById(\"output\");\n" +
+                 "    output.textContent = event.target.textContent;\n" +
+                 "  }\n" +
+                 "}"
       }
     ]
   },
   {
     selector: "#multiple",
     expected: [
       {
         type: "click",
         filename: TEST_URL + ":69",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'function clickHandler(event) {\n' +
-                 '  let output = document.getElementById("output");\n' +
-                 '  output.textContent = "click";\n' +
-                 '}'
+        handler: "function clickHandler(event) {\n" +
+                 "  let output = document.getElementById(\"output\");\n" +
+                 "  output.textContent = \"click\";\n" +
+                 "}"
       },
       {
         type: "mouseup",
         filename: TEST_URL + ":78",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'function mouseupHandler(event) {\n' +
-                 '  let output = document.getElementById("output");\n' +
-                 '  output.textContent = "mouseup";\n' +
-                 '}'
+        handler: "function mouseupHandler(event) {\n" +
+                 "  let output = document.getElementById(\"output\");\n" +
+                 "  output.textContent = \"mouseup\";\n" +
+                 "}"
       }
     ]
   },
   {
     selector: "#DOM0",
     expected: [
       {
         type: "click",
@@ -93,65 +93,65 @@ const TEST_DATA = [
     expected: [
       {
         type: "click",
         filename: TEST_URL + ":89",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'handleEvent: function(blah) {\n' +
-                 '  alert("handleEvent clicked");\n' +
-                 '}'
+        handler: "handleEvent: function(blah) {\n" +
+                 "  alert(\"handleEvent clicked\");\n" +
+                 "}"
       }
     ]
   },
   {
     selector: "#fatarrow",
     expected: [
       {
         type: "click",
         filename: TEST_URL + ":57",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'event => {\n' +
-                 '  alert("Yay for the fat arrow!");\n' +
-                 '}'
+        handler: "event => {\n" +
+                 "  alert(\"Yay for the fat arrow!\");\n" +
+                 "}"
       }
     ]
   },
   {
     selector: "#boundhe",
     expected: [
       {
         type: "click",
         filename: TEST_URL + ":101",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'handleEvent: function() {\n' +
-                 '  alert("boundHandleEvent clicked");\n' +
-                 '}'
+        handler: "handleEvent: function() {\n" +
+                 "  alert(\"boundHandleEvent clicked\");\n" +
+                 "}"
       }
     ]
   },
   {
     selector: "#bound",
     expected: [
       {
         type: "click",
         filename: TEST_URL + ":74",
         attributes: [
           "Bubbling",
           "DOM2"
         ],
-        handler: 'function boundClickHandler(event) {\n' +
-                 '  alert("Bound event clicked");\n' +
-                 '}'
+        handler: "function boundClickHandler(event) {\n" +
+                 "  alert(\"Bound event clicked\");\n" +
+                 "}"
       }
     ]
   },
 ];
 
 add_task(runEventPopupTests);
diff --git a/devtools/client/markupview/test/browser_markupview_events_form.js b/devtools/client/markupview/test/browser_markupview_events_form.js
--- a/devtools/client/markupview/test/browser_markupview_events_form.js
+++ b/devtools/client/markupview/test/browser_markupview_events_form.js
@@ -12,17 +12,17 @@
 const TEST_PAGE_URL = TEST_URL_ROOT + "doc_markup_events_form.html";
 const TEST_ACTOR_URL = CHROME_BASE + "actor_events_form.js";
 
 var {ActorRegistryFront} = require("devtools/server/actors/actor-registry");
 var {EventsFormFront} = require(TEST_ACTOR_URL);
 
 add_task(function*() {
   info("Opening the Toolbox");
-  let {tab} = yield addTab(TEST_PAGE_URL);
+  yield addTab(TEST_PAGE_URL);
   let {toolbox} = yield openToolbox("webconsole");
 
   info("Registering test actor");
   let {registrar, front} = yield registerTestActor(toolbox);
 
   info("Selecting the Inspector panel");
   let inspector = yield toolbox.selectTool("inspector");
   let container = yield getContainerForSelector("#container", inspector);
diff --git a/devtools/client/markupview/test/browser_markupview_html_edit_01.js b/devtools/client/markupview/test/browser_markupview_html_edit_01.js
--- a/devtools/client/markupview/test/browser_markupview_html_edit_01.js
+++ b/devtools/client/markupview/test/browser_markupview_html_edit_01.js
@@ -8,70 +8,89 @@
 
 loadHelperScript("helper_outerhtml_test_runner.js");
 
 const TEST_DATA = [
   {
     selector: "#one",
     oldHTML: '<div id="one">First <em>Div</em></div>',
     newHTML: '<div id="one">First Div</div>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront) {
-      is(pageNode.textContent, "First Div", "New div has expected text content");
-      ok(!getNode("#one em"), "No em remaining")
+    validate: function*(data, inspector, testActor) {
+      let {selector, selectedNodeFront} = data;
+
+      is((yield testActor.getProperty(selector, "textContent")), "First Div",
+        "New div has expected text content");
+      ok(!(yield testActor.hasNode("#one em")), "No em remaining")
     }
   },
   {
     selector: "#removedChildren",
     oldHTML: '<div id="removedChildren">removedChild <i>Italic <b>Bold <u>Underline</u></b></i> Normal</div>',
     newHTML: '<div id="removedChildren">removedChild</div>'
   },
   {
     selector: "#addedChildren",
     oldHTML: '<div id="addedChildren">addedChildren</div>',
     newHTML: '<div id="addedChildren">addedChildren <i>Italic <b>Bold <u>Underline</u></b></i> Normal</div>'
   },
   {
     selector: "#addedAttribute",
     oldHTML: '<div id="addedAttribute">addedAttribute</div>',
     newHTML: '<div id="addedAttribute" class="important" disabled checked>addedAttribute</div>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront) {
+    validate: function*(data, inspector, testActor) {
+      let {selector, pageNodeFront, selectedNodeFront} = data;
+      let expectedOuterHTML = '<div id="addedAttribute" class="important" ' +
+                              'disabled="" checked="">addedAttribute</div>';
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-      is(pageNode.outerHTML, '<div id="addedAttribute" class="important" disabled="" checked="">addedAttribute</div>',
-            "Attributes have been added");
+      is((yield testActor.getProperty(selector, "outerHTML")),
+        expectedOuterHTML, "Attributes have been added");
     }
   },
   {
     selector: "#changedTag",
     oldHTML: '<div id="changedTag">changedTag</div>',
     newHTML: '<p id="changedTag" class="important">changedTag</p>'
   },
   {
     selector: "#siblings",
     oldHTML: '<div id="siblings">siblings</div>',
     newHTML: '<div id="siblings-before-sibling">before sibling</div>' +
              '<div id="siblings">siblings (updated)</div>' +
              '<div id="siblings-after-sibling">after sibling</div>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
-      let beforeSibling = getNode("#siblings-before-sibling");
-      let beforeSiblingFront = yield getNodeFront("#siblings-before-sibling", inspector);
-      let afterSibling = getNode("#siblings-after-sibling");
+    validate: function*(data, inspector, testActor) {
+      let {selector, selectedNodeFront} = data;
+
+      let [
+        beforeSiblingFront,
+        beforeSiblingText,
+        afterSiblingText,
+        selectedNodeText
+      ] = [
+        yield getNodeFront("#siblings-before-sibling", inspector),
+        yield testActor.getProperty("#siblings-before-sibling", "textContent"),
+        yield testActor.getProperty("#siblings-after-sibling", "textContent"),
+        yield testActor.getProperty(selector, "textContent")
+      ];
 
       is(beforeSiblingFront, selectedNodeFront, "Sibling has been selected");
-      is(pageNode.textContent, "siblings (updated)", "New div has expected text content");
-      is(beforeSibling.textContent, "before sibling", "Sibling has been inserted");
-      is(afterSibling.textContent, "after sibling", "Sibling has been inserted");
+      is(selectedNodeText, "siblings (updated)",
+        "New div has expected text content");
+      is(beforeSiblingText, "before sibling", "Sibling has been inserted");
+      is(afterSiblingText, "after sibling", "Sibling has been inserted");
     }
   }
 ];
 
 const TEST_URL = "data:text/html," +
   "<!DOCTYPE html>" +
   "<head><meta charset='utf-8' /></head>" +
   "<body>" +
   TEST_DATA.map(outer => outer.oldHTML).join("\n") +
   "</body>" +
   "</html>";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
+
   inspector.markup._frame.focus();
-  yield runEditOuterHTMLTests(TEST_DATA, inspector);
+  yield runEditOuterHTMLTests(TEST_DATA, inspector, testActor);
 });
diff --git a/devtools/client/markupview/test/browser_markupview_html_edit_02.js b/devtools/client/markupview/test/browser_markupview_html_edit_02.js
--- a/devtools/client/markupview/test/browser_markupview_html_edit_02.js
+++ b/devtools/client/markupview/test/browser_markupview_html_edit_02.js
@@ -9,93 +9,129 @@
 loadHelperScript("helper_outerhtml_test_runner.js");
 requestLongerTimeout(2);
 
 const TEST_DATA = [
   {
     selector: "#badMarkup1",
     oldHTML: '<div id="badMarkup1">badMarkup1</div>',
     newHTML: '<div id="badMarkup1">badMarkup1</div> hanging</div>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
+    validate: function*(data, inspector, testActor) {
+      let {selector, pageNodeFront, selectedNodeFront} = data;
+
+      let textNodeNodeName = yield testActor.eval(
+        `document.querySelector("${selector}").nextSibling.nodeName`);
+      let textNodeData = yield testActor.eval(
+        `document.querySelector("${selector}").nextSibling.data`);
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-
-      let textNode = pageNode.nextSibling;
-
-      is(textNode.nodeName, "#text", "Sibling is a text element");
-      is(textNode.data, " hanging", "New text node has expected text content");
+      is(textNodeNodeName, "#text", "Sibling is a text element");
+      is(textNodeData, " hanging", "New text node has expected text content");
     }
   },
   {
     selector: "#badMarkup2",
     oldHTML: '<div id="badMarkup2">badMarkup2</div>',
     newHTML: '<div id="badMarkup2">badMarkup2</div> hanging<div></div></div></div></body>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
+    validate: function*(data, inspector, testActor) {
+      let {selector, pageNodeFront, selectedNodeFront} = data;
+
+      let textNodeNodeName = yield testActor.eval(
+        `document.querySelector("${selector}").nextSibling.nodeName`);
+      let textNodeData = yield testActor.eval(
+        `document.querySelector("${selector}").nextSibling.data`);
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-
-      let textNode = pageNode.nextSibling;
-
-      is(textNode.nodeName, "#text", "Sibling is a text element");
-      is(textNode.data, " hanging", "New text node has expected text content");
+      is(textNodeNodeName, "#text", "Sibling is a text element");
+      is(textNodeData, " hanging", "New text node has expected text content");
     }
   },
   {
     selector: "#badMarkup3",
     oldHTML: '<div id="badMarkup3">badMarkup3</div>',
     newHTML: '<div id="badMarkup3">badMarkup3 <em>Emphasized <strong> and strong</div>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
+    validate: function*(data, inspector, testActor) {
+      let {pageNodeFront, selectedNodeFront} = data;
+
+      let emTextContent = yield testActor.eval(
+        "document.querySelector('#badMarkup3 em').textContent");
+      let strongTextContent = yield testActor.eval(
+        "document.querySelector('#badMarkup3 strong').textContent");
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-
-      let em = getNode("#badMarkup3 em");
-      let strong = getNode("#badMarkup3 strong");
-
-      is(em.textContent, "Emphasized  and strong", "<em> was auto created");
-      is(strong.textContent, " and strong", "<strong> was auto created");
+      is(emTextContent, "Emphasized  and strong", "<em> was auto created");
+      is(strongTextContent, " and strong", "<strong> was auto created");
     }
   },
   {
     selector: "#badMarkup4",
     oldHTML: '<div id="badMarkup4">badMarkup4</div>',
     newHTML: '<div id="badMarkup4">badMarkup4</p>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
+    validate: function*(data, inspector, testActor) {
+      let {pageNodeFront, selectedNodeFront} = data;
+
+      let querySelector = "document.querySelector('#badMarkup4";
+      let [
+        divTextContent,
+        divTagName,
+        pTextContent,
+        pTagName
+      ] = [
+        yield testActor.eval(querySelector + "').textContent"),
+        yield testActor.eval(querySelector + "').tagName"),
+        yield testActor.eval(querySelector + " p').textContent"),
+        yield testActor.eval(querySelector + " p').tagName"),
+      ];
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-
-      let div = getNode("#badMarkup4");
-      let p = getNode("#badMarkup4 p");
-
-      is(div.textContent, "badMarkup4", "textContent is correct");
-      is(div.tagName, "DIV", "did not change to <p> tag");
-      is(p.textContent, "", "The <p> tag has no children");
-      is(p.tagName, "P", "Created an empty <p> tag");
+      is(divTextContent, "badMarkup4", "textContent is correct");
+      is(divTagName, "DIV", "did not change to <p> tag");
+      is(pTextContent, "", "The <p> tag has no children");
+      is(pTagName, "P", "Created an empty <p> tag");
     }
   },
   {
     selector: "#badMarkup5",
     oldHTML: '<p id="badMarkup5">badMarkup5</p>',
     newHTML: '<p id="badMarkup5">badMarkup5 <div>with a nested div</div></p>',
-    validate: function*(pageNode, pageNodeFront, selectedNodeFront, inspector) {
+    validate: function*(data, inspector, testActor) {
+      let {pageNodeFront, selectedNodeFront} = data;
+
+      let querySelector = "document.querySelector('#badMarkup5";
+      let [
+        nodiv,
+        pTagName,
+        pTextContent,
+        divTagName,
+        divTextContent
+      ] = [
+        yield testActor.eval(querySelector + " div')"),
+        yield testActor.eval(querySelector + "').tagName"),
+        yield testActor.eval(querySelector + "').textContent"),
+        yield testActor.eval(querySelector + " ~ div').tagName"),
+        yield testActor.eval(querySelector + " ~ div').textContent")
+      ];
+
       is(pageNodeFront, selectedNodeFront, "Original element is selected");
-
-      let p = getNode("#badMarkup5");
-      let nodiv = getNode("#badMarkup5 div");
-      let div = getNode("#badMarkup5 ~ div");
-
       ok(!nodiv, "The invalid markup got created as a sibling");
-      is(p.textContent, "badMarkup5 ", "The <p> tag does not take in the <div> content");
-      is(p.tagName, "P", "Did not change to a <div> tag");
-      is(div.textContent, "with a nested div", "textContent is correct");
-      is(div.tagName, "DIV", "Did not change to <p> tag");
+      is(pTextContent, "badMarkup5 ",
+        "The <p> tag does not take in the <div> content");
+      is(pTagName, "P", "Did not change to a <div> tag");
+      is(divTextContent, "with a nested div", "textContent is correct");
+      is(divTagName, "DIV", "Did not change to <p> tag");
     }
   }
 ];
 
 const TEST_URL = "data:text/html," +
   "<!DOCTYPE html>" +
   "<head><meta charset='utf-8' /></head>" +
   "<body>" +
   TEST_DATA.map(outer => outer.oldHTML).join("\n") +
   "</body>" +
   "</html>";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
+
   inspector.markup._frame.focus();
-  yield runEditOuterHTMLTests(TEST_DATA, inspector);
+  yield runEditOuterHTMLTests(TEST_DATA, inspector, testActor);
 });
diff --git a/devtools/client/markupview/test/browser_markupview_html_edit_03.js b/devtools/client/markupview/test/browser_markupview_html_edit_03.js
--- a/devtools/client/markupview/test/browser_markupview_html_edit_03.js
+++ b/devtools/client/markupview/test/browser_markupview_html_edit_03.js
@@ -2,181 +2,192 @@
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
 // Test that outerHTML editing keybindings work as expected and that *special*
 // elements like <html>, <body> and <head> can be edited correctly.
 
-const TEST_URL = "data:text/html," +
+const TEST_URL =
+  "data:text/html," +
   "<!DOCTYPE html>" +
   "<head><meta charset='utf-8' /></head>" +
   "<body>" +
   "<div id=\"keyboard\"></div>" +
   "</body>" +
   "</html>";
 const SELECTOR = "#keyboard";
 const OLD_HTML = '<div id="keyboard"></div>';
 const NEW_HTML = '<div id="keyboard">Edited</div>';
 
 requestLongerTimeout(2);
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
-
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
   inspector.markup._frame.focus();
 
-  info("Checking that pressing escape cancels edits");
   yield testEscapeCancels(inspector);
+  yield testF2Commits(inspector);
+  yield testBody(inspector);
+  yield testHead(inspector, testActor);
 
-  info("Checking that pressing F2 commits edits");
-  yield testF2Commits(inspector);
+  yield testDocumentElement(inspector, testActor, {
+    info: "Checking that editing the <html> element works like other nodes",
+    html: '<html id="updated" foo="bar"><head><title>Updated from document element</title><script>document.body.id="executed";</script></head><body><p>Hello</p></body></html>',
+    title: "Updated from document element",
+    id: "updated",
+    class: null,
+    foo: "bar",
+    bodyTextContent: "Hello"
+  });
 
-  info("Checking that editing the <body> element works like other nodes");
-  yield testBody(inspector);
-
-  info("Checking that editing the <head> element works like other nodes");
-  yield testHead(inspector);
-
-  info("Checking that editing the <html> element works like other nodes");
-  yield testDocumentElement(inspector);
-
-  info("Checking (again) that editing the <html> element works like other nodes");
-  yield testDocumentElement2(inspector);
+  yield testDocumentElement(inspector, testActor, {
+    info: "Checking (again) that editing the <html> element works like other nodes",
+    html: '<html class="updated" id="somethingelse"><head><title>Updated again from document element</title><script>document.body.id="executed";</script></head><body><p>Hello again</p></body></html>',
+    title: "Updated again from document element",
+    id: "somethingelse",
+    class: "updated",
+    foo: null,
+    bodyTextContent: "Hello again"
+  });
 });
 
-function testEscapeCancels(inspector) {
-  let def = promise.defer();
-  let node = getNode(SELECTOR);
+function* testEscapeCancels(inspector) {
+  info("Checking that pressing escape cancels edits");
 
-  selectNode(SELECTOR, inspector).then(() => {
-    inspector.markup.htmlEditor.on("popupshown", function onPopupShown() {
-      inspector.markup.htmlEditor.off("popupshown", onPopupShown);
+  let nodeFront;
+  yield selectNode(SELECTOR, inspector);
 
-      ok(inspector.markup.htmlEditor._visible, "HTML Editor is visible");
-      is(node.outerHTML, OLD_HTML, "The node is starting with old HTML.");
+  info("Opening html editor");
+  let onPopupShown = inspector.markup.htmlEditor.once("popupshown");
+  EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
+  yield onPopupShown;
 
-      inspector.markup.htmlEditor.on("popuphidden", function onPopupHidden() {
-        inspector.markup.htmlEditor.off("popuphidden", onPopupHidden);
-        ok(!inspector.markup.htmlEditor._visible, "HTML Editor is not visible");
+  nodeFront = yield getNodeFront(SELECTOR, inspector);
+  ok(inspector.markup.htmlEditor._visible, "HTML Editor is visible");
+  is((yield inspector.markup.getNodeOuterHTML(nodeFront)), OLD_HTML,
+    "The node is starting with old HTML.");
 
-        let node = getNode(SELECTOR);
-        is(node.outerHTML, OLD_HTML, "Escape cancels edits");
-        def.resolve();
-      });
+  info("Changing text, then canceling changes");
+  let onPopupHidden = inspector.markup.htmlEditor.once("popuphidden");
+  inspector.markup.htmlEditor.editor.setText(NEW_HTML);
+  EventUtils.sendKey("ESCAPE", inspector.markup.htmlEditor.doc.defaultView);
+  yield onPopupHidden;
 
-      inspector.markup.htmlEditor.editor.setText(NEW_HTML);
-
-      EventUtils.sendKey("ESCAPE", inspector.markup.htmlEditor.doc.defaultView);
-    });
-
-    EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
-  });
-
-  return def.promise;
+  ok(!inspector.markup.htmlEditor._visible, "HTML Editor is not visible");
+  is((yield inspector.markup.getNodeOuterHTML(nodeFront)), OLD_HTML,
+    "Escape cancels edits");
 }
 
-function testF2Commits(inspector) {
-  let def = promise.defer();
-  let node = getNode(SELECTOR);
+function* testF2Commits(inspector) {
+  info("Checking that pressing F2 commits edits");
 
-  inspector.markup.htmlEditor.on("popupshown", function onPopupShown() {
-    inspector.markup.htmlEditor.off("popupshown", onPopupShown);
+  let nodeFront;
+  yield selectNode(SELECTOR, inspector);
 
-    ok(inspector.markup.htmlEditor._visible, "HTML Editor is visible");
-    is(node.outerHTML, OLD_HTML, "The node is starting with old HTML.");
+  info("Opening html editor");
+  let onPopupShown = inspector.markup.htmlEditor.once("popupshown");
+  EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
+  yield onPopupShown;
 
-    inspector.once("markupmutation", (e, aMutations) => {
-      ok(!inspector.markup.htmlEditor._visible, "HTML Editor is not visible");
+  nodeFront = yield getNodeFront(SELECTOR, inspector);
+  ok(inspector.markup.htmlEditor._visible, "HTML Editor is visible");
+  is((yield inspector.markup.getNodeOuterHTML(nodeFront)), OLD_HTML,
+    "The node is starting with old HTML.");
 
-      let node = getNode(SELECTOR);
-      is(node.outerHTML, NEW_HTML, "F2 commits edits - the node has new HTML.");
-      def.resolve();
-    });
+  info("Changing text, then commiting changes");
+  let onMutation = inspector.once("markupmutation");
+  inspector.markup.htmlEditor.editor.setText(NEW_HTML);
+  EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
+  yield onMutation;
 
-    inspector.markup.htmlEditor.editor.setText(NEW_HTML);
-    EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
-  });
-
-  inspector.markup._frame.contentDocument.documentElement.focus();
-  EventUtils.sendKey("F2", inspector.markup._frame.contentWindow);
-
-  return def.promise;
+  // Reselect nodeFront because markup was changed.
+  nodeFront = yield getNodeFront(SELECTOR, inspector);
+  ok(!inspector.markup.htmlEditor._visible, "HTML Editor is not visible");
+  is((yield inspector.markup.getNodeOuterHTML(nodeFront)), NEW_HTML,
+    "F2 commits edits - the node has new HTML.");
 }
 
 function* testBody(inspector) {
-  let body = getNode("body");
+  info("Checking that editing the <body> element works like other nodes");
+
+  let walker = inspector.walker;
   let bodyHTML = '<body id="updated"><p></p></body>';
   let bodyFront = yield getNodeFront("body", inspector);
-  let doc = content.document;
 
+  info("Changing body HTML");
   let onReselected = inspector.markup.once("reselectedonremoved");
-  yield inspector.markup.updateNodeOuterHTML(bodyFront, bodyHTML, body.outerHTML);
+  yield inspector.markup.updateNodeOuterHTML(bodyFront, bodyHTML);
   yield onReselected;
 
-  is(getNode("body").outerHTML, bodyHTML, "<body> HTML has been updated");
-  is(doc.querySelectorAll("head").length, 1, "no extra <head>s have been added");
+  // Reselect bodyFront because markup was changed.
+  bodyFront = yield getNodeFront("body", inspector);
+  is((yield inspector.markup.getNodeOuterHTML(bodyFront)), bodyHTML,
+    "<body> HTML has been updated");
+  is((yield walker.querySelectorAll(walker.rootNode, "head")).length, 1,
+    "no extra <head>s have been added");
 
   yield inspector.once("inspector-updated");
 }
 
-function* testHead(inspector) {
-  let head = getNode("head");
+function* testHead(inspector, testActor) {
+  info("Checking that editing the <head> element works like other nodes");
+
+  let walker = inspector.walker;
+  let headHTML = '<head id="updated"><title>New Title</title><script>document.body.id="executed";</script></head>';
+  let headFront = yield getNodeFront("head", inspector);
+
   yield selectNode("head", inspector);
 
-  let headHTML = '<head id="updated"><title>New Title</title><script>window.foo="bar";</script></head>';
-  let headFront = yield getNodeFront("head", inspector);
-  let doc = content.document;
-
+  info("Changing head HTML");
   let onReselected = inspector.markup.once("reselectedonremoved");
-  yield inspector.markup.updateNodeOuterHTML(headFront, headHTML, head.outerHTML);
+  yield inspector.markup.updateNodeOuterHTML(headFront, headHTML);
   yield onReselected;
 
-  is(doc.title, "New Title", "New title has been added");
-  is(doc.defaultView.foo, undefined, "Script has not been executed");
-  is(doc.querySelector("head").outerHTML, headHTML, "<head> HTML has been updated");
-  is(doc.querySelectorAll("body").length, 1, "no extra <body>s have been added");
+  is((yield testActor.eval("document.title")), "New Title",
+    "New title has been added");
+  is((yield testActor.hasNode("#executed")), false,
+    "Script has not been executed");
+
+  // Reselect headFront because markup was changed.
+  headFront = yield getNodeFront("head", inspector);
+  is((yield inspector.markup.getNodeOuterHTML(headFront)), headHTML,
+    "<head> HTML has been updated");
+  is((yield walker.querySelectorAll(walker.rootNode, "body")).length, 1,
+    "no extra <body>s have been added");
 
   yield inspector.once("inspector-updated");
 }
 
-function* testDocumentElement(inspector) {
-  let doc = content.document;
-  let docElement = doc.documentElement;
-  let docElementHTML = '<html id="updated" foo="bar"><head><title>Updated from document element</title><script>window.foo="bar";</script></head><body><p>Hello</p></body></html>';
+function* testDocumentElement(inspector, testActor, data) {
+  info(data.info);
+
+  let walker = inspector.walker;
+  let docElementHTML = data.html;
   let docElementFront = yield inspector.markup.walker.documentElement();
 
+  info("Changing document HTML");
   let onReselected = inspector.markup.once("reselectedonremoved");
-  yield inspector.markup.updateNodeOuterHTML(docElementFront, docElementHTML, docElement.outerHTML);
+  yield inspector.markup.updateNodeOuterHTML(docElementFront, docElementHTML);
   yield onReselected;
 
-  is(doc.title, "Updated from document element", "New title has been added");
-  is(doc.defaultView.foo, undefined, "Script has not been executed");
-  is(doc.documentElement.id, "updated", "<html> ID has been updated");
-  is(doc.documentElement.className, "", "<html> class has been updated");
-  is(doc.documentElement.getAttribute("foo"), "bar", "<html> attribute has been updated");
-  is(doc.documentElement.outerHTML, docElementHTML, "<html> HTML has been updated");
-  is(doc.querySelectorAll("head").length, 1, "no extra <head>s have been added");
-  is(doc.querySelectorAll("body").length, 1, "no extra <body>s have been added");
-  is(doc.body.textContent, "Hello", "document.body.textContent has been updated");
+  is((yield testActor.eval("document.title")), data.title,
+    "New title has been added");
+  is((yield testActor.hasNode("#executed")), false,
+    "Script has not been executed");
+
+  is((yield testActor.getAttribute("html", "id")), data.id,
+    "<html> ID has been updated");
+  is((yield testActor.getAttribute("html", "class")), data.class,
+    "<html> class has been updated");
+  is((yield testActor.getAttribute("html", "foo")), data.foo,
+    "<html> attribute has been updated");
+
+  is((yield inspector.markup.getNodeOuterHTML(docElementFront)), docElementHTML,
+    "<head> HTML has been updated");
+  is((yield walker.querySelectorAll(walker.rootNode, "head")).length, 1,
+    "no extra <heads>s have been added");
+  is((yield walker.querySelectorAll(walker.rootNode, "body")).length, 1,
+    "no extra <body>s have been added");
+  is((yield testActor.eval("document.body.textContent")), data.bodyTextContent,
+    "document.body.textContent has been updated");
 }
-
-function* testDocumentElement2(inspector) {
-  let doc = content.document;
-  let docElement = doc.documentElement;
-  let docElementHTML = '<html class="updated" id="somethingelse"><head><title>Updated again from document element</title><script>window.foo="bar";</script></head><body><p>Hello again</p></body></html>';
-  let docElementFront = yield inspector.markup.walker.documentElement();
-
-  let onReselected = inspector.markup.once("reselectedonremoved");
-  inspector.markup.updateNodeOuterHTML(docElementFront, docElementHTML, docElement.outerHTML);
-  yield onReselected;
-
-  is(doc.title, "Updated again from document element", "New title has been added");
-  is(doc.defaultView.foo, undefined, "Script has not been executed");
-  is(doc.documentElement.id, "somethingelse", "<html> ID has been updated");
-  is(doc.documentElement.className, "updated", "<html> class has been updated");
-  is(doc.documentElement.getAttribute("foo"), null, "<html> attribute has been removed");
-  is(doc.documentElement.outerHTML, docElementHTML, "<html> HTML has been updated");
-  is(doc.querySelectorAll("head").length, 1, "no extra <head>s have been added");
-  is(doc.querySelectorAll("body").length, 1, "no extra <body>s have been added");
-  is(doc.body.textContent, "Hello again", "document.body.textContent has been updated");
-}
diff --git a/devtools/client/markupview/test/browser_markupview_image_tooltip.js b/devtools/client/markupview/test/browser_markupview_image_tooltip.js
--- a/devtools/client/markupview/test/browser_markupview_image_tooltip.js
+++ b/devtools/client/markupview/test/browser_markupview_image_tooltip.js
@@ -3,61 +3,56 @@
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
 // Test that image preview tooltips are shown on img and canvas tags in the
 // markup-view and that the tooltip actually contains an image and shows the
 // right dimension label
 
-const PAGE_CONTENT = [
-  '<img class="local" src="chrome://branding/content/about-logo.png" />',
-  '<img class="data" src="data:image/png;base64,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" />',
-  '<img class="remote" src="' + TEST_URL_ROOT + 'doc_markup_tooltip.png" />',
-  '<canvas class="canvas" width="600" height="600"></canvas>'
-].join("\n");
+const TEST_URL = `
+  data:text/html;charset=utf8,
+  <img class="local" src="chrome://branding/content/about-logo.png">
+  <img class="data" src="data:image/png;base64,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">
+  <img class="remote" src="${TEST_URL_ROOT}/doc_markup_tooltip.png">
+  <canvas class="canvas" width="600" height="600"></canvas>`;
 
 const TEST_NODES = [
   {selector: "img.local", size: "192" + " \u00D7 " + "192"},
   {selector: "img.data", size: "64" + " \u00D7 " + "64"},
   {selector: "img.remote", size: "22" + " \u00D7 " + "23"},
   {selector: ".canvas", size: "600" + " \u00D7 " + "600"}
 ];
 
 add_task(function*() {
-  yield addTab("data:text/html,markup view tooltip test");
-  createPage();
-
-  let {inspector} = yield openInspector();
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
+  yield drawOnCanvas(testActor);
 
   info("Selecting the first <img> tag");
   yield selectNode("img", inspector);
 
   for (let testNode of TEST_NODES) {
     let target = yield getImageTooltipTarget(testNode, inspector);
     yield assertTooltipShownOn(target, inspector);
     checkImageTooltip(testNode, inspector);
   }
 });
 
-function createPage() {
-  info("Fill the page with the test content");
-  content.document.body.innerHTML = PAGE_CONTENT;
+function* drawOnCanvas(testActor) {
+  info("Fill the canvas");
 
-  info("Fill the canvas");
-  let doc = content.document;
-  let context = doc.querySelector(".canvas").getContext("2d");
-
-  context.beginPath();
-  context.moveTo(300, 0);
-  context.lineTo(600, 600);
-  context.lineTo(0, 600);
-  context.closePath();
-  context.fillStyle = "#ffc821";
-  context.fill();
+  yield testActor.eval(`
+    let context = document.querySelector(".canvas").getContext("2d");
+    context.beginPath();
+    context.moveTo(300, 0);
+    context.lineTo(600, 600);
+    context.lineTo(0, 600);
+    context.closePath();
+    context.fillStyle = "#ffc821";
+    context.fill();`);
 }
 
 function* getImageTooltipTarget({selector}, inspector) {
   let nodeFront = yield getNodeFront(selector, inspector);
   let isImg = nodeFront.tagName.toLowerCase() === "img";
 
   let container = getContainerForNodeFront(nodeFront, inspector);
 
@@ -74,12 +69,13 @@ function* assertTooltipShownOn(element, 
   ok(isValid, "The element is a valid hover target for the image tooltip");
 }
 
 function checkImageTooltip({selector, size}, {markup}) {
   let images = markup.tooltip.panel.getElementsByTagName("image");
   is(images.length, 1, "Tooltip for [" + selector + "] contains an image");
 
   let label = markup.tooltip.panel.querySelector(".devtools-tooltip-caption");
-  is(label.textContent, size, "Tooltip label for [" + selector + "] displays the right image size");
+  is(label.textContent, size,
+    "Tooltip label for [" + selector + "] displays the right image size");
 
   markup.tooltip.hide();
 }
diff --git a/devtools/client/markupview/test/browser_markupview_image_tooltip_mutations.js b/devtools/client/markupview/test/browser_markupview_image_tooltip_mutations.js
--- a/devtools/client/markupview/test/browser_markupview_image_tooltip_mutations.js
+++ b/devtools/client/markupview/test/browser_markupview_image_tooltip_mutations.js
@@ -2,26 +2,25 @@
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
 // Test that image preview tooltip shows updated content when the image src
 // changes.
 
+const TEST_URL = "data:text/html;charset=utf8,<p>markup view tooltip test</p><img>";
 const INITIAL_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADI5JREFUeNrsWwuQFNUVPf1m5z87szv7HWSWj8CigBFMEFZKiQsB1PgJwUAZg1HBpIQsKmokEhNjWUnFVPnDWBT+KolJYbRMoqUVq0yCClpqiX8sCchPWFwVlt2db7+X93pez7zu6Vn2NxsVWh8987p7pu+9555z7+tZjTGGY3kjOMa34w447oBjfKsY7i/UNM3Y8eFSAkD50Plgw03K5P9gvGv7U5ieeR3PszeREiPNX3/0DL4hjslzhm8THh+OITfXk3dhiv4GDtGPVzCaeJmPLYzuu5qJuWfuw2QTlcN1X9pwQU7LhdZ/ZAseD45cOh9hHvDkc/yAF/DNhdb5Mrr3PvBMaAYW8fMSIi2G497IMEK/YutGtAYr6+ej+nxu/NN8Ks3N7AR6HgcLz0Eg1Ljg1UcxZzi5qewIkMYLRweTr2Kzp+nmyXAd5pS3XQDd+N/4h4zgu9FI7brlXf90nMEnuwQxlvv+hosE3TuexmWeysmT4W+WxkMaLzf9Y8ATgjcUn7T9H1gqrpFq8eV1gMn6t16NhngjfoX6q4DUP032Rd4LJgpSLwJ1yzFqBG69eRkah0MVyo0Acfe+yy9AG4nMiYCkeM53KKFXncBLAXqEm+wCqZwaueq7WCmuLTcKSJmj737ol2hurA9eq9VdyiO8yWa3NNyog+SB5CZodSsQq/dfu34tJpYbBaTMzvVddDZu16q5smXf4G8zEvqm4cyaAmJPuTJk3oJWdS4WzcVtfMZbThSQckb/pYfRGgo3zNOqZnEHbJPGK4abaDCQIIsT8V/qTaBqHkLh6LzXH8XZQhbLhYKyyCC/WeHYcNdmvOgfe8skzbWL270/T3wf7tSx/lGCbTu8xlzzmCSWLc5iwmgikcCHi3Mga0Ry913vBFvQwg90l6M4ImWKfsWOp7DSWxmfpPlCFuPFfsNfKrCnPYpQKIRgqBK7D0SxYaNHwkEiJMtl0ReDp3Lc5D3PGoTo/sKngCl7a5chFqvBatKwjBd7WwqIlzB/78NcoUcp5VSgGxm+7b8eqQRGnHMO634epO4S1EZww09/iFg5UmGoESDuznP1xVhTUX1WWHPzjpd25wyH0hRxI3LGM75nxmuNEEUVpAN0XgxmPoKralakbQnWlIMQyVBD/w+3orkq4lvualjKyWwzt4MaxqspQHVhPOWG64bxYuhZXSFGWhipbSDVragOu5Y9eAsmDDUKyBA703vemVhHoueD6e9wAzJK1WfmN0Umk5GGM4kEMZcuIECqgjm0nldAqmbjwtm4VxZH5AvlADP6mx9Eqy9Q0+KqW8Ch+47FaMMYmnNGfY1iPMshoC6qFxme4wQ+0p+ARE6H3+9veWEDWgUhDhUKyFARn4jM5BNxT0XsMg7bfymGK1ov3wtjDfhL4w0HVGUVBEjDaaE+QNdrcNWch1PG4W6xrjBUXECGivg++Cva3JUT4iQUz3V2RsSVaKLwOuDT89A3HdBQoxhNC+fnVm74ual2EG893P6G+PuP4SfiO4cCBWQooL9qCWKNXPbcI37Aa/lnlZxXRt4RFONGwSDCPAHqOuqjWct1QiEMw5mChM5X4K47FyNqcd3aK9AwFH0CGYLoe1ctxk2eWi57rg5JfGp9rzC6ggCdFlAgHBDw5Yxlcg6G8SyHCjMlsgmDD9zhSeHlF+JnAgWDTQUy2NxfdwOao1UVV3pi3+bE97YSbWpLAbn6zefHNQkp1PMpIBwwvslKgIYTKM2nEpNzrGcH3FXTEal0L38kJ4uDQgEZbO4vnI173LXf5NHZaiUxtaCxyZuo/rK6LpUg54yg3zTWRAArvDcRIPZ6BqzrQ1REpmL+DNw32OKIDCb3X1qPVn8wNNMT4w2bvs+q4bAZrqBh2skaL3yyhhIIZ4i6oHkUK0RckcB8GigEyRIH4A6Mgc8fatl0/+BkkQxC9gIT4ljna1rIZW9rEdNbjJcNjsnoYj7LHWCUwpITzEgzRQKZ3XAFHbTzA3hrz8TEUUZxFBhoKpABQt/97p+w0hMZG68I8R6FtlsJT3FELndZntjM+VMnylKYq8GJI3UZaRMpquGSGFVOEfv0YZBMNzz+uvjbfzS6xQERIhlI9FcvQWNdFVb7x1zCb+QNK8vb9NsiifmI5hBgVoOCBC1sb0ab5RomqENxLO3eA1/0NDRU47q2RQNbRCUDIb7lF2CNL3ZGxEV4n08TVvZWYG4pZyV0zUdS45tyCBByOHWiyvZmxFXDCyRo1ge5+Sy0TA+8lWMiP/6O0S32exGV9Jf4fr8azdUR3zL/CZz4MtvzdX5uOYs6NDOmpkuj5Huh+7qUQSYl0ThHzw0YQzcGo6bhzEqoYq5rN3yRiYiG3Vfe2Ybm/qKA9NNZ3nNm4F7/yDkg9AN+U1mHiBcXP8zuDN76jj8hg1QyiWQigalj02BJPhK8I0zxijAjhp5zhlpLUDvS+BCy2HMAvvB4XDgL9/SXC0g/ou/5+6/xLX8w0uJrOIkXfPvyhY0F6gr7M8H0KWFYikcqAXakB+xwD9CdREBLoau7Gz3cAdSIdLFxFtJTCqRChSjnutvhDcREtzjz2Tswtz+yeNRFUeXZXtWux7C1fuoVcbd3J//ipDX3uZZDLGrwweS+UBLL5TDliVBnF8P7H+XI8aRRGsIBJg/Zlslt1+W+D1JWoSyi+kD9jfhs78t7mhZhSl+fLfY1Bdyv3I8V/qpY3B1McgN7ZFT5/vNO0I5DPLLdPBIJA8qc4h2I0QplYfDpJwHT+aj0246r5S8rToG8OjCle8wk4OLvvYGa+Ovr84uo2qBSwJS9G5egoZFLTfiEqWDtbwGfHgKOdPHcS+ai7XDzMPW/FJRLGGcxnBbK4YJC2K+h+T6Bdu5CqHqCWERd3bawb7JI+iJ735+LNaHaprBLLHBm08U3XxShEsdt+f3eTh3v7aC95Dct4RCWL5OZWh/oXBZThxAIxyOXLzBk8aiEWJID8rK3CpPOmeHaGpvCS+7EHv5FujVHUSJPLXvIFeHcNc+9xrB2gws9KZdxuLFax/WLM5gzzSm/lTXF/OdAcapyvjxPqxqHjr2v4ckX2bS2dRBrc5lSdpKjEJ9/9tdwX2WMd53ZQ2IVo3RES+UwVSpCPvYepNx4gmTGDUKIMQ4eduPnD7mx9xOn/KZKOlFbStjONxHTtR+BYAPmnoZ1Zp8wkBRwP/EL3u0F/C2hGl7vpz7vW37T3vP7if8wroKuoh8ribknX9BK5rcF+mo1qKaKyRPJTgTDjbzY8szcuLb3bpH00u35T47j7prRpwDJTxzyG0dHgxPp5bPG8VdkpfPbUg3SgoOo2mwVukb98D5EqpswZTTulCggTk4gpYhv0++wIhCJxr0+Hq1sondis0SE2oxQe3qWXwWyO4DSQg9gJ8Iiw1VFcGqXxet0N9xE4ygIxv/9W6wo9WyROEX/R+eiobYSq2vHTOR631Eiv2lRfh9dvxkumkXh92Qsx8XrAJ+7YGbWuhxOi/U+31NQmzyqNYG8N/3wfo6CRtRHcN01FzkvojohwLu0VVvDa56IS/xcj2b7nN+O+m0jqpE1wMPXZxAN9iCVThtDvH7gmiRGRpU8Lspv1Uhq4wIVdQoyuGSLNYPKUCS8+CzNURbzMmjK3i8u0U793lmuV0ef9nWQ5MGC/DiUqEUSaCtXna9RJEspZS1lrXINK/pcq+SpT50t98QKMq1FRmDfx3vxty102k0PM4ssEnvuz5+G26Ij4yDpz6z9fV8bkyIkqBFkhej0Ib+ZQ34XJK9AfozaiimqIoX3Jp3tiISrcfYpuN2+iFph/02P36PNC9fVcCnp6H9jYouKyfaWufz5Tp9tVxcUniw7IohZv4dZz81/ns67z3AYPrc2n0+Ix2q8k0PWjgBy88XaibnfK9A+5LdDY2Ivhy36fbT8Zv3Lb1U1qLqUxorXEEXIs0mjjrtxoTZWtdvigNs2sgPiujTv6DIZLld6b/V5742JZV3fUsUVFy5gdsNtKWFzUCEVbNepD1MkSMVbsb6SZm7jI3/zODtQKgUMsOw8wDZ63t5xcV1TnaEAxoc6wrqY+Fj+N4DsqOnhOIdicrQSm1MPYCPlIqHn5bbHg8/bj2D3QfZnCX3mpAICDZV8jH5kpbZqTD0W+DxaA74CWzLN2nd14OlL72J38Lf7+TjC7dadZFDoZJQPrtaIKL/G0L6ktptPZVJ8fMqHYPZOKYPMyQGadIJfDvdXwAFiZOTvDBPydf5vk4rWA+RfdhBlaF/yDDBRoMu9pfnSjv/p7DG+HXfAcQcc49v/BBgAcFAO4DmB2GQAAAAASUVORK5CYII=";
 const UPDATED_SRC = TEST_URL_ROOT + "doc_markup_tooltip.png";
 
 const INITIAL_SRC_SIZE = "64" + " \u00D7 " + "64";
 const UPDATED_SRC_SIZE = "22" + " \u00D7 " + "23";
 
 add_task(function*() {
-  yield addTab("data:text/html,<p>markup view tooltip test</p><img>");
-
-  let { inspector } = yield openInspector();
+  let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   info("Retrieving NodeFront for the <img> element.");
   let img = yield getNodeFront("img", inspector);
 
   info("Selecting the <img> element");
   yield selectNode(img, inspector);
 
   info("Adding src attribute to the image.");
@@ -47,26 +46,25 @@ add_task(function*() {
   info("Showing tooltip on the src link.");
   yield inspector.markup.tooltip.isValidHoverTarget(target);
 
   info("Checking that the new image was shown.");
   checkImageTooltip(UPDATED_SRC_SIZE, inspector);
 });
 
 /**
- * Updates the src attribute of the image. Return a Promise.
+ * Updates the src attribute of the image.
  */
-function updateImageSrc(img, newSrc, inspector) {
-  let onMutated = inspector.once("markupmutation");
-  let onModified = img.modifyAttributes([{
+function* updateImageSrc(img, newSrc, inspector) {
+  let onMutation = inspector.once("markupmutation");
+  img.modifyAttributes([{
     attributeName: "src",
     newValue: newSrc
   }]);
-
-  return Promise.all([onMutated, onModified]);
+  yield onMutation;
 }
 
 /**
  * Checks that the markup view tooltip contains an image element with the given
  * size.
  */
 function checkImageTooltip(size, {markup}) {
   let images = markup.tooltip.panel.getElementsByTagName("image");
diff --git a/devtools/client/markupview/test/browser_markupview_keybindings_01.js b/devtools/client/markupview/test/browser_markupview_keybindings_01.js
--- a/devtools/client/markupview/test/browser_markupview_keybindings_01.js
+++ b/devtools/client/markupview/test/browser_markupview_keybindings_01.js
@@ -4,33 +4,35 @@
 
 "use strict";
 
 // Tests tabbing through attributes on a node
 
 const TEST_URL = "data:text/html;charset=utf8,<div a b c d e id='test'></div>";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   info("Focusing the tag editor of the test element");
   let {editor} = yield getContainerForSelector("div", inspector);
   editor.tag.focus();
 
   info("Pressing tab and expecting to focus the ID attribute, always first");
   EventUtils.sendKey("tab", inspector.panelWin);
   checkFocusedAttribute("id");
 
   info("Hit enter to turn the attribute to edit mode");
   EventUtils.sendKey("return", inspector.panelWin);
   checkFocusedAttribute("id", true);
 
   // Check the order of the other attributes in the DOM to the check they appear
   // correctly in the markup-view
-  let attributes = [...getNode("div").attributes].filter(attr => attr.name !== "id");
+  let attributes = (yield testActor.getAttributes("div")).filter(attr => {
+    return attr.name !== "id";
+  });
 
   info("Tabbing forward through attributes in edit mode");
   for (let {name} of attributes) {
     collapseSelectionAndTab(inspector);
     checkFocusedAttribute(name, true);
   }
 
   info("Tabbing backward through attributes in edit mode");
diff --git a/devtools/client/markupview/test/browser_markupview_keybindings_03.js b/devtools/client/markupview/test/browser_markupview_keybindings_03.js
--- a/devtools/client/markupview/test/browser_markupview_keybindings_03.js
+++ b/devtools/client/markupview/test/browser_markupview_keybindings_03.js
@@ -6,17 +6,17 @@
 
 // Tests that selecting a node with the mouse (by clicking on the line) focuses
 // the first focusable element in the corresponding MarkupContainer so that the
 // keyboard can be used immediately.
 
 const TEST_URL = "data:text/html;charset=utf8,<div class='test-class'></div>Text node";
 
 add_task(function*() {
-  let {inspector, toolbox} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector} = yield addTab(TEST_URL).then(openInspector);
   let {walker} = inspector;
 
   info("Select the test node to have the 2 test containers visible");
   yield selectNode("div", inspector);
 
   let divFront = yield walker.querySelector(walker.rootNode, "div");
   let textFront = yield walker.nextSibling(divFront);
 
diff --git a/devtools/client/markupview/test/browser_markupview_keybindings_04.js b/devtools/client/markupview/test/browser_markupview_keybindings_04.js
--- a/devtools/client/markupview/test/browser_markupview_keybindings_04.js
+++ b/devtools/client/markupview/test/browser_markupview_keybindings_04.js
@@ -7,20 +7,20 @@
 
 // Tests that selecting a node using the browser context menu (inspect element)
 // or the element picker focuses that node so that the keyboard can be used
 // immediately.
 
 const TEST_URL = "data:text/html;charset=utf8,<div>test element</div>";
 
 add_task(function*() {
-  let {toolbox, inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   info("Select the test node with the browser ctx menu");
-  yield selectWithBrowserMenu(inspector);
+  yield selectWithBrowserMenu(inspector, testActor);
   assertNodeSelected(inspector, "div");
 
   info("Press arrowUp to focus <body> " +
        "(which works if the node was focused properly)");
   yield selectPreviousNodeWithArrowUp(inspector);
   assertNodeSelected(inspector, "body");
 
   info("Select the test node with the element picker");
@@ -33,36 +33,29 @@ add_task(function*() {
   assertNodeSelected(inspector, "body");
 });
 
 function assertNodeSelected(inspector, tagName) {
   is(inspector.selection.nodeFront.tagName.toLowerCase(), tagName,
     `The <${tagName}> node is selected`);
 }
 
-function selectPreviousNodeWithArrowUp(inspector) {
-  let onNodeHighlighted = inspector.toolbox.once("node-highlight");
+function* selectPreviousNodeWithArrowUp(inspector) {
   let onUpdated = inspector.once("inspector-updated");
   EventUtils.synthesizeKey("VK_UP", {});
-  return Promise.all([onUpdated, onNodeHighlighted]);
+  yield onUpdated;
 }
 
-function* selectWithBrowserMenu(inspector) {
+function* selectWithBrowserMenu(inspector, testActor) {
   yield BrowserTestUtils.synthesizeMouseAtCenter("div", {
     type: "contextmenu",
     button: 2
   }, gBrowser.selectedBrowser);
 
-  // nsContextMenu also requires the popupNode to be set, but we can't set it to
-  // node under e10s as it's a CPOW, not a DOM node. But under e10s,
-  // nsContextMenu won't use the property anyway, so just try/catching is ok.
-  try {
-    document.popupNode = getNode("div");
-  } catch (e) {}
-
+  yield testActor.eval("document.popupNode = document.querySelector('div')");
   let contentAreaContextMenu = document.querySelector("#contentAreaContextMenu");
   let contextMenu = new nsContextMenu(contentAreaContextMenu);
   yield contextMenu.inspectNode();
 
   contentAreaContextMenu.hidden = true;
   contentAreaContextMenu.hidePopup();
   contextMenu.hiding();
 
diff --git a/devtools/client/markupview/test/browser_markupview_links_01.js b/devtools/client/markupview/test/browser_markupview_links_01.js
--- a/devtools/client/markupview/test/browser_markupview_links_01.js
+++ b/devtools/client/markupview/test/browser_markupview_links_01.js
@@ -111,14 +111,16 @@ add_task(function*() {
 
     for (let {attributeName, links} of attributes) {
       info("Testing attribute " + attributeName);
       let linkEls = editor.attrElements.get(attributeName).querySelectorAll(".link");
 
       is(linkEls.length, links.length, "The right number of links were found");
 
       for (let i = 0; i < links.length; i ++) {
-        is(linkEls[i].dataset.type, links[i].type, "Link " + i + " has the right type");
-        is(linkEls[i].textContent, links[i].value, "Link " + i + " has the right value");
+        is(linkEls[i].dataset.type, links[i].type,
+          "Link " + i + " has the right type");
+        is(linkEls[i].textContent, links[i].value,
+          "Link " + i + " has the right value");
       }
     }
   }
 });
diff --git a/devtools/client/markupview/test/browser_markupview_links_05.js b/devtools/client/markupview/test/browser_markupview_links_05.js
--- a/devtools/client/markupview/test/browser_markupview_links_05.js
+++ b/devtools/client/markupview/test/browser_markupview_links_05.js
@@ -62,17 +62,17 @@ add_task(function*() {
 
   ok(true, "The node selection failed");
   is(inspector.selection.nodeFront.tagName.toLowerCase(), "output",
     "The <output> node is still selected");
 });
 
 function waitForTabLoad(tab) {
   let def = promise.defer();
-  tab.addEventListener("load", function onLoad(e) {
+  tab.addEventListener("load", function onLoad() {
     // Skip load event for about:blank
     if (tab.linkedBrowser.currentURI.spec === "about:blank") {
       return;
     }
     tab.removeEventListener("load", onLoad);
     def.resolve();
   });
   return def.promise;
diff --git a/devtools/client/markupview/test/browser_markupview_mutation_01.js b/devtools/client/markupview/test/browser_markupview_mutation_01.js
--- a/devtools/client/markupview/test/browser_markupview_mutation_01.js
+++ b/devtools/client/markupview/test/browser_markupview_mutation_01.js
@@ -12,203 +12,202 @@ const TEST_URL = TEST_URL_ROOT + "doc_ma
 // - desc: for logging only
 // - numMutations: how many mutations are expected to come happen due to the
 //   test case.  Defaults to 1 if not set.
 // - test: a function supposed to mutate the DOM
 // - check: a function supposed to test that the mutation was handled
 const TEST_DATA = [
   {
     desc: "Adding an attribute",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.setAttribute("newattr", "newattrval");
+    test: function*(testActor) {
+      yield testActor.setAttribute("#node1", "newattr", "newattrval");
     },
     check: function*(inspector) {
       let {editor} = yield getContainerForSelector("#node1", inspector);
       ok([...editor.attrList.querySelectorAll(".attreditor")].some(attr => {
         return attr.textContent.trim() === "newattr=\"newattrval\"";
       }), "newattr attribute found");
     }
   },
   {
     desc: "Removing an attribute",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.removeAttribute("newattr");
+    test: function*(testActor) {
+      yield testActor.removeAttribute("#node1", "newattr");
     },
     check: function*(inspector) {
       let {editor} = yield getContainerForSelector("#node1", inspector);
       ok(![...editor.attrList.querySelectorAll(".attreditor")].some(attr => {
         return attr.textContent.trim() === "newattr=\"newattrval\"";
       }), "newattr attribute removed");
     }
   },
   {
     desc: "Re-adding an attribute",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.setAttribute("newattr", "newattrval");
+    test: function*(testActor) {
+      yield testActor.setAttribute("#node1", "newattr", "newattrval");
     },
     check: function*(inspector) {
       let {editor} = yield getContainerForSelector("#node1", inspector);
       ok([...editor.attrList.querySelectorAll(".attreditor")].some(attr => {
         return attr.textContent.trim() === "newattr=\"newattrval\"";
       }), "newattr attribute found");
     }
   },
   {
     desc: "Changing an attribute",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.setAttribute("newattr", "newattrchanged");
+    test: function*(testActor) {
+      yield testActor.setAttribute("#node1", "newattr", "newattrchanged");
     },
     check: function*(inspector) {
       let {editor} = yield getContainerForSelector("#node1", inspector);
       ok([...editor.attrList.querySelectorAll(".attreditor")].some(attr => {
         return attr.textContent.trim() === "newattr=\"newattrchanged\"";
       }), "newattr attribute found");
     }
   },
   {
     desc: "Adding ::after element",
-    numMutations: 2,
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.classList.add("pseudo");
+    // refactoring-log: with 5 numMutations I got 1 failure per 10 tries,
+    // for 3 - 6 failures per 10 tried.
+    // Also I can set numMutations to 100000 and it will be reached. Mutations
+    // is happening continuously? In while-true-loop (of course no)?
+    // Then how to explain this? Maybe we should add event on pseudo elements
+    // adding / removal in markup-view.js?
+    numMutations: 5,
+    test: function*(testActor) {
+      yield testActor.addClass("#node1", "pseudo");
     },
     check: function*(inspector) {
       let {children} = yield getContainerForSelector("#node1", inspector);
       is(children.childNodes.length, 2,
         "Node1 now has 2 children (text child and ::after");
     }
   },
   {
     desc: "Removing ::after element",
-    numMutations: 2,
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.classList.remove("pseudo");
+    numMutations: 5,
+    test: function*(testActor) {
+      yield testActor.removeClass("#node1", "pseudo");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(container.singleTextChild, "Has single text child.");
     }
   },
   {
     desc: "Updating the text-content",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.textContent = "newtext";
+    test: function*(testActor) {
+      yield testActor.setProperty("#node1", "textContent", "newtext");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(container.singleTextChild, "Has single text child.");
       ok(!container.canExpand, "Can't expand container with singleTextChild.");
       ok(!container.singleTextChild.canExpand, "Can't expand singleTextChild.");
       is(container.editor.elt.querySelector(".text").textContent.trim(), "newtext",
         "Single text child editor updated.");
     }
   },
   {
     desc: "Adding a second text child",
-    test: () => {
-      let node1 = getNode("#node1");
-      let newText = node1.ownerDocument.createTextNode("more");
-      node1.appendChild(newText);
+    test: function*(testActor) {
+      yield testActor.eval(`
+        let node = document.querySelector("#node1");
+        let newText = node.ownerDocument.createTextNode("more");
+        node.appendChild(newText);`);
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(!container.singleTextChild, "Does not have single text child.");
       ok(container.canExpand, "Can expand container with child nodes.");
       ok(container.editor.elt.querySelector(".text") == null,
         "Single text child editor removed.");
     },
   },
   {
     desc: "Go from 2 to 1 text child",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.textContent = "newtext";
+    test: function*(testActor) {
+      yield testActor.setProperty("#node1", "textContent", "newtext");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(container.singleTextChild, "Has single text child.");
       ok(!container.canExpand, "Can't expand container with singleTextChild.");
       ok(!container.singleTextChild.canExpand, "Can't expand singleTextChild.");
       ok(container.editor.elt.querySelector(".text").textContent.trim(), "newtext",
         "Single text child editor updated.");
     },
   },
   {
     desc: "Removing an only text child",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.innerHTML = "";
+    test: function*(testActor) {
+      yield testActor.setProperty("#node1", "innerHTML", "");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(!container.singleTextChild, "Does not have single text child.");
       ok(!container.canExpand, "Can't expand empty container.");
       ok(container.editor.elt.querySelector(".text") == null,
         "Single text child editor removed.");
     },
   },
   {
     desc: "Go from 0 to 1 text child",
-    test: () => {
-      let node1 = getNode("#node1");
-      node1.textContent = "newtext";
+    test: function*(testActor) {
+      yield testActor.setProperty("#node1", "textContent", "newtext");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node1", inspector);
       ok(container.singleTextChild, "Has single text child.");
       ok(!container.canExpand, "Can't expand container with singleTextChild.");
       ok(!container.singleTextChild.canExpand, "Can't expand singleTextChild.");
       ok(container.editor.elt.querySelector(".text").textContent.trim(), "newtext",
         "Single text child editor updated.");
     },
   },
 
   {
     desc: "Updating the innerHTML",
-    test: () => {
-      let node2 = getNode("#node2");
-      node2.innerHTML = "<div><span>foo</span></div>";
+    test: function*(testActor) {
+      yield testActor.setProperty("#node2", "innerHTML",
+        "<div><span>foo</span></div>");
     },
     check: function*(inspector) {
       let container = yield getContainerForSelector("#node2", inspector);
 
       let openTags = container.children.querySelectorAll(".open .tag");
       is(openTags.length, 2, "There are 2 tags in node2");
       is(openTags[0].textContent.trim(), "div", "The first tag is a div");
       is(openTags[1].textContent.trim(), "span", "The second tag is a span");
 
       is(container.children.querySelector(".text").textContent.trim(), "foo",
         "The span's textcontent is correct");
     }
   },
   {
     desc: "Removing child nodes",
-    test: () => {
-      let node4 = getNode("#node4");
-      while (node4.firstChild) {
-        node4.removeChild(node4.firstChild);
-      }
+    test: function*(testActor) {
+      yield testActor.eval(`
+        let node = document.querySelector("#node4");
+        while (node.firstChild) {
+          node.removeChild(node.firstChild);
+        }`);
     },
     check: function*(inspector) {
       let {children} = yield getContainerForSelector("#node4", inspector);
       is(children.innerHTML, "", "Children have been removed");
     }
   },
   {
     desc: "Appending a child to a different parent",
-    test: () => {
-      let node17 = getNode("#node17");
-      let node2 = getNode("#node2");
-      node2.appendChild(node17);
+    test: function*(testActor) {
+      yield testActor.eval(`
+        let node2 = document.querySelector("#node2");
+        let node17 = document.querySelector("#node17");
+        node2.appendChild(node17);`);
     },
     check: function*(inspector) {
       let {children} = yield getContainerForSelector("#node16", inspector);
       is(children.innerHTML, "", "Node17 has been removed from its node16 parent");
 
       let container = yield getContainerForSelector("#node2", inspector);
       let openTags = container.children.querySelectorAll(".open .tag");
       is(openTags.length, 3, "There are now 3 tags in node2");
@@ -225,24 +224,24 @@ const TEST_DATA = [
     //        node21
     // will become:
     // body
     //   node1
     //     node20
     //      node21
     //      node18
     //        node19
-    test: () => {
-      let node18 = getNode("#node18");
-      let node20 = getNode("#node20");
+    test: function*(testActor) {
+      yield testActor.eval(`
+        let node1 = document.querySelector("#node1");
+        let node18 = document.querySelector("#node18");
+        let node20 = document.querySelector("#node20");
 
-      let node1 = getNode("#node1");
-
-      node1.appendChild(node20);
-      node20.appendChild(node18);
+        node1.appendChild(node20);
+        node20.appendChild(node18);`);
     },
     check: function*(inspector) {
       yield inspector.markup.expandAll();
 
       let {children} = yield getContainerForSelector("#node1", inspector);
       is(children.childNodes.length, 2,
         "Node1 now has 2 children (textnode and node20)");
 
@@ -258,43 +257,38 @@ const TEST_DATA = [
       let node18 = node20Children.childNodes[1];
       is(node18.querySelector(".open .attreditor .attr-value").textContent.trim(),
         "node18", "Node20's second child is indeed node18");
     }
   }
 ];
 
 add_task(function*() {
-  let {toolbox, inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {toolbox, inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   info("Expanding all markup-view nodes");
   yield inspector.markup.expandAll();
 
   for (let {desc, test, check, numMutations} of TEST_DATA) {
     info("Starting test: " + desc);
 
     numMutations = numMutations || 1;
 
     info("Executing the test markup mutation");
-    yield new Promise((resolve) => {
-      // If a test expects more than one mutation it may come through in a
-      // single event or possibly in multiples.
-      let seenMutations = 0;
-      inspector.on("markupmutation", function onmutation(e, mutations) {
-        seenMutations += mutations.length;
-        info("Receieved " + seenMutations +
-             " mutations, expecting at least " + numMutations);
-        if (seenMutations >= numMutations) {
-          inspector.off("markupmutation", onmutation);
-          resolve();
-        }
-      });
-
-      test();
-    })
+    // If a test expects more than one mutation it may come through in a
+    // single event or possibly in multiples.
+    let seenMutations = 0;
+    while (seenMutations < numMutations) {
+      let onMutation = inspector.once("markupmutation");
+      yield test(testActor);
+      let mutations = yield onMutation;
+      seenMutations += mutations.length;
+      info("Receieved " + seenMutations +
+           " mutations, expecting at least " + numMutations);
+    }
 
     info("Expanding all markup-view nodes to make sure new nodes are imported");
     yield inspector.markup.expandAll();
 
     info("Checking the markup-view content");
     yield check(inspector);
   }
 });
diff --git a/devtools/client/markupview/test/browser_markupview_mutation_02.js b/devtools/client/markupview/test/browser_markupview_mutation_02.js
--- a/devtools/client/markupview/test/browser_markupview_mutation_02.js
+++ b/devtools/client/markupview/test/browser_markupview_mutation_02.js
@@ -15,107 +15,116 @@ const TEST_URL = TEST_URL_ROOT + "doc_ma
 // - mutate: a function that should make changes to the content DOM
 // - attribute: if set, the test will expect the corresponding attribute to flash
 //   instead of the whole node
 // - flashedNode: [optional] the css selector of the node that is expected to
 //   flash in the markup-view as a result of the mutation.
 //   If missing, the rootNode (".list") will be expected to flash
 const TEST_DATA = [{
   desc: "Adding a new node should flash the new node",
-  mutate: (doc, rootNode) => {
-    let newLi = doc.createElement("LI");
-    newLi.textContent = "new list item";
-    rootNode.appendChild(newLi);
+  mutate: function*(testActor) {
+    yield testActor.eval(`
+      let rootNode = document.querySelector(".list");
+      let newLi = document.createElement("LI");
+      newLi.textContent = "new list item";
+      rootNode.appendChild(newLi);`);
   },
   flashedNode: ".list li:nth-child(3)"
 }, {
   desc: "Removing a node should flash its parent",
-  mutate: (doc, rootNode) => {
-    rootNode.removeChild(rootNode.lastElementChild);
+  mutate: function*(testActor) {
+    yield testActor.eval(`
+      let rootNode = document.querySelector(".list");
+      rootNode.removeChild(rootNode.lastElementChild);`);
   }
 }, {
   desc: "Re-appending an existing node should only flash this node",
-  mutate: (doc, rootNode) => {
-    rootNode.appendChild(rootNode.firstElementChild);
+  mutate: function*(testActor) {
+    yield testActor.eval(`
+      let rootNode = document.querySelector(".list");
+      rootNode.appendChild(rootNode.firstElementChild);`);
   },
   flashedNode: ".list .item:last-child"
 }, {
   desc: "Adding an attribute should flash the attribute",
   attribute: "test-name",
-  mutate: (doc, rootNode) => {
-    rootNode.setAttribute("test-name", "value-" + Date.now());
+  mutate: function*(testActor) {
+    yield testActor.setAttribute(".list", "test-name", "value-" + Date.now());
   }
 }, {
   desc: "Editing an attribute should flash the attribute",
   attribute: "class",
-  mutate: (doc, rootNode) => {
-    rootNode.setAttribute("class", "list value-" + Date.now());
+  mutate: function*(testActor) {
+    yield testActor.setAttribute(".list", "class", "list value-" + Date.now());
   }
 }, {
   desc: "Multiple changes to an attribute should flash the attribute",
   attribute: "class",
-  mutate: (doc, rootNode) => {
-    rootNode.removeAttribute("class");
-    rootNode.setAttribute("class", "list value-" + Date.now());
-    rootNode.setAttribute("class", "list value-" + Date.now());
-    rootNode.removeAttribute("class");
-    rootNode.setAttribute("class", "list value-" + Date.now());
-    rootNode.setAttribute("class", "list value-" + Date.now());
+  mutate: function*(testActor) {
+    yield testActor.eval(`
+      let rootNode = document.querySelector(".list");
+      rootNode.removeAttribute("class");
+      rootNode.setAttribute("class", "list value-" + Date.now());
+      rootNode.setAttribute("class", "list value-" + Date.now());
+      rootNode.removeAttribute("class");
+      rootNode.setAttribute("class", "list value-" + Date.now());
+      rootNode.setAttribute("class", "list value-" + Date.now());`);
   }
 }, {
   desc: "Removing an attribute should flash the node",
-  mutate: (doc, rootNode) => {
-    rootNode.removeAttribute("class");
+  mutate: function*(testActor) {
+    yield testActor.removeAttribute(".list", "class");
   }
 }];
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   // Make sure mutated nodes flash for a very long time so we can more easily
   // assert they do
   inspector.markup.CONTAINER_FLASHING_DURATION = 1000 * 60 * 60;
 
-  info("Getting the <ul.list> root node to test mutations on");
-  let rootNode = getNode(".list");
+  info("Getting the <ul.list> nodeFront to test mutations on");
   let rootNodeFront = yield getNodeFront(".list", inspector);
 
   info("Selecting the last element of the root node before starting");
   yield selectNode(".list .item:nth-child(2)", inspector);
 
   for (let {mutate, flashedNode, desc, attribute} of TEST_DATA) {
     info("Starting test: " + desc);
 
     info("Mutating the DOM and listening for markupmutation event");
-    let mutated = inspector.once("markupmutation");
-    mutate(content.document, rootNode);
-    yield mutated;
+    let onMutation = inspector.once("markupmutation");
+    yield mutate(testActor);
+    yield onMutation;
 
     info("Asserting that the correct markup-container is flashing");
-    let flashingNodeFront = rootNodeFront;
-    if (flashedNode) {
-      flashingNodeFront = yield getNodeFront(flashedNode, inspector);
-    }
+    let flashingNodeFront = flashedNode
+                            ? yield getNodeFront(flashedNode, inspector)
+                            : rootNodeFront;
 
     if (attribute) {
       yield assertAttributeFlashing(flashingNodeFront, attribute, inspector);
     } else {
       yield assertNodeFlashing(flashingNodeFront, inspector);
     }
   }
+
+  // Make sure that all connections are completed.
+  yield inspector.once("inspector-updated");
 });
 
 function* assertNodeFlashing(nodeFront, inspector) {
   let container = getContainerForNodeFront(nodeFront, inspector);
   ok(container, "Markup container for node found");
   ok(container.tagState.classList.contains("theme-bg-contrast"),
     "Markup container for node is flashing");
 
-  // Clear the mutation flashing timeout now that we checked the node was flashing
-  let markup = inspector.markup;
+  // Clear the mutation flashing timeout now that we checked
+  // the node was flashing.
   clearTimeout(container._flashMutationTimer);
   container._flashMutationTimer = null;
   container.tagState.classList.remove("theme-bg-contrast");
 }
 
 function* assertAttributeFlashing(nodeFront, attribute, inspector) {
   let container = getContainerForNodeFront(nodeFront, inspector);
   ok(container, "Markup container for node found");
diff --git a/devtools/client/markupview/test/browser_markupview_navigation.js b/devtools/client/markupview/test/browser_markupview_navigation.js
--- a/devtools/client/markupview/test/browser_markupview_navigation.js
+++ b/devtools/client/markupview/test/browser_markupview_navigation.js
@@ -19,17 +19,17 @@ const TEST_DATA = [
   ["down", "node3"],
   ["down", "*comment*"],
   ["down", "node4"],
   ["right", "node4"],
   ["down", "*text*"],
   ["down", "node5"],
   ["down", "node6"],
   ["down", "*comment*"],
-  ["down" , "node7"],
+  ["down", "node7"],
   ["right", "node7"],
   ["down", "*text*"],
   ["down", "node8"],
   ["left", "node7"],
   ["left", "node7"],
   ["right", "node7"],
   ["right", "*text*"],
   ["down", "node8"],
@@ -81,17 +81,17 @@ add_task(function*() {
     yield waitForChildrenUpdated(inspector);
 
     info("Checking the right node is selected");
     checkSelectedNode(key, className, inspector);
   }
 });
 
 function pressKey(key) {
-  switch(key) {
+  switch (key) {
     case "right":
       EventUtils.synthesizeKey("VK_RIGHT", {});
       break;
     case "down":
       EventUtils.synthesizeKey("VK_DOWN", {});
       break;
     case "left":
       EventUtils.synthesizeKey("VK_LEFT", {});
@@ -110,17 +110,18 @@ function pressKey(key) {
       break;
   }
 }
 
 function checkSelectedNode(key, className, inspector) {
   let node = inspector.selection.nodeFront;
 
   if (className == "*comment*") {
-    is(node.nodeType, Node.COMMENT_NODE, "Found a comment after pressing " + key);
+    is(node.nodeType, Node.COMMENT_NODE,
+      "Found a comment after pressing " + key);
   } else if (className == "*text*") {
     is(node.nodeType, Node.TEXT_NODE, "Found text after pressing " + key);
   } else if (className == "*doctype*") {
     is(node.nodeType, Node.DOCUMENT_TYPE_NODE, "Found the doctype after pressing " + key);
   } else {
     is(node.className, className, "Found node: " + className + " after pressing " + key);
   }
 }
diff --git a/devtools/client/markupview/test/browser_markupview_node_not_displayed_02.js b/devtools/client/markupview/test/browser_markupview_node_not_displayed_02.js
--- a/devtools/client/markupview/test/browser_markupview_node_not_displayed_02.js
+++ b/devtools/client/markupview/test/browser_markupview_node_not_displayed_02.js
@@ -8,114 +8,122 @@
 // their display changes
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_not_displayed.html";
 const TEST_DATA = [
   {
     desc: "Hiding a node by creating a new stylesheet",
     selector: "#normal-div",
     before: true,
-    changeStyle: (doc, node) => {
-      let div = doc.createElement("div");
-      div.id = "new-style";
-      div.innerHTML = "<style>#normal-div {display:none;}</style>";
-      doc.body.appendChild(div);
+    changeStyle: function*(selector, testActor) {
+      yield testActor.eval(`
+        let div = document.createElement("div");
+        div.id = "new-style";
+        div.innerHTML = "<style>#normal-div {display:none;}</style>";
+        document.body.appendChild(div);`);
     },
     after: false
   },
   {
     desc: "Showing a node by deleting an existing stylesheet",
     selector: "#normal-div",
     before: false,
-    changeStyle: (doc, node) => {
-      doc.getElementById("new-style").remove();
+    changeStyle: function*(selector, testActor) {
+      yield testActor.removeNode("#new-style");
     },
     after: true
   },
   {
     desc: "Hiding a node by changing its style property",
     selector: "#display-none",
     before: false,
-    changeStyle: (doc, node) => {
-      node.style.display = "block";
+    changeStyle: function*(selector, testActor) {
+      yield testActor.setProperty(selector, "style", "display: block");
     },
     after: true
   },
   {
     desc: "Showing a node by removing its hidden attribute",
     selector: "#hidden-true",
     before: false,
-    changeStyle: (doc, node) => {
-      node.removeAttribute("hidden");
+    changeStyle: function*(selector, testActor) {
+      yield testActor.removeAttribute(selector, "hidden");
     },
     after: true
   },
   {
     desc: "Hiding a node by adding a hidden attribute",
     selector: "#hidden-true",
     before: true,
-    changeStyle: (doc, node) => {
-      node.setAttribute("hidden", "true");
+    changeStyle: function*(selector, testActor) {
+      yield testActor.setAttribute(selector, "hidden", "true");
     },
     after: false
   },
   {
     desc: "Showing a node by changin a stylesheet's rule",
     selector: "#hidden-via-stylesheet",
     before: false,
-    changeStyle: (doc, node) => {
-      doc.styleSheets[0].cssRules[0].style.setProperty("display", "inline");
+    changeStyle: function*(selector, testActor) {
+      yield testActor.eval(`
+        let cssRule = document.styleSheets[0].cssRules[0];
+        cssRule.style.setProperty("display", "inline");`);
     },
     after: true
   },
   {
     desc: "Hiding a node by adding a new rule to a stylesheet",
     selector: "#hidden-via-stylesheet",
     before: true,
-    changeStyle: (doc, node) => {
-      doc.styleSheets[0].insertRule(
-        "#hidden-via-stylesheet {display: none;}", 1);
+    changeStyle: function*(selector, testActor) {
+      yield testActor.eval(`
+        let stylesheet = document.styleSheets[0];
+        stylesheet.insertRule("${selector} {display: none;}", 1);`);
     },
     after: false
   },
   {
     desc: "Hiding a node by adding a class that matches an existing rule",
     selector: "#normal-div",
     before: true,
-    changeStyle: (doc, node) => {
-      doc.styleSheets[0].insertRule(
-        ".a-new-class {display: none;}", 2);
-      node.classList.add("a-new-class");
+    changeStyle: function*(selector, testActor) {
+      yield testActor.eval(`
+        let node = document.querySelector("${selector}");
+        let stylesheet = document.styleSheets[0];
+        stylesheet.insertRule(".a-new-class {display: none;}", 2);
+        node.classList.add("a-new-class");`);
     },
     after: false
   }
 ];
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   for (let data of TEST_DATA) {
     info("Running test case: " + data.desc);
-    yield runTestData(inspector, data);
+    yield runTestData(inspector, testActor, data);
   }
 });
 
-function* runTestData(inspector, {selector, before, changeStyle, after}) {
+function* runTestData(inspector, testActor, data) {
+  let {selector, before, changeStyle, after} = data;
+
   info("Getting the " + selector + " test node");
   let nodeFront = yield getNodeFront(selector, inspector);
   let container = getContainerForNodeFront(nodeFront, inspector);
   is(!container.elt.classList.contains("not-displayed"), before,
     "The container is marked as " + (before ? "shown" : "hidden"));
 
   info("Listening for the display-change event");
   let onDisplayChanged = promise.defer();
   inspector.markup.walker.once("display-change", onDisplayChanged.resolve);
 
   info("Making style changes");
-  changeStyle(content.document, getNode(selector));
+  yield changeStyle(selector, testActor);
   let nodes = yield onDisplayChanged.promise;
 
   info("Verifying that the list of changed nodes include our container");
 
   ok(nodes.length, "The display-change event was received with a nodes");
   let foundContainer = false;
   for (let node of nodes) {
     if (getContainerForNodeFront(node, inspector) === container) {
diff --git a/devtools/client/markupview/test/browser_markupview_pagesize_02.js b/devtools/client/markupview/test/browser_markupview_pagesize_02.js
--- a/devtools/client/markupview/test/browser_markupview_pagesize_02.js
+++ b/devtools/client/markupview/test/browser_markupview_pagesize_02.js
@@ -1,45 +1,46 @@
 /* vim: set ts=2 et sw=2 tw=80: */
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
 // Tests that the markup view loads only as many nodes as specified
-// by the devtools.markup.pagesize preference and that pressing the "show all nodes"
-// actually shows the nodes
+// by the devtools.markup.pagesize preference and
+// that pressing the "show all nodes" actually shows the nodes.
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_pagesize_02.html";
 
 // Make sure nodes are hidden when there are more than 5 in a row
 Services.prefs.setIntPref("devtools.markup.pagesize", 5);
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   info("Selecting the UL node");
   yield clickContainer("ul", inspector);
   info("Reloading the page with the UL node selected will expand its children");
   yield reloadPage(inspector);
   yield inspector.markup._waitForChildren();
 
   info("Click on the 'show all nodes' button in the UL's list of children");
   yield showAllNodes(inspector);
 
-  yield assertAllNodesAreVisible(inspector);
+  yield assertAllNodesAreVisible(inspector, testActor);
 });
 
 function* showAllNodes(inspector) {
   let container = yield getContainerForSelector("ul", inspector);
   let button = container.elt.querySelector("button");
   ok(button, "All nodes button is here");
   let win = button.ownerDocument.defaultView;
 
   EventUtils.sendMouseEvent({type: "click"}, button, win);
   yield inspector.markup._waitForChildren();
 }
 
-function* assertAllNodesAreVisible(inspector) {
+function* assertAllNodesAreVisible(inspector, testActor) {
   let container = yield getContainerForSelector("ul", inspector);
   ok(!container.elt.querySelector("button"), "All nodes button isn't here anymore");
-  is(container.children.childNodes.length, getNode("ul").children.length);
+  is(container.children.childNodes.length,
+    (yield testActor.eval("document.querySelector('ul').children.length")));
 }
diff --git a/devtools/client/markupview/test/browser_markupview_remove_xul_attributes.js b/devtools/client/markupview/test/browser_markupview_remove_xul_attributes.js
--- a/devtools/client/markupview/test/browser_markupview_remove_xul_attributes.js
+++ b/devtools/client/markupview/test/browser_markupview_remove_xul_attributes.js
@@ -5,23 +5,22 @@
 "use strict";
 
 // Test confirms that XUL attributes don't show up as empty
 // attributes after being deleted
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_xul.xul";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
-
-  let panel = yield getNode("#test", inspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
   let panelFront = yield getNodeFront("#test", inspector);
 
-  ok(panelFront.hasAttribute("id"), "panelFront has id attribute in the beginning");
+  ok(panelFront.hasAttribute("id"),
+    "panelFront has id attribute in the beginning");
 
   info("Removing panel's id attribute");
-  panel.removeAttribute("id");
+  let onMutation = inspector.once("markupmutation");
+  yield testActor.removeAttribute("#test", "id");
+  yield onMutation;
 
-  info("Waiting for markupmutation");
-  yield inspector.once("markupmutation");
-
-  is(panelFront.hasAttribute("id"), false, "panelFront doesn't have id attribute anymore");
+  is(panelFront.hasAttribute("id"), false,
+    "panelFront doesn't have id attribute anymore");
 });
diff --git a/devtools/client/markupview/test/browser_markupview_tag_edit_02.js b/devtools/client/markupview/test/browser_markupview_tag_edit_02.js
--- a/devtools/client/markupview/test/browser_markupview_tag_edit_02.js
+++ b/devtools/client/markupview/test/browser_markupview_tag_edit_02.js
@@ -5,17 +5,17 @@
 "use strict";
 
 // Tests that an existing attribute can be modified
 
 const TEST_URL = "data:text/html,<div id='test-div'>Test modifying my ID attribute</div>";
 
 add_task(function*() {
   info("Opening the inspector on the test page");
-  let {toolbox, inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector} = yield addTab(TEST_URL).then(openInspector);
 
   info("Selecting the test node");
   yield selectNode("#test-div", inspector);
 
   info("Verify attributes, only ID should be there for now");
   yield assertAttributes("#test-div", {
     id: "test-div"
   });
diff --git a/devtools/client/markupview/test/browser_markupview_tag_edit_05.js b/devtools/client/markupview/test/browser_markupview_tag_edit_05.js
--- a/devtools/client/markupview/test/browser_markupview_tag_edit_05.js
+++ b/devtools/client/markupview/test/browser_markupview_tag_edit_05.js
@@ -56,22 +56,22 @@ var TEST_DATA = [{
   }
 }, {
   desc: "Add multiple attributes with no value, and some with value",
   text: "disabled name='name' data-test='test' autofocus",
   expectedAttributes: {
     disabled: "",
     autofocus: "",
     name: "name",
-    'data-test': "test"
+    "data-test": "test"
   }
 }, {
   desc: "Add attribute with xmlns",
   text: "xmlns:edi='http://ecommerce.example.org/schema'",
   expectedAttributes: {
-    'xmlns:edi': "http://ecommerce.example.org/schema"
+    "xmlns:edi": "http://ecommerce.example.org/schema"
   }
 }];
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
-  yield runAddAttributesTests(TEST_DATA, "div", inspector)
+  yield runAddAttributesTests(TEST_DATA, "div", inspector);
 });
diff --git a/devtools/client/markupview/test/browser_markupview_tag_edit_06.js b/devtools/client/markupview/test/browser_markupview_tag_edit_06.js
--- a/devtools/client/markupview/test/browser_markupview_tag_edit_06.js
+++ b/devtools/client/markupview/test/browser_markupview_tag_edit_06.js
@@ -75,10 +75,10 @@ var TEST_DATA = [{
   expectedAttributes: {
     onclick: "javascript: throw new Error('wont fire');",
     onload: "alert('here');"
   }
 }];
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
-  yield runAddAttributesTests(TEST_DATA, "div", inspector)
+  yield runAddAttributesTests(TEST_DATA, "div", inspector);
 });
diff --git a/devtools/client/markupview/test/browser_markupview_tag_edit_07.js b/devtools/client/markupview/test/browser_markupview_tag_edit_07.js
--- a/devtools/client/markupview/test/browser_markupview_tag_edit_07.js
+++ b/devtools/client/markupview/test/browser_markupview_tag_edit_07.js
@@ -40,39 +40,39 @@ var TEST_DATA = [{
     style: ""
   }
 }, {
   desc: "Try to add long data URL to make sure it is collapsed in attribute editor.",
   text: "style='"+DATA_URL_INLINE_STYLE+"'",
   expectedAttributes: {
     'style': DATA_URL_INLINE_STYLE
   },
-  validate: (element, container, inspector) => {
+  validate: (selector, container, inspector) => {
     let editor = container.editor;
     let visibleAttrText = editor.attrElements.get("style").querySelector(".attr-value").textContent;
     is (visibleAttrText, DATA_URL_INLINE_STYLE_COLLAPSED);
   }
 }, {
   desc: "Try to add long attribute to make sure it is collapsed in attribute editor.",
   text: 'data-long="'+LONG_ATTRIBUTE+'"',
   expectedAttributes: {
     'data-long':LONG_ATTRIBUTE
   },
-  validate: (element, container, inspector) => {
+  validate: (selector, container, inspector) => {
     let editor = container.editor;
     let visibleAttrText = editor.attrElements.get("data-long").querySelector(".attr-value").textContent;
     is (visibleAttrText, LONG_ATTRIBUTE_COLLAPSED)
   }
 }, {
   desc: "Try to add long data URL to make sure it is collapsed in attribute editor.",
   text: 'src="'+DATA_URL_ATTRIBUTE+'"',
   expectedAttributes: {
     "src": DATA_URL_ATTRIBUTE
   },
-  validate: (element, container, inspector) => {
+  validate: (selector, container, inspector) => {
     let editor = container.editor;
     let visibleAttrText = editor.attrElements.get("src").querySelector(".attr-value").textContent;
     is (visibleAttrText, DATA_URL_ATTRIBUTE_COLLAPSED);
   }
 }];
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
diff --git a/devtools/client/markupview/test/browser_markupview_tag_edit_12.js b/devtools/client/markupview/test/browser_markupview_tag_edit_12.js
--- a/devtools/client/markupview/test/browser_markupview_tag_edit_12.js
+++ b/devtools/client/markupview/test/browser_markupview_tag_edit_12.js
@@ -5,23 +5,23 @@
 "use strict";
 
 // Tests that focus position is correct when tabbing through and editing
 // attributes.
 
 const TEST_URL = "data:text/html;charset=utf8,<div id='attr' c='3' b='2' a='1'></div><div id='delattr' last='1' tobeinvalid='2'></div>";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
-  yield testAttributeEditing(inspector);
-  yield testAttributeDeletion(inspector);
+  yield testAttributeEditing(inspector, testActor);
+  yield testAttributeDeletion(inspector, testActor);
 });
 
-function* testAttributeEditing(inspector) {
+function* testAttributeEditing(inspector, testActor) {
   info("Testing focus position after attribute editing");
 
   // Modifying attributes reorders them in the internal representation to move
   // the modified attribute to the end. breadcrumbs.js will update attributes
   // to match original order if you selectNode before modifying attributes.
   // So, hacky workaround for consistency with manual testing.
   // Should be removed after Bug 1093593.
   yield selectNode("#attr", inspector);
@@ -29,17 +29,17 @@ function* testAttributeEditing(inspector
   info("Setting the first non-id attribute in edit mode");
   yield activateFirstAttribute("#attr", inspector); // focuses id
   collapseSelectionAndTab(inspector); // focuses the first attr after id
 
   // Detect the attributes order from the DOM, instead of assuming an order in
   // the test, because the NamedNodeMap returned by element.attributes doesn't
   // guaranty any specific order.
   // Filter out the id attribute as the markup-view places it first anyway.
-  let attrs = getNodeAttributesOtherThanId("#attr");
+  let attrs = yield getNodeAttributesOtherThanId("#attr", testActor);
 
   info("Editing this attribute, keeping the same name, and tabbing to the next");
   yield editAttributeAndTab(attrs[0].name + '="99"', inspector);
   checkFocusedAttribute(attrs[1].name, true);
 
   info("Editing the new focused attribute, keeping the name, and tabbing to the previous");
   yield editAttributeAndTab(attrs[1].name + '="99"', inspector, true);
   checkFocusedAttribute(attrs[0].name, true);
@@ -47,17 +47,17 @@ function* testAttributeEditing(inspector
   info("Editing attribute name, changes attribute order");
   yield editAttributeAndTab("d='4'", inspector);
   checkFocusedAttribute("id", true);
 
   // Escape of the currently focused field for the next test
   EventUtils.sendKey("escape", inspector.panelWin);
 }
 
-function* testAttributeDeletion(inspector) {
+function* testAttributeDeletion(inspector, testActor) {
   info("Testing focus position after attribute deletion");
 
   // Modifying attributes reorders them in the internal representation to move
   // the modified attribute to the end. breadcrumbs.js will update attributes
   // to match original order if you selectNode before modifying attributes.
   // So, hacky workaround for consistency with manual testing.
   // Should be removed after Bug 1093593.
   yield selectNode("#delattr", inspector);
@@ -65,17 +65,17 @@ function* testAttributeDeletion(inspecto
   info("Setting the first non-id attribute in edit mode");
   yield activateFirstAttribute("#delattr", inspector); // focuses id
   collapseSelectionAndTab(inspector); // focuses the first attr after id
 
   // Detect the attributes order from the DOM, instead of assuming an order in
   // the test, because the NamedNodeMap returned by element.attributes doesn't
   // guaranty any specific order.
   // Filter out the id attribute as the markup-view places it first anyway.
-  let attrs = getNodeAttributesOtherThanId("#delattr");
+  let attrs = yield getNodeAttributesOtherThanId("#delattr", testActor);
 
   info("Entering an invalid attribute to delete the attribute");
   yield editAttributeAndTab('"', inspector);
   checkFocusedAttribute(attrs[1].name, true);
 
   info("Deleting the last attribute");
   yield editAttributeAndTab(" ", inspector);
 
@@ -105,11 +105,13 @@ function* activateFirstAttribute(contain
   let {editor} = yield getContainerForSelector(container, inspector);
   editor.tag.focus();
 
   // Go to "id" attribute and trigger edit mode.
   EventUtils.sendKey("tab", inspector.panelWin);
   EventUtils.sendKey("return", inspector.panelWin);
 }
 
-function getNodeAttributesOtherThanId(selector) {
-  return [...getNode(selector).attributes].filter(attr => attr.name !== "id");
+function* getNodeAttributesOtherThanId(selector, testActor) {
+  return (yield testActor.getAttributes(selector)).filter(attr => {
+    return attr.name !== "id";
+  });
 }
diff --git a/devtools/client/markupview/test/browser_markupview_textcontent_edit_01.js b/devtools/client/markupview/test/browser_markupview_textcontent_edit_01.js
--- a/devtools/client/markupview/test/browser_markupview_textcontent_edit_01.js
+++ b/devtools/client/markupview/test/browser_markupview_textcontent_edit_01.js
@@ -4,49 +4,53 @@
 
 "use strict";
 
 // Test editing a node's text content
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_edit.html";
 
 add_task(function*() {
-  let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {inspector, testActor} = yield addTab(TEST_URL).then(openInspector);
 
   info("Expanding all nodes");
   yield inspector.markup.expandAll();
   yield waitForMultipleChildrenUpdates(inspector);
 
-  yield editContainer(inspector, {
+  yield editContainer(inspector, testActor, {
     selector: ".node6",
     newValue: "New text",
     oldValue: "line6"
   });
 
-  yield editContainer(inspector, {
+  yield editContainer(inspector, testActor, {
     selector: "#node17",
     newValue: "LOREM IPSUM DOLOR SIT AMET, CONSECTETUR ADIPISCING ELIT. DONEC POSUERE PLACERAT MAGNA ET IMPERDIET.",
     oldValue: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec posuere placerat magna et imperdiet.",
     shortValue: true
   });
 
-  yield editContainer(inspector, {
+  yield editContainer(inspector, testActor, {
     selector: "#node17",
     newValue: "New value",
     oldValue: "LOREM IPSUM DOLOR SIT AMET, CONSECTETUR ADIPISCING ELIT. DONEC POSUERE PLACERAT MAGNA ET IMPERDIET.",
     shortValue: true
   });
 });
 
-function* editContainer(inspector, {selector, newValue, oldValue, shortValue}) {
-  let node = getNode(selector).firstChild;
-  is(node.nodeValue, oldValue, "The test node's text content is correct");
+function* editContainer(inspector, testActor, data) {
+  let {selector, newValue, oldValue, shortValue} = data;
+  let nodeValue;
+
+  nodeValue = yield testActor.eval(
+    `document.querySelector("${selector}").firstChild.nodeValue`);
+  is(nodeValue, oldValue, "The test node's text content is correct");
 
   info("Changing the text content");
-  let onMutated = inspector.once("markupmutation");
+  let onMutation = inspector.once("markupmutation");
   let container = yield getContainerForSelector(selector, inspector);
   let field = container.elt.querySelector("pre");
 
   if (shortValue) {
     is (oldValue.indexOf(field.textContent.substring(0, field.textContent.length - 1)), 0,
         "The shortened value starts with the full value " + field.textContent);
     ok (oldValue.length > field.textContent.length, "The shortened value is short");
   } else {
@@ -59,16 +63,18 @@ function* editContainer(inspector, {sele
     info("Waiting for the text to be updated");
     yield inspector.markup.once("text-expand");
   }
 
   is (field.textContent, oldValue, "The text node has the correct original value after selecting");
   setEditableFieldValue(field, newValue, inspector);
 
   info("Listening to the markupmutation event");
-  yield onMutated;
+  yield onMutation;
 
-  is(node.nodeValue, newValue, "The test node's text content has changed");
+  nodeValue = yield testActor.eval(
+    `document.querySelector("${selector}").firstChild.nodeValue`);
+  is(nodeValue, newValue, "The test node's text content has changed");
 
   info("Selecting the <body> to reset the selection");
   let bodyContainer = yield getContainerForSelector("body", inspector);
   inspector.markup.markNodeAsSelected(bodyContainer.node);
 }
diff --git a/devtools/client/markupview/test/browser_markupview_toggle_01.js b/devtools/client/markupview/test/browser_markupview_toggle_01.js
--- a/devtools/client/markupview/test/browser_markupview_toggle_01.js
+++ b/devtools/client/markupview/test/browser_markupview_toggle_01.js
@@ -5,16 +5,17 @@
 "use strict";
 
 // Test toggling (expand/collapse) elements by clicking on twisties
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_toggle.html";
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {walker} = inspector;
 
   info("Getting the container for the html element");
   let container = yield getContainerForSelector("html", inspector);
   ok(container.mustExpand, "HTML element mustExpand");
   ok(container.canExpand, "HTML element canExpand");
   is(container.expander.style.visibility, "hidden", "HTML twisty is hidden");
 
   info("Getting the container for the UL parent element");
@@ -27,30 +28,31 @@ add_task(function*() {
   let onChildren = waitForChildrenUpdated(inspector);
   let onUpdated = inspector.once("inspector-updated");
   EventUtils.synthesizeMouseAtCenter(container.expander, {},
     inspector.markup.doc.defaultView);
   yield onChildren;
   yield onUpdated;
 
   info("Checking that child LI elements have been created");
-  for (let i = 0; i < content.document.querySelectorAll("li").length; i ++) {
+  let liCount = (yield walker.querySelectorAll(walker.rootNode, "li")).length;
+  for (let i = 0; i < liCount; i ++) {
     let liContainer = yield getContainerForSelector(
       "li:nth-child(" + (i + 1) + ")", inspector);
     ok(liContainer, "A container for the child LI element was created");
   }
   ok(container.expanded, "Parent UL container is expanded");
 
   info("Clicking again on the UL expander");
   // No need to wait, this is a local, synchronous operation where nodes are
   // only hidden from the view, not destroyed
   EventUtils.synthesizeMouseAtCenter(container.expander, {},
     inspector.markup.doc.defaultView);
 
   info("Checking that child LI elements have been hidden");
-  for (let i = 0; i < content.document.querySelectorAll("li").length; i ++) {
+  for (let i = 0; i < liCount; i ++) {
     let liContainer = yield getContainerForSelector(
       "li:nth-child(" + (i + 1) + ")", inspector);
     is(liContainer.elt.getClientRects().length, 0,
       "The container for the child LI element was hidden");
   }
   ok(!container.expanded, "Parent UL container is collapsed");
 });
diff --git a/devtools/client/markupview/test/browser_markupview_toggle_02.js b/devtools/client/markupview/test/browser_markupview_toggle_02.js
--- a/devtools/client/markupview/test/browser_markupview_toggle_02.js
+++ b/devtools/client/markupview/test/browser_markupview_toggle_02.js
@@ -5,43 +5,45 @@
 "use strict";
 
 // Test toggling (expand/collapse) elements by dbl-clicking on tag lines
 
 const TEST_URL = TEST_URL_ROOT + "doc_markup_toggle.html";
 
 add_task(function*() {
   let {inspector} = yield addTab(TEST_URL).then(openInspector);
+  let {walker} = inspector;
 
   info("Getting the container for the UL parent element");
   let container = yield getContainerForSelector("ul", inspector);
 
   info("Dbl-clicking on the UL parent expander, and waiting for children");
   let onChildren = waitForChildrenUpdated(inspector);
   let onUpdated = inspector.once("inspector-updated");
   EventUtils.synthesizeMouseAtCenter(container.tagLine, {clickCount: 2},
     inspector.markup.doc.defaultView);
   yield onChildren;
   yield onUpdated;
 
   info("Checking that child LI elements have been created");
-  for (let i = 0; i < content.document.querySelectorAll("li").length; i ++) {
+  let liCount = (yield walker.querySelectorAll(walker.rootNode, "li")).length;
+  for (let i = 0; i < liCount; i++) {
     let liContainer = yield getContainerForSelector(
       "li:nth-child(" + (i + 1) + ")", inspector);
     ok(liContainer, "A container for the child LI element was created");
   }
   ok(container.expanded, "Parent UL container is expanded");
 
   info("Dbl-clicking again on the UL expander");
   // No need to wait, this is a local, synchronous operation where nodes are
   // only hidden from the view, not destroyed
   EventUtils.synthesizeMouseAtCenter(container.tagLine, {clickCount: 2},
     inspector.markup.doc.defaultView);
 
   info("Checking that child LI elements have been hidden");
-  for (let i = 0; i < content.document.querySelectorAll("li").length; i ++) {
+  for (let i = 0; i < liCount; i++) {
     let liContainer = yield getContainerForSelector(
       "li:nth-child(" + (i + 1) + ")", inspector);
     is(liContainer.elt.getClientRects().length, 0,
       "The container for the child LI element was hidden");
   }
   ok(!container.expanded, "Parent UL container is collapsed");
 });
diff --git a/devtools/client/markupview/test/browser_markupview_update-on-navigtion.js b/devtools/client/markupview/test/browser_markupview_update-on-navigtion.js
--- a/devtools/client/markupview/test/browser_markupview_update-on-navigtion.js
+++ b/devtools/client/markupview/test/browser_markupview_update-on-navigtion.js
@@ -5,23 +5,23 @@
 
 // Test that markup view handles page navigation correctly.
 
 const SCHEMA = "data:text/html;charset=UTF-8,";
 const URL_1 = SCHEMA + "<div id='one' style='color:red;'>ONE</div>";
 const URL_2 = SCHEMA + "<div id='two' style='color:green;'>TWO</div>";
 
 add_task(function* () {
-  let { inspector, toolbox } = yield addTab(URL_1).then(openInspector);
+  let {inspector, toolbox, testActor} = yield addTab(URL_1).then(openInspector);
 
   assertMarkupViewIsLoaded();
   yield selectNode("#one", inspector);
 
   let willNavigate = toolbox.target.once("will-navigate");
-  content.location = URL_2;
+  testActor.eval(`document.location = "${URL_2}"`);
 
   info("Waiting for will-navigate");
   yield willNavigate;
 
   info("Navigation to page 2 has started, the inspector should be empty");
   assertMarkupViewIsEmpty();
 
   info("Waiting for new-root");
diff --git a/devtools/client/markupview/test/head.js b/devtools/client/markupview/test/head.js
--- a/devtools/client/markupview/test/head.js
+++ b/devtools/client/markupview/test/head.js
@@ -18,16 +18,20 @@ waitForExplicitFinish();
 
 // If a test times out we want to see the complete log and not just the last few
 // lines.
 SimpleTest.requestCompleteLog();
 
 // Uncomment this pref to dump all devtools emitted events to the console.
 // Services.prefs.setBoolPref("devtools.dump.emit", true);
 
+// Import helpers registering the test-actor in remote targets
+var testDir = gTestPath.substr(0, gTestPath.lastIndexOf("/"));
+Services.scriptloader.loadSubScript(testDir + "../../../shared/test/test-actor-registry.js", this);
+
 // Set the testing flag on DevToolsUtils and reset it when the test ends
 DevToolsUtils.testing = true;
 registerCleanupFunction(() => DevToolsUtils.testing = false);
 
 // Clear preferences that may be set during the course of tests.
 registerCleanupFunction(() => {
   Services.prefs.clearUserPref("devtools.inspector.htmlPanelOpen");
   Services.prefs.clearUserPref("devtools.inspector.sidebarOpen");
@@ -132,17 +136,21 @@ function openToolbox(toolId) {
  * @return a promise that resolves when the inspector is ready
  */
 function openInspector() {
   return openToolbox("inspector").then(({toolbox}) => {
     let inspector = toolbox.getCurrentPanel();
     let eventId = "inspector-updated";
     return inspector.once("inspector-updated").then(() => {
       info("The inspector panel is active and ready");
-      return {toolbox: toolbox, inspector: inspector};
+      return registerTestActor(toolbox.target.client);
+    }).then(() => {
+      return getTestActor(toolbox);
+    }).then((testActor) => {
+      return {toolbox, inspector, testActor};
     });
   });
 }
 
 /**
  * Wait for a content -> chrome message on the message manager (the window
  * messagemanager is used).
  * @param {String} name The message name
@@ -189,30 +197,16 @@ function executeInContent(name, data={},
 /**
  * Reload the current tab location.
  */
 function reloadTab() {
   return executeInContent("devtools:test:reload", {}, {}, false);
 }
 
 /**
- * Simple DOM node accesor function that takes either a node or a string css
- * selector as argument and returns the corresponding node
- * @param {String|DOMNode} nodeOrSelector
- * @return {DOMNode|CPOW} Note that in e10s mode a CPOW object is returned which
- * doesn't implement *all* of the DOMNode's properties
- */
-function getNode(nodeOrSelector) {
-  info("Getting the node for '" + nodeOrSelector + "'");
-  return typeof nodeOrSelector === "string" ?
-    content.document.querySelector(nodeOrSelector) :
-    nodeOrSelector;
-}
-
-/**
  * Get the NodeFront for a given css selector, via the protocol
  * @param {String|NodeFront} selector
  * @param {InspectorPanel} inspector The instance of InspectorPanel currently
  * loaded in the toolbox
  * @return {Promise} Resolves to the NodeFront instance
  */
 function getNodeFront(selector, {walker}) {
   if (selector._form) {
diff --git a/devtools/client/markupview/test/helper_attributes_test_runner.js b/devtools/client/markupview/test/helper_attributes_test_runner.js
--- a/devtools/client/markupview/test/helper_attributes_test_runner.js
+++ b/devtools/client/markupview/test/helper_attributes_test_runner.js
@@ -45,27 +45,25 @@ function runAddAttributesTests(tests, no
  *          - {DOMNode} The element being tested
  *          - {MarkupContainer} The corresponding container in the markup-view
  *          - {InspectorPanel} The instance of the InspectorPanel opened
  * @param {String} selector The node selector corresponding to the test element
  * @param {InspectorPanel} inspector The instance of InspectorPanel currently
  * opened
  */
 function* runAddAttributesTest(test, selector, inspector) {
-  let element = getNode(selector);
-
   info("Starting add-attribute test: " + test.desc);
   yield addNewAttributes(selector, test.text, inspector);
 
   info("Assert that the attribute(s) has/have been applied correctly");
   yield assertAttributes(selector, test.expectedAttributes);
 
   if (test.validate) {
     let container = yield getContainerForSelector(selector, inspector);
-    test.validate(element, container, inspector);
+    test.validate(selector, container, inspector);
   }
 
   info("Undo the change");
   yield undoChange(inspector);
 
   info("Assert that the attribute(s) has/have been removed correctly");
   yield assertAttributes(selector, {});
 }
diff --git a/devtools/client/markupview/test/helper_outerhtml_test_runner.js b/devtools/client/markupview/test/helper_outerhtml_test_runner.js
--- a/devtools/client/markupview/test/helper_outerhtml_test_runner.js
+++ b/devtools/client/markupview/test/helper_outerhtml_test_runner.js
@@ -10,21 +10,21 @@
  * This test runner will wait for the mutation event to be fired and will check
  * a few things. Each test may also provide its own validate function to perform
  * assertions and verify that the new outer html is correct.
  * @param {Array} tests See runEditOuterHTMLTest for the structure
  * @param {InspectorPanel} inspector The instance of InspectorPanel currently
  * opened
  * @return a promise that resolves when the tests have run
  */
-function runEditOuterHTMLTests(tests, inspector) {
+function runEditOuterHTMLTests(tests, inspector, testActor) {
   info("Running " + tests.length + " edit-outer-html tests");
   return Task.spawn(function* () {
     for (let step of TEST_DATA) {
-      yield runEditOuterHTMLTest(step, inspector);
+      yield runEditOuterHTMLTest(step, inspector, testActor);
     }
   });
 }
 
 /**
  * Run a single edit-outer-html test.
  * See runEditOuterHTMLTests for a description.
  * @param {Object} test A test object should contain the following properties:
@@ -32,44 +32,48 @@ function runEditOuterHTMLTests(tests, in
  *        - oldHTML {String}
  *        - newHTML {String}
  *        - validate {Function} will be executed when the edition test is done,
  *        after the new outer-html has been inserted. Should be used to verify
  *        the actual DOM, see if it corresponds to the newHTML string provided
  * @param {InspectorPanel} inspector The instance of InspectorPanel currently
  * opened
  */
-function* runEditOuterHTMLTest(test, inspector) {
+function* runEditOuterHTMLTest(test, inspector, testActor) {
   info("Running an edit outerHTML test on '" + test.selector + "'");
   yield selectNode(test.selector, inspector);
   let oldNodeFront = inspector.selection.nodeFront;
 
   let onUpdated = inspector.once("inspector-updated");
 
   info("Listen for reselectedonremoved and edit the outerHTML");
   let onReselected = inspector.markup.once("reselectedonremoved");
   yield inspector.markup.updateNodeOuterHTML(inspector.selection.nodeFront,
                                              test.newHTML, test.oldHTML);
   yield onReselected;
 
-  // Typically selectedNode will === pageNode, but if a new element has been
-  // injected in front of it, this will not be the case. If this happens.
+  // Typically selectedNode will === node matched by selector,
+  // but if a new element has been injected in front of it,
+  // this will not be the case. If this happens.
   let selectedNodeFront = inspector.selection.nodeFront;
-  let pageNodeFront = yield inspector.walker.querySelector(inspector.walker.rootNode, test.selector);
-  let pageNode = getNode(test.selector);
+  let {walker} = inspector;
+  let pageNodeFront = yield walker.querySelector(walker.rootNode, test.selector);
 
   if (test.validate) {
-    yield test.validate(pageNode, pageNodeFront, selectedNodeFront, inspector);
+    let data = {selector: test.selector, pageNodeFront, selectedNodeFront};
+    yield test.validate(data, inspector, testActor);
   } else {
-    is(pageNodeFront, selectedNodeFront, "Original node (grabbed by selector) is selected");
+    is(pageNodeFront, selectedNodeFront,
+      "Original node (grabbed by selector) is selected");
     let {outerHTML} = yield getNodeInfo(test.selector);
     is(outerHTML, test.newHTML, "Outer HTML has been updated");
   }
 
   // Wait for the inspector to be fully updated to avoid causing errors by
   // abruptly closing hanging requests when the test ends
   yield onUpdated;
 
   let closeTagLine = inspector.markup.getContainer(pageNodeFront).closeTagLine;
   if (closeTagLine) {
-    is(closeTagLine.querySelectorAll(".theme-fg-contrast").length, 0, "No contrast class");
+    is(closeTagLine.querySelectorAll(".theme-fg-contrast").length, 0,
+      "No contrast class");
   }
 }
diff --git a/devtools/client/shared/test/test-actor.js b/devtools/client/shared/test/test-actor.js
--- a/devtools/client/shared/test/test-actor.js
+++ b/devtools/client/shared/test/test-actor.js
@@ -1,15 +1,15 @@
 /* vim: set ft=javascript ts=2 et sw=2 tw=80: */
 /* Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/ */
 
 "use strict";
 
-// A helper actor for brower/devtools/inspector tests.
+// A helper actor for inspector and markupview tests.
 
 var { Cc, Ci, Cu, Cr } = require("chrome");
 const {getRect, getElementFromPoint, getAdjustedQuads} = require("devtools/shared/layout/utils");
 const promise = require("promise");
 const {Task} = Cu.import("resource://gre/modules/Task.jsm", {});
 var DOMUtils = Cc["@mozilla.org/inspector/dom-utils;1"].getService(Ci.inIDOMUtils);
 var loader = Cc["@mozilla.org/moz/jssubscript-loader;1"]
             .getService(Ci.mozIJSSubScriptLoader);
@@ -408,17 +408,17 @@ var TestActor = exports.TestActor = prot
     response: {
       value: RetVal("json")
     }
   }),
 
   /**
    * Set a JS property on a DOM Node.
    * @param {String} selector The node selector
-   * @param {String} attribute The attribute name
+   * @param {String} property The property name
    * @param {String} value The attribute value
    */
   setProperty: protocol.method(function (selector, property, value) {
     let node = this._querySelector(selector);
     node[property] = value;
   }, {
     request: {
       selector: Arg(0, "string"),
@@ -426,33 +426,156 @@ var TestActor = exports.TestActor = prot
       value: Arg(2, "string")
     },
     response: {}
   }),
 
   /**
    * Get a JS property on a DOM Node.
    * @param {String} selector The node selector
-   * @param {String} attribute The attribute name
-   * @return {String} value The attribute value
+   * @param {String} property The property name
+   * @return {String} value The property value
    */
   getProperty: protocol.method(function (selector, property) {
     let node = this._querySelector(selector);
     return node[property];
   }, {
     request: {
       selector: Arg(0, "string"),
       property: Arg(1, "string")
     },
     response: {
       value: RetVal("string")
     }
   }),
 
   /**
+   * Get an attribute on a DOM Node.
+   * @param {String} selector
+   * @param {String} attribute
+   * @return {String} value
+   */
+  getAttribute: protocol.method(function(selector, attribute) {
+    let node = this._querySelector(selector);
+    return node.getAttribute(attribute);
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+      attribute: Arg(1, "string")
+    },
+    response: {
+      value: RetVal("string")
+    }
+  }),
+
+  /**
+   * Get attributes on a DOM Node.
+   *
+   * @param  {String} selector
+   * @return {Array}
+   *         Array of attributes (e.g. [{name: "id", value: "value"}]).
+   */
+  getAttributes: protocol.method(function (selector) {
+    let node = this._querySelector(selector);
+    return [...node.attributes].map(attribute => {
+      return {
+        name: attribute.name,
+        value: attribute.value
+      }
+    });
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+    },
+    response: {
+      value: RetVal("json")
+    }
+  }),
+
+  /**
+   * Set an attribute on a DOM Node.
+   * @param {String} selector
+   * @param {String} attribute
+   * @param {String} value
+   */
+  setAttribute: protocol.method(function(selector, attribute, value) {
+    let node = this._querySelector(selector);
+    node.setAttribute(attribute, value);
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+      attribute: Arg(1, "string"),
+      value: Arg(2, "string")
+    },
+    response: {}
+  }),
+
+  /**
+   * Remove an attribute on a DOM Node.
+   * @param {String} selector
+   * @param {String} attribute
+   */
+  removeAttribute: protocol.method(function(selector, attribute) {
+    let node = this._querySelector(selector);
+    node.removeAttribute(attribute);
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+      attribute: Arg(1, "string")
+    },
+    response: {}
+  }),
+
+  /**
+   * Add class on a DOM Node.
+   * @param {String} selector
+   * @param {String} className
+   */
+  addClass: protocol.method(function(selector, className) {
+    let node = this._querySelector(selector);
+    node.classList.add(className);
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+      className: Arg(1, "string")
+    },
+    response: {}
+  }),
+
+  /**
+   * Remove class on a DOM Node.
+   * @param {String} selector
+   * @param {String} className
+   */
+  removeClass: protocol.method(function(selector, className) {
+    let node = this._querySelector(selector);
+    node.classList.remove(className);
+  }, {
+    request: {
+      selector: Arg(0, "string"),
+      className: Arg(1, "string")
+    },
+    response: {}
+  }),
+
+  /**
+   * Remove a DOM Node.
+   * @param {String} selector
+   */
+  removeNode: protocol.method(function(selector) {
+    let node = this._querySelector(selector);
+    node.remove();
+  }, {
+    request: {
+      selector: Arg(0, "string")
+    },
+    response: {}
+  }),
+
+  /**
    * Reload an iframe and wait for its load event.
    * @param {String} selector The node selector
    */
   reloadFrame: protocol.method(function (selector) {
     let node = this._querySelector(selector);
 
     let deferred = promise.defer();
 
diff --git a/intl/icu/source/acinclude.m4.orig b/intl/icu/source/acinclude.m4.orig
deleted file mode 100644
--- a/intl/icu/source/acinclude.m4.orig
+++ /dev/null
@@ -1,500 +0,0 @@
-# Copyright (c) 1999-2015, International Business Machines Corporation and
-# others. All Rights Reserved.
-# acinclude.m4 for ICU
-# Don't edit aclocal.m4, do edit acinclude.m4
-# Stephen F. Booth
-
-# @TOP@
-
-# ICU_CHECK_MH_FRAG
-AC_DEFUN([ICU_CHECK_MH_FRAG], [
-	AC_CACHE_CHECK(
-		[which Makefile fragment to use for ${host}],
-		[icu_cv_host_frag],
-		[
-case "${host}" in
-*-*-solaris*)
-	if test "$GCC" = yes; then	
-		icu_cv_host_frag=mh-solaris-gcc
-	else
-		icu_cv_host_frag=mh-solaris
-	fi ;;
-alpha*-*-linux-gnu)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-alpha-linux-gcc
-	else
-		icu_cv_host_frag=mh-alpha-linux-cc
-	fi ;;
-powerpc*-*-linux*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-linux
-	else
-		icu_cv_host_frag=mh-linux-va
-	fi ;;
-*-*-linux*|*-*-gnu|*-*-k*bsd*-gnu|*-*-kopensolaris*-gnu) icu_cv_host_frag=mh-linux ;;
-i[[34567]]86-*-cygwin) 
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-cygwin
-	else
-		icu_cv_host_frag=mh-cygwin-msvc
-	fi ;;
-x86_64-*-cygwin) 
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-cygwin64
-	else
-		icu_cv_host_frag=mh-cygwin-msvc
-	fi ;;
-*-*-mingw*)
-	if test "$GCC" = yes; then
-                AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
-#ifndef __MINGW64__
-#error This is not MinGW64
-#endif]])],                        [icu_cv_host_frag=mh-mingw64],
-                                   [icu_cv_host_frag=mh-mingw])
-	else
-	        case "${host}" in
-		*-*-mingw*) icu_cv_host_frag=mh-msys-msvc ;;
-		*-*-cygwin) icu_cv_host_frag=mh-cygwin-msvc ;;
-		esac
-	fi ;;
-*-*-*bsd*|*-*-dragonfly*) 	icu_cv_host_frag=mh-bsd-gcc ;;
-*-*-aix*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-aix-gcc
-	else
-		icu_cv_host_frag=mh-aix-va
-	fi ;;
-*-*-hpux*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-hpux-gcc
-	else
-		case "$CXX" in
-		*aCC)    icu_cv_host_frag=mh-hpux-acc ;;
-		esac
-	fi ;;
-*-*ibm-openedition*|*-*-os390*)	icu_cv_host_frag=mh-os390 ;;
-*-*-os400*)	icu_cv_host_frag=mh-os400 ;;
-*-apple-rhapsody*)	icu_cv_host_frag=mh-darwin ;;
-*-apple-darwin*)	icu_cv_host_frag=mh-darwin ;;
-*-*-beos)       icu_cv_host_frag=mh-beos ;; 
-*-*-haiku)      icu_cv_host_frag=mh-haiku ;; 
-*-*-irix*)	icu_cv_host_frag=mh-irix ;;
-*-dec-osf*) icu_cv_host_frag=mh-alpha-osf ;;
-*-*-nto*)	icu_cv_host_frag=mh-qnx ;;
-*-ncr-*)	icu_cv_host_frag=mh-mpras ;;
-*) 		icu_cv_host_frag=mh-unknown ;;
-esac
-		]
-	)
-])
-
-# ICU_PROG_LINK - Make sure that the linker is usable
-AC_DEFUN([ICU_PROG_LINK],
-[
-case "${host}" in
-    *-*-cygwin*|*-*-mingw*)
-        if test "$GCC" != yes && test -n "`link --version 2>&1 | grep 'GNU coreutils'`"; then
-            AC_MSG_ERROR([link.exe is not a valid linker. Your PATH is incorrect.
-                  Please follow the directions in ICU's readme.])
-        fi;;
-    *);;
-esac])
-
-# AC_SEARCH_LIBS_FIRST(FUNCTION, SEARCH-LIBS [, ACTION-IF-FOUND
-#            [, ACTION-IF-NOT-FOUND [, OTHER-LIBRARIES]]])
-# Search for a library defining FUNC, then see if it's not already available.
-
-AC_DEFUN([AC_SEARCH_LIBS_FIRST],
-[AC_PREREQ([2.13])
-AC_CACHE_CHECK([for library containing $1], [ac_cv_search_$1],
-[ac_func_search_save_LIBS="$LIBS"
-ac_cv_search_$1="no"
-for i in $2; do
-LIBS="-l$i $5 $ac_func_search_save_LIBS"
-AC_TRY_LINK_FUNC([$1],
-[ac_cv_search_$1="-l$i"
-break])
-done
-if test "$ac_cv_search_$1" = "no"; then
-AC_TRY_LINK_FUNC([$1], [ac_cv_search_$1="none required"])
-fi
-LIBS="$ac_func_search_save_LIBS"])
-if test "$ac_cv_search_$1" != "no"; then
-  test "$ac_cv_search_$1" = "none required" || LIBS="$ac_cv_search_$1 $LIBS"
-  $3
-else :
-  $4
-fi])
-
-
-
-# Check if we can build and use 64-bit libraries
-AC_DEFUN([AC_CHECK_64BIT_LIBS],
-[
-    BITS_REQ=nochange
-    ENABLE_64BIT_LIBS=unknown
-    ## revisit this for cross-compile.
-    
-    AC_ARG_ENABLE(64bit-libs,
-        [  --enable-64bit-libs     (deprecated, use --with-library-bits) build 64-bit libraries [default= platform default]],
-        [echo "note, use --with-library-bits instead of --*-64bit-libs"
-         case "${enableval}" in
-            no|false|32) with_library_bits=32;  ;;
-            yes|true|64) with_library_bits=64else32 ;;
-            nochange) with_library_bits=nochange; ;;
-            *) AC_MSG_ERROR(bad value ${enableval} for '--*-64bit-libs') ;;
-            esac]    )
-    
-
-    AC_ARG_WITH(library-bits,
-        [  --with-library-bits=bits specify how many bits to use for the library (32, 64, 64else32, nochange) [default=nochange]],
-        [case "${withval}" in
-            ""|nochange) BITS_REQ=$withval ;;
-            32|64|64else32) BITS_REQ=$withval ;;
-            *) AC_MSG_ERROR(bad value ${withval} for --with-library-bits) ;;
-            esac])
-        
-    # don't use these for cross compiling
-    if test "$cross_compiling" = "yes" -a "${BITS_REQ}" != "nochange"; then
-        AC_MSG_ERROR([Don't specify bitness when cross compiling. See readme.html for help with cross compilation., and set compiler options manually.])
-    fi
-    AC_CHECK_SIZEOF([void *])
-    AC_MSG_CHECKING([whether runnable 64 bit binaries are built by default])
-    case $ac_cv_sizeof_void_p in
-        8) DEFAULT_64BIT=yes ;;
-        4) DEFAULT_64BIT=no ;;
-        *) DEFAULT_64BIT=unknown
-    esac
-    BITS_GOT=unknown
-    
-    # 'OK' here means, we can exit any further checking, everything's copa
-    BITS_OK=yes
-
-    # do we need to check for buildable/runnable 32 or 64 bit?
-    BITS_CHECK_32=no
-    BITS_CHECK_64=no
-    
-    # later, can we run the 32/64 bit binaries so made?
-    BITS_RUN_32=no
-    BITS_RUN_64=no
-    
-    if test "$DEFAULT_64BIT" = "yes"; then
-        # we get 64 bits by default.
-        BITS_GOT=64
-        case "$BITS_REQ" in
-            32) 
-                # need to look for 32 bit support. 
-                BITS_CHECK_32=yes
-                # not copa.
-                BITS_OK=no;;
-            # everyone else is happy.
-            nochange) ;;
-            *) ;;
-        esac
-    elif test "$DEFAULT_64BIT" = "no"; then
-        # not 64 bit by default.
-        BITS_GOT=32
-        case "$BITS_REQ" in
-            64|64else32)
-                BITS_CHECK_64=yes
-                #BITS_CHECK_32=yes
-                BITS_OK=no;;
-            nochange) ;;
-            *) ;;
-        esac
-    elif test "$DEFAULT_64BIT" = "unknown"; then
-        # cross compiling.
-        BITS_GOT=unknown
-        case "$BITS_REQ" in
-            64|64else32) BITS_OK=no
-            BITS_CHECK_32=yes
-            BITS_CHECK_64=yes ;;
-            32) BITS_OK=no;;
-            nochange) ;;
-            *) ;;
-        esac
-    fi
-            
-    AC_MSG_RESULT($DEFAULT_64BIT);
-
-    if test "$BITS_OK" != "yes"; then
-        # not copa. back these up.
-        CFLAGS_OLD="${CFLAGS}"
-        CXXFLAGS_OLD="${CXXFLAGS}"
-        LDFLAGS_OLD="${LDFLAGS}"
-        ARFLAGS_OLD="${ARFLAGS}"        
-        
-        CFLAGS_32="${CFLAGS}"
-        CXXFLAGS_32="${CXXFLAGS}"
-        LDFLAGS_32="${LDFLAGS}"
-        ARFLAGS_32="${ARFLAGS}"        
-        
-        CFLAGS_64="${CFLAGS}"
-        CXXFLAGS_64="${CXXFLAGS}"
-        LDFLAGS_64="${LDFLAGS}"
-        ARFLAGS_64="${ARFLAGS}"        
-        
-        CAN_BUILD_64=unknown
-        CAN_BUILD_32=unknown
-        # These results can't be cached because is sets compiler flags.
-        if test "$BITS_CHECK_64" = "yes"; then
-            AC_MSG_CHECKING([how to build 64-bit executables])
-            CAN_BUILD_64=no
-            ####
-            # Find out if we think we can *build* for 64 bit. Doesn't check whether we can run it.
-            #  Note, we don't have to actually check if the options work- we'll try them before using them.
-            #  So, only try actually testing the options, if you are trying to decide between multiple options.
-            # On exit from the following clauses:
-            # if CAN_BUILD_64=yes:
-            #    *FLAGS are assumed to contain the right settings for 64bit
-            # else if CAN_BUILD_64=no: (default)
-            #    *FLAGS are assumed to be trashed, and will be reset from *FLAGS_OLD
-            
-            if test "$GCC" = yes; then
-                CFLAGS="${CFLAGS} -m64"
-                CXXFLAGS="${CXXFLAGS} -m64"
-                AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                   CAN_BUILD_64=yes, CAN_BUILD_64=no)
-            else
-                case "${host}" in
-                sparc*-*-solaris*)
-                    # 1. try -m64
-                    CFLAGS="${CFLAGS} -m64"
-                    CXXFLAGS="${CXXFLAGS} -m64"
-                    AC_RUN_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                       CAN_BUILD_64=yes, CAN_BUILD_64=no, CAN_BUILD_64=unknown)
-                    if test "$CAN_BUILD_64" != yes; then
-                        # Nope. back out changes.
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # 2. try xarch=v9 [deprecated]
-                        ## TODO: cross compile: the following won't work.
-                        SPARCV9=`isainfo -n 2>&1 | grep sparcv9`
-                        SOL64=`$CXX -xarch=v9 2>&1 && $CC -xarch=v9 2>&1 | grep -v usage:`
-                        # "Warning: -xarch=v9 is deprecated, use -m64 to create 64-bit programs"
-                        if test -z "$SOL64" && test -n "$SPARCV9"; then
-                            CFLAGS="${CFLAGS} -xtarget=ultra -xarch=v9"
-                            CXXFLAGS="${CXXFLAGS} -xtarget=ultra -xarch=v9"
-                            LDFLAGS="${LDFLAGS} -xtarget=ultra -xarch=v9"
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                i386-*-solaris*)
-                    # 1. try -m64
-                    CFLAGS="${CFLAGS} -m64"
-                    CXXFLAGS="${CXXFLAGS} -m64"
-                    AC_RUN_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                       CAN_BUILD_64=yes, CAN_BUILD_64=no, CAN_BUILD_64=unknown)
-                    if test "$CAN_BUILD_64" != yes; then
-                        # Nope. back out changes.
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # 2. try the older compiler option
-                        ## TODO: cross compile problem
-                        AMD64=`isainfo -n 2>&1 | grep amd64`
-                        SOL64=`$CXX -xtarget=generic64 2>&1 && $CC -xtarget=generic64 2>&1 | grep -v usage:`
-                        if test -z "$SOL64" && test -n "$AMD64"; then
-                            CFLAGS="${CFLAGS} -xtarget=generic64"
-                            CXXFLAGS="${CXXFLAGS} -xtarget=generic64"
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                ia64-*-linux*)
-                    # check for ecc/ecpc compiler support
-                    ## TODO: cross compiler problem
-                    if test -n "`$CXX --help 2>&1 && $CC --help 2>&1 | grep -v Intel`"; then
-                        if test -n "`$CXX --help 2>&1 && $CC --help 2>&1 | grep -v Itanium`"; then
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                *-*-cygwin)
-                    # vcvarsamd64.bat should have been used to enable 64-bit builds.
-                    # We only do this check to display the correct answer.
-                    ## TODO: cross compiler problem
-                    if test -n "`$CXX -help 2>&1 | grep 'for x64'`"; then
-                        CAN_BUILD_64=yes
-                    fi
-                    ;;
-                *-*-aix*|powerpc64-*-linux*)
-                    CFLAGS="${CFLAGS} -q64"
-                    CXXFLAGS="${CXXFLAGS} -q64"
-                    LDFLAGS="${LDFLAGS} -q64"
-                    AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                       CAN_BUILD_64=yes, CAN_BUILD_64=no)
-                    if test "$CAN_BUILD_64" = yes; then
-                        # worked- set other options.
-                        case "${host}" in
-                        *-*-aix*)
-                            # tell AIX what executable mode to use.
-                            ARFLAGS="${ARFLAGS} -X64"
-                        esac
-                    fi
-                    ;;
-                *-*-hpux*)
-                    # First we try the newer +DD64, if that doesn't work,
-                    # try other options.
-
-                    CFLAGS="${CFLAGS} +DD64"
-                    CXXFLAGS="${CXXFLAGS} +DD64"
-                    AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                        CAN_BUILD_64=yes, CAN_BUILD_64=no)
-                    if test "$CAN_BUILD_64" != yes; then
-                        # reset
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # append
-                        CFLAGS="${CFLAGS} +DA2.0W"
-                        CXXFLAGS="${CXXFLAGS} +DA2.0W"
-                        AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                            CAN_BUILD_64=yes, CAN_BUILD_64=no)
-                    fi
-                    ;;
-                *-*ibm-openedition*|*-*-os390*)
-                    CFLAGS="${CFLAGS} -Wc,lp64"
-                    CXXFLAGS="${CXXFLAGS} -Wc,lp64"
-                    LDFLAGS="${LDFLAGS} -Wl,lp64"
-                    AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                       CAN_BUILD_64=yes, CAN_BUILD_64=no)
-                    ;;
-                *)
-                    # unknown platform.
-                    ;;
-                esac
-            fi
-            AC_MSG_RESULT($CAN_BUILD_64)
-            if test "$CAN_BUILD_64" = yes; then
-                AC_MSG_CHECKING([whether runnable 64-bit binaries are being built ])
-                AC_RUN_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==64)?0:1;}])],
-                   BITS_RUN_64=yes, BITS_RUN_64=no, BITS_RUN_64=unknown)
-                AC_MSG_RESULT($BITS_RUN_64);
-
-                CFLAGS_64="${CFLAGS}"
-                CXXFLAGS_64="${CXXFLAGS}"
-                LDFLAGS_64="${LDFLAGS}"
-                ARFLAGS_64="${ARFLAGS}"        
-            fi
-            # put it back.
-            CFLAGS="${CFLAGS_OLD}"
-            CXXFLAGS="${CXXFLAGS_OLD}"
-            LDFLAGS="${LDFLAGS_OLD}"
-            ARFLAGS="${ARFLAGS_OLD}"     
-        fi
-        if test "$BITS_CHECK_32" = "yes"; then
-            # see comment under 'if BITS_CHECK_64', above.
-            AC_MSG_CHECKING([how to build 32-bit executables])
-            if test "$GCC" = yes; then
-                CFLAGS="${CFLAGS} -m32"
-                CXXFLAGS="${CXXFLAGS} -m32"
-                AC_COMPILE_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==32)?0:1;}])],
-                   CAN_BUILD_32=yes, CAN_BUILD_32=no)
-            fi
-            AC_MSG_RESULT($CAN_BUILD_32)
-            if test "$CAN_BUILD_32" = yes; then
-                AC_MSG_CHECKING([whether runnable 32-bit binaries are being built ])
-                AC_RUN_IFELSE([AC_LANG_SOURCE([int main(void) {return (sizeof(void*)*8==32)?0:1;}])],
-                   BITS_RUN_32=yes, BITS_RUN_32=no, BITS_RUN_32=unknown)
-                AC_MSG_RESULT($BITS_RUN_32);
-                CFLAGS_32="${CFLAGS}"
-                CXXFLAGS_32="${CXXFLAGS}"
-                LDFLAGS_32="${LDFLAGS}"
-                ARFLAGS_32="${ARFLAGS}"        
-            fi
-            # put it back.
-            CFLAGS="${CFLAGS_OLD}"
-            CXXFLAGS="${CXXFLAGS_OLD}"
-            LDFLAGS="${LDFLAGS_OLD}"
-            ARFLAGS="${ARFLAGS_OLD}"     
-        fi
-        
-        ##
-        # OK. Now, we've tested for 32 and 64 bitness. Let's see what we'll do.
-        #
-        
-        # First, implement 64else32
-        if test "$BITS_REQ" = "64else32"; then
-            if test "$BITS_RUN_64" = "yes"; then
-                BITS_REQ=64
-            else
-                # no changes.
-                BITS_OK=yes 
-            fi
-        fi
-        
-        # implement.
-        if test "$BITS_REQ" = "32" -a "$BITS_RUN_32" = "yes"; then
-            CFLAGS="${CFLAGS_32}"
-            CXXFLAGS="${CXXFLAGS_32}"
-            LDFLAGS="${LDFLAGS_32}"
-            ARFLAGS="${ARFLAGS_32}"     
-            BITS_OK=yes
-        elif test "$BITS_REQ" = "64" -a "$BITS_RUN_64" = "yes"; then
-            CFLAGS="${CFLAGS_64}"
-            CXXFLAGS="${CXXFLAGS_64}"
-            LDFLAGS="${LDFLAGS_64}"
-            ARFLAGS="${ARFLAGS_64}"     
-            BITS_OK=yes
-        elif test "$BITS_OK" != "yes"; then
-            AC_MSG_ERROR([Requested $BITS_REQ bit binaries but could not compile and execute them. See readme.html for help with cross compilation., and set compiler options manually.])
-        fi
-     fi
-])
-
-# Strict compilation options.
-AC_DEFUN([AC_CHECK_STRICT_COMPILE],
-[
-    AC_MSG_CHECKING([whether strict compiling is on])
-    AC_ARG_ENABLE(strict,[  --enable-strict         compile with strict compiler options [default=yes]], [
-        if test "$enableval" = no
-        then
-            ac_use_strict_options=no
-        else
-            ac_use_strict_options=yes
-        fi
-      ], [ac_use_strict_options=yes])
-    AC_MSG_RESULT($ac_use_strict_options)
-
-    if test "$ac_use_strict_options" = yes
-    then
-        if test "$GCC" = yes
-        then
-            case "${host}" in
-            *)
-                # Do not use -ansi. It limits us to C90, and it breaks some platforms.
-                # We use -std=c99 to disable the gnu99 defaults and its associated warnings
-                CFLAGS="$CFLAGS -std=c99"
-                ;;
-            esac
-            
-            CFLAGS="$CFLAGS -Wall -pedantic -Wshadow -Wpointer-arith -Wmissing-prototypes -Wwrite-strings"
-        else
-            case "${host}" in
-            *-*-cygwin)
-                if test "`$CC /help 2>&1 | head -c9`" = "Microsoft"
-                then
-                    CFLAGS="$CFLAGS /W4"
-                fi ;;
-            *-*-mingw*)
-                CFLAGS="$CFLAGS -W4" ;;
-            esac
-        fi
-        if test "$GXX" = yes
-        then
-            CXXFLAGS="$CXXFLAGS -W -Wall -pedantic -Wpointer-arith -Wwrite-strings -Wno-long-long"
-        else
-            case "${host}" in
-            *-*-cygwin)
-                if test "`$CXX /help 2>&1 | head -c9`" = "Microsoft"
-                then
-                    CXXFLAGS="$CXXFLAGS /W4"
-                fi ;;
-            *-*-mingw*)
-                CFLAGS="$CFLAGS -W4" ;;
-            esac
-        fi
-    fi
-])
-
-
diff --git a/intl/icu/source/common/putilimp.h.orig b/intl/icu/source/common/putilimp.h.orig
deleted file mode 100644
--- a/intl/icu/source/common/putilimp.h.orig
+++ /dev/null
@@ -1,607 +0,0 @@
-/*
-******************************************************************************
-*
-*   Copyright (C) 1997-2015, International Business Machines
-*   Corporation and others.  All Rights Reserved.
-*
-******************************************************************************
-*
-*  FILE NAME : putilimp.h
-*
-*   Date        Name        Description
-*   10/17/04    grhoten     Move internal functions from putil.h to this file.
-******************************************************************************
-*/
-
-#ifndef PUTILIMP_H
-#define PUTILIMP_H
-
-#include "unicode/utypes.h"
-#include "unicode/putil.h"
-
-/**
- * \def U_SIGNED_RIGHT_SHIFT_IS_ARITHMETIC
- * Nearly all CPUs and compilers implement a right-shift of a signed integer
- * as an Arithmetic Shift Right which copies the sign bit (the Most Significant Bit (MSB))
- * into the vacated bits (sign extension).
- * For example, (int32_t)0xfff5fff3>>4 becomes 0xffff5fff and -1>>1=-1.
- *
- * This can be useful for storing a signed value in the upper bits
- * and another bit field in the lower bits.
- * The signed value can be retrieved by simple right-shifting.
- *
- * This is consistent with the Java language.
- *
- * However, the C standard allows compilers to implement a right-shift of a signed integer
- * as a Logical Shift Right which copies a 0 into the vacated bits.
- * For example, (int32_t)0xfff5fff3>>4 becomes 0x0fff5fff and -1>>1=0x7fffffff.
- *
- * Code that depends on the natural behavior should be guarded with this macro,
- * with an alternate path for unusual platforms.
- * @internal
- */
-#ifdef U_SIGNED_RIGHT_SHIFT_IS_ARITHMETIC
-    /* Use the predefined value. */
-#else
-    /*
-     * Nearly all CPUs & compilers implement a right-shift of a signed integer
-     * as an Arithmetic Shift Right (with sign extension).
-     */
-#   define U_SIGNED_RIGHT_SHIFT_IS_ARITHMETIC 1
-#endif
-
-/** Define this to 1 if your platform supports IEEE 754 floating point,
-   to 0 if it does not. */
-#ifndef IEEE_754
-#   define IEEE_754 1
-#endif
-
-/**
- * uintptr_t is an optional part of the standard definitions in stdint.h.
- * The opengroup.org documentation for stdint.h says
- * "On XSI-conformant systems, the intptr_t and uintptr_t types are required;
- * otherwise, they are optional."
- * We assume that when uintptr_t is defined, UINTPTR_MAX is defined as well.
- *
- * Do not use ptrdiff_t since it is signed. size_t is unsigned.
- */
-/* TODO: This check fails on some z environments. Filed a ticket #9357 for this. */
-#if !defined(__intptr_t_defined) && !defined(UINTPTR_MAX) && (U_PLATFORM != U_PF_OS390)
-typedef size_t uintptr_t;
-#endif
-
-/**
- * \def U_HAVE_MSVC_2003_OR_EARLIER
- * Flag for workaround of MSVC 2003 optimization bugs
- * @internal
- */
-#if !defined(U_HAVE_MSVC_2003_OR_EARLIER) && defined(_MSC_VER) && (_MSC_VER < 1400)
-#define U_HAVE_MSVC_2003_OR_EARLIER
-#endif
-
-/*===========================================================================*/
-/** @{ Information about POSIX support                                       */
-/*===========================================================================*/
-
-#ifdef U_HAVE_NL_LANGINFO_CODESET
-    /* Use the predefined value. */
-#elif U_PLATFORM_HAS_WIN32_API || U_PLATFORM == U_PF_ANDROID || U_PLATFORM == U_PF_QNX
-#   define U_HAVE_NL_LANGINFO_CODESET 0
-#else
-#   define U_HAVE_NL_LANGINFO_CODESET 1
-#endif
-
-#ifdef U_NL_LANGINFO_CODESET
-    /* Use the predefined value. */
-#elif !U_HAVE_NL_LANGINFO_CODESET
-#   define U_NL_LANGINFO_CODESET -1
-#elif U_PLATFORM == U_PF_OS400
-   /* not defined */
-#else
-#   define U_NL_LANGINFO_CODESET CODESET
-#endif
-
-#ifdef U_TZSET
-    /* Use the predefined value. */
-#elif U_PLATFORM_USES_ONLY_WIN32_API
-#   define U_TZSET _tzset
-#elif U_PLATFORM == U_PF_OS400
-   /* not defined */
-#else
-#   define U_TZSET tzset
-#endif
-
-#if defined(U_TIMEZONE) || defined(U_HAVE_TIMEZONE)
-    /* Use the predefined value. */
-#elif U_PLATFORM == U_PF_ANDROID
-#   define U_TIMEZONE timezone
-#elif U_PLATFORM_IS_LINUX_BASED
-#   if defined(__UCLIBC__)
-       /* uClibc does not have __timezone or _timezone. */
-#   elif defined(_NEWLIB_VERSION)
-#      define U_TIMEZONE      _timezone
-#   elif defined(__GLIBC__)
-       /* glibc */
-#      define U_TIMEZONE      __timezone
-#   endif
-#elif U_PLATFORM_USES_ONLY_WIN32_API
-#   define U_TIMEZONE _timezone
-#elif U_PLATFORM == U_PF_BSD && !defined(__NetBSD__)
-   /* not defined */
-#elif U_PLATFORM == U_PF_OS400
-   /* not defined */
-#elif U_PLATFORM == U_PF_IPHONE
-   /* not defined */
-#else
-#   define U_TIMEZONE timezone
-#endif
-
-#ifdef U_TZNAME
-    /* Use the predefined value. */
-#elif U_PLATFORM_USES_ONLY_WIN32_API
-#   define U_TZNAME _tzname
-#elif U_PLATFORM == U_PF_OS400
-   /* not defined */
-#else
-#   define U_TZNAME tzname
-#endif
-
-#ifdef U_HAVE_MMAP
-    /* Use the predefined value. */
-#elif U_PLATFORM_HAS_WIN32_API
-#   define U_HAVE_MMAP 0
-#else
-#   define U_HAVE_MMAP 1
-#endif
-
-#ifdef U_HAVE_POPEN
-    /* Use the predefined value. */
-#elif U_PLATFORM_USES_ONLY_WIN32_API
-#   define U_HAVE_POPEN 0
-#elif U_PLATFORM == U_PF_OS400
-#   define U_HAVE_POPEN 0
-#else
-#   define U_HAVE_POPEN 1
-#endif
-
-/**
- * \def U_HAVE_DIRENT_H
- * Defines whether dirent.h is available.
- * @internal
- */
-#ifdef U_HAVE_DIRENT_H
-    /* Use the predefined value. */
-#elif U_PLATFORM_HAS_WIN32_API
-#   define U_HAVE_DIRENT_H 0
-#else
-#   define U_HAVE_DIRENT_H 1
-#endif
-
-/** @} */
-
-/*===========================================================================*/
-/** @{ GCC built in functions for atomic memory operations                   */
-/*===========================================================================*/
-
-/**
- * \def U_HAVE_GCC_ATOMICS
- * @internal
- */
-#ifdef U_HAVE_GCC_ATOMICS
-    /* Use the predefined value. */
-#elif U_PLATFORM == U_PF_MINGW
-    #define U_HAVE_GCC_ATOMICS 0
-#elif U_GCC_MAJOR_MINOR >= 404 || defined(__clang__)
-    /* TODO: Intel icc and IBM xlc on AIX also support gcc atomics.  (Intel originated them.)
-     *       Add them for these compilers.
-     * Note: Clang sets __GNUC__ defines for version 4.2, so misses the 4.4 test here.
-     */
-#   define U_HAVE_GCC_ATOMICS 1
-#else
-#   define U_HAVE_GCC_ATOMICS 0
-#endif
-
-/** @} */
-
-/**
- * \def U_HAVE_STD_ATOMICS
- * Defines whether the standard C++11 <atomic> is available.
- * ICU will use this when avialable,
- * otherwise will fall back to compiler or platform specific alternatives.
- * @internal
- */
-#ifdef U_HAVE_STD_ATOMICS
-    /* Use the predefined value. */
-#elif U_CPLUSPLUS_VERSION < 11
-    /* Not C++11, disable use of atomics */
-#   define U_HAVE_STD_ATOMICS 0
-#elif __clang__ && __clang_major__==3 && __clang_minor__<=1
-    /* Clang 3.1, has atomic variable initializer bug. */
-#   define U_HAVE_STD_ATOMICS 0
-#else 
-    /* U_HAVE_ATOMIC is typically set by an autoconf test of #include <atomic>  */
-    /*   Can be set manually, or left undefined, on platforms without autoconf. */
-#   if defined(U_HAVE_ATOMIC) &&  U_HAVE_ATOMIC 
-#      define U_HAVE_STD_ATOMICS 1
-#   else
-#      define U_HAVE_STD_ATOMICS 0
-#   endif
-#endif
-
-
-/**
- *  \def U_HAVE_CLANG_ATOMICS
- *  Defines whether Clang c11 style built-in atomics are avaialable.
- *  These are used in preference to gcc atomics when both are available.
- */
-#ifdef U_HAVE_CLANG_ATOMICS
-    /* Use the predefined value. */
-#elif __has_builtin(__c11_atomic_load) && \
-    __has_builtin(__c11_atomic_store) && \
-    __has_builtin(__c11_atomic_fetch_add) && \
-    __has_builtin(__c11_atomic_fetch_sub)
-#    define U_HAVE_CLANG_ATOMICS 1
-#else
-#    define U_HAVE_CLANG_ATOMICS 0
-#endif
-
-/*===========================================================================*/
-/** @{ Programs used by ICU code                                             */
-/*===========================================================================*/
-
-/**
- * \def U_MAKE_IS_NMAKE
- * Defines whether the "make" program is Windows nmake.
- */
-#ifdef U_MAKE_IS_NMAKE
-    /* Use the predefined value. */
-#elif U_PLATFORM == U_PF_WINDOWS
-#   define U_MAKE_IS_NMAKE 1
-#else
-#   define U_MAKE_IS_NMAKE 0
-#endif
-
-/** @} */
-
-/*==========================================================================*/
-/* Platform utilities                                                       */
-/*==========================================================================*/
-
-/**
- * Platform utilities isolates the platform dependencies of the
- * libarary.  For each platform which this code is ported to, these
- * functions may have to be re-implemented.
- */
-
-/**
- * Floating point utility to determine if a double is Not a Number (NaN).
- * @internal
- */
-U_INTERNAL UBool   U_EXPORT2 uprv_isNaN(double d);
-/**
- * Floating point utility to determine if a double has an infinite value.
- * @internal
- */
-U_INTERNAL UBool   U_EXPORT2 uprv_isInfinite(double d);
-/**
- * Floating point utility to determine if a double has a positive infinite value.
- * @internal
- */
-U_INTERNAL UBool   U_EXPORT2 uprv_isPositiveInfinity(double d);
-/**
- * Floating point utility to determine if a double has a negative infinite value.
- * @internal
- */
-U_INTERNAL UBool   U_EXPORT2 uprv_isNegativeInfinity(double d);
-/**
- * Floating point utility that returns a Not a Number (NaN) value.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_getNaN(void);
-/**
- * Floating point utility that returns an infinite value.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_getInfinity(void);
-
-/**
- * Floating point utility to truncate a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_trunc(double d);
-/**
- * Floating point utility to calculate the floor of a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_floor(double d);
-/**
- * Floating point utility to calculate the ceiling of a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_ceil(double d);
-/**
- * Floating point utility to calculate the absolute value of a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_fabs(double d);
-/**
- * Floating point utility to calculate the fractional and integer parts of a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_modf(double d, double* pinteger);
-/**
- * Floating point utility to calculate the remainder of a double divided by another double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_fmod(double d, double y);
-/**
- * Floating point utility to calculate d to the power of exponent (d^exponent).
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_pow(double d, double exponent);
-/**
- * Floating point utility to calculate 10 to the power of exponent (10^exponent).
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_pow10(int32_t exponent);
-/**
- * Floating point utility to calculate the maximum value of two doubles.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_fmax(double d, double y);
-/**
- * Floating point utility to calculate the minimum value of two doubles.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_fmin(double d, double y);
-/**
- * Private utility to calculate the maximum value of two integers.
- * @internal
- */
-U_INTERNAL int32_t U_EXPORT2 uprv_max(int32_t d, int32_t y);
-/**
- * Private utility to calculate the minimum value of two integers.
- * @internal
- */
-U_INTERNAL int32_t U_EXPORT2 uprv_min(int32_t d, int32_t y);
-
-#if U_IS_BIG_ENDIAN
-#   define uprv_isNegative(number) (*((signed char *)&(number))<0)
-#else
-#   define uprv_isNegative(number) (*((signed char *)&(number)+sizeof(number)-1)<0)
-#endif
-
-/**
- * Return the largest positive number that can be represented by an integer
- * type of arbitrary bit length.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_maxMantissa(void);
-
-/**
- * Floating point utility to calculate the logarithm of a double.
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_log(double d);
-
-/**
- * Does common notion of rounding e.g. uprv_floor(x + 0.5);
- * @param x the double number
- * @return the rounded double
- * @internal
- */
-U_INTERNAL double  U_EXPORT2 uprv_round(double x);
-
-#if 0
-/**
- * Returns the number of digits after the decimal point in a double number x.
- *
- * @param x the double number
- * @return the number of digits after the decimal point in a double number x.
- * @internal
- */
-/*U_INTERNAL int32_t  U_EXPORT2 uprv_digitsAfterDecimal(double x);*/
-#endif
-
-#if !U_CHARSET_IS_UTF8
-/**
- * Please use ucnv_getDefaultName() instead.
- * Return the default codepage for this platform and locale.
- * This function can call setlocale() on Unix platforms. Please read the
- * platform documentation on setlocale() before calling this function.
- * @return the default codepage for this platform 
- * @internal
- */
-U_INTERNAL const char*  U_EXPORT2 uprv_getDefaultCodepage(void);
-#endif
-
-/**
- * Please use uloc_getDefault() instead.
- * Return the default locale ID string by querying ths system, or
- *     zero if one cannot be found. 
- * This function can call setlocale() on Unix platforms. Please read the
- * platform documentation on setlocale() before calling this function.
- * @return the default locale ID string
- * @internal
- */
-U_INTERNAL const char*  U_EXPORT2 uprv_getDefaultLocaleID(void);
-
-/**
- * Time zone utilities
- *
- * Wrappers for C runtime library functions relating to timezones.
- * The t_tzset() function (similar to tzset) uses the current setting
- * of the environment variable TZ to assign values to three global
- * variables: daylight, timezone, and tzname. These variables have the
- * following meanings, and are declared in &lt;time.h&gt;.
- *
- *   daylight   Nonzero if daylight-saving-time zone (DST) is specified
- *              in TZ; otherwise, 0. Default value is 1.
- *   timezone   Difference in seconds between coordinated universal
- *              time and local time. E.g., -28,800 for PST (GMT-8hrs)
- *   tzname(0)  Three-letter time-zone name derived from TZ environment
- *              variable. E.g., "PST".
- *   tzname(1)  Three-letter DST zone name derived from TZ environment
- *              variable.  E.g., "PDT". If DST zone is omitted from TZ,
- *              tzname(1) is an empty string.
- *
- * Notes: For example, to set the TZ environment variable to correspond
- * to the current time zone in Germany, you can use one of the
- * following statements:
- *
- *   set TZ=GST1GDT
- *   set TZ=GST+1GDT
- *
- * If the TZ value is not set, t_tzset() attempts to use the time zone
- * information specified by the operating system. Under Windows NT
- * and Windows 95, this information is specified in the Control Panel's
- * Date/Time application.
- * @internal
- */
-U_INTERNAL void     U_EXPORT2 uprv_tzset(void);
-
-/**
- * Difference in seconds between coordinated universal
- * time and local time. E.g., -28,800 for PST (GMT-8hrs)
- * @return the difference in seconds between coordinated universal time and local time.
- * @internal
- */
-U_INTERNAL int32_t  U_EXPORT2 uprv_timezone(void);
-
-/**
- *   tzname(0)  Three-letter time-zone name derived from TZ environment
- *              variable. E.g., "PST".
- *   tzname(1)  Three-letter DST zone name derived from TZ environment
- *              variable.  E.g., "PDT". If DST zone is omitted from TZ,
- *              tzname(1) is an empty string.
- * @internal
- */
-U_INTERNAL const char* U_EXPORT2 uprv_tzname(int n);
-
-/**
- * Get UTC (GMT) time measured in milliseconds since 0:00 on 1/1/1970.
- * This function is affected by 'faketime' and should be the bottleneck for all user-visible ICU time functions.
- * @return the UTC time measured in milliseconds
- * @internal
- */
-U_INTERNAL UDate U_EXPORT2 uprv_getUTCtime(void);
-
-/**
- * Get UTC (GMT) time measured in milliseconds since 0:00 on 1/1/1970.
- * This function is not affected by 'faketime', so it should only be used by low level test functions- not by anything that
- * exposes time to the end user.
- * @return the UTC time measured in milliseconds
- * @internal
- */
-U_INTERNAL UDate U_EXPORT2 uprv_getRawUTCtime(void);
-
-/**
- * Determine whether a pathname is absolute or not, as defined by the platform.
- * @param path Pathname to test
- * @return TRUE if the path is absolute
- * @internal (ICU 3.0)
- */
-U_INTERNAL UBool U_EXPORT2 uprv_pathIsAbsolute(const char *path);
-
-/**
- * Use U_MAX_PTR instead of this function.
- * @param void pointer to test
- * @return the largest possible pointer greater than the base
- * @internal (ICU 3.8)
- */
-U_INTERNAL void * U_EXPORT2 uprv_maximumPtr(void *base);
-
-/**
- * Maximum value of a (void*) - use to indicate the limit of an 'infinite' buffer.
- * In fact, buffer sizes must not exceed 2GB so that the difference between
- * the buffer limit and the buffer start can be expressed in an int32_t.
- *
- * The definition of U_MAX_PTR must fulfill the following conditions:
- * - return the largest possible pointer greater than base
- * - return a valid pointer according to the machine architecture (AS/400, 64-bit, etc.)
- * - avoid wrapping around at high addresses
- * - make sure that the returned pointer is not farther from base than 0x7fffffff bytes
- *
- * @param base The beginning of a buffer to find the maximum offset from
- * @internal
- */
-#ifndef U_MAX_PTR
-#  if U_PLATFORM == U_PF_OS390 && !defined(_LP64)
-    /* We have 31-bit pointers. */
-#    define U_MAX_PTR(base) ((void *)0x7fffffff)
-#  elif U_PLATFORM == U_PF_OS400
-#    define U_MAX_PTR(base) uprv_maximumPtr((void *)base)
-#  elif 0
-    /*
-     * For platforms where pointers are scalar values (which is normal, but unlike i5/OS)
-     * but that do not define uintptr_t.
-     *
-     * However, this does not work on modern compilers:
-     * The C++ standard does not define pointer overflow, and allows compilers to
-     * assume that p+u>p for any pointer p and any integer u>0.
-     * Thus, modern compilers optimize away the ">" comparison.
-     * (See ICU tickets #7187 and #8096.)
-     */
-#    define U_MAX_PTR(base) \
-    ((void *)(((char *)(base)+0x7fffffffu) > (char *)(base) \
-        ? ((char *)(base)+0x7fffffffu) \
-        : (char *)-1))
-#  else
-    /* Default version. C++ standard compliant for scalar pointers. */
-#    define U_MAX_PTR(base) \
-    ((void *)(((uintptr_t)(base)+0x7fffffffu) > (uintptr_t)(base) \
-        ? ((uintptr_t)(base)+0x7fffffffu) \
-        : (uintptr_t)-1))
-#  endif
-#endif
-
-/*  Dynamic Library Functions */
-
-typedef void (UVoidFunction)(void);
-
-#if U_ENABLE_DYLOAD
-/**
- * Load a library
- * @internal (ICU 4.4)
- */
-U_INTERNAL void * U_EXPORT2 uprv_dl_open(const char *libName, UErrorCode *status);
-
-/**
- * Close a library
- * @internal (ICU 4.4)
- */
-U_INTERNAL void U_EXPORT2 uprv_dl_close( void *lib, UErrorCode *status);
-
-/**
- * Extract a symbol from a library (function)
- * @internal (ICU 4.8)
- */
-U_INTERNAL UVoidFunction* U_EXPORT2 uprv_dlsym_func( void *lib, const char *symbolName, UErrorCode *status);
-
-/**
- * Extract a symbol from a library (function)
- * Not implemented, no clients.
- * @internal
- */
-/* U_INTERNAL void * U_EXPORT2 uprv_dlsym_data( void *lib, const char *symbolName, UErrorCode *status); */
-
-#endif
-
-/**
- * Define malloc and related functions
- * @internal
- */
-#if U_PLATFORM == U_PF_OS400
-# define uprv_default_malloc(x) _C_TS_malloc(x)
-# define uprv_default_realloc(x,y) _C_TS_realloc(x,y)
-# define uprv_default_free(x) _C_TS_free(x)
-/* also _C_TS_calloc(x) */
-#else
-/* C defaults */
-# define uprv_default_malloc(x) malloc(x)
-# define uprv_default_realloc(x,y) realloc(x,y)
-# define uprv_default_free(x) free(x)
-#endif
-
-
-#endif
diff --git a/intl/icu/source/configure.orig b/intl/icu/source/configure.orig
deleted file mode 100755
--- a/intl/icu/source/configure.orig
+++ /dev/null
@@ -1,9110 +0,0 @@
-#! /bin/sh
-# Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for ICU 56.1.
-#
-# Report bugs to <http://icu-project.org/bugs>.
-#
-#  Copyright (c) 1999-2015, International Business Machines Corporation and others. All Rights Reserved.
-#
-#
-# Copyright (C) 1992-1996, 1998-2012 Free Software Foundation, Inc.
-#
-#
-# This configure script is free software; the Free Software Foundation
-# gives unlimited permission to copy, distribute and modify it.
-## -------------------- ##
-## M4sh Initialization. ##
-## -------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then :
-  emulate sh
-  NULLCMD=:
-  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in #(
-  *posix*) :
-    set -o posix ;; #(
-  *) :
-     ;;
-esac
-fi
-
-
-as_nl='
-'
-export as_nl
-# Printing a long string crashes Solaris 7 /usr/bin/printf.
-as_echo='\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\'
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo$as_echo
-# Prefer a ksh shell builtin over an external printf program on Solaris,
-# but without wasting forks for bash or zsh.
-if test -z "$BASH_VERSION$ZSH_VERSION" \
-    && (test "X`print -r -- $as_echo`" = "X$as_echo") 2>/dev/null; then
-  as_echo='print -r --'
-  as_echo_n='print -rn --'
-elif (test "X`printf %s $as_echo`" = "X$as_echo") 2>/dev/null; then
-  as_echo='printf %s\n'
-  as_echo_n='printf %s'
-else
-  if test "X`(/usr/ucb/echo -n -n $as_echo) 2>/dev/null`" = "X-n $as_echo"; then
-    as_echo_body='eval /usr/ucb/echo -n "$1$as_nl"'
-    as_echo_n='/usr/ucb/echo -n'
-  else
-    as_echo_body='eval expr "X$1" : "X\\(.*\\)"'
-    as_echo_n_body='eval
-      arg=$1;
-      case $arg in #(
-      *"$as_nl"*)
-	expr "X$arg" : "X\\(.*\\)$as_nl";
-	arg=`expr "X$arg" : ".*$as_nl\\(.*\\)"`;;
-      esac;
-      expr "X$arg" : "X\\(.*\\)" | tr -d "$as_nl"
-    '
-    export as_echo_n_body
-    as_echo_n='sh -c $as_echo_n_body as_echo'
-  fi
-  export as_echo_body
-  as_echo='sh -c $as_echo_body as_echo'
-fi
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  PATH_SEPARATOR=:
-  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
-    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
-      PATH_SEPARATOR=';'
-  }
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-as_myself=
-case $0 in #((
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-  done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  $as_echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  exit 1
-fi
-
-# Unset variables that we do not need and which cause bugs (e.g. in
-# pre-3.0 UWIN ksh).  But do not cause bugs in bash 2.01; the "|| exit 1"
-# suppresses any "Segmentation fault" message there.  '((' could
-# trigger a bug in pdksh 5.2.14.
-for as_var in BASH_ENV ENV MAIL MAILPATH
-do eval test x\${$as_var+set} = xset \
-  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-LC_ALL=C
-export LC_ALL
-LANGUAGE=C
-export LANGUAGE
-
-# CDPATH.
-(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
-
-# Use a proper internal environment variable to ensure we don't fall
-  # into an infinite loop, continuously re-executing ourselves.
-  if test x"${_as_can_reexec}" != xno && test "x$CONFIG_SHELL" != x; then
-    _as_can_reexec=no; export _as_can_reexec;
-    # We cannot yet assume a decent shell, so we have to provide a
-# neutralization value for shells without unset; and this also
-# works around shells that cannot unset nonexistent variables.
-# Preserve -v and -x to the replacement shell.
-BASH_ENV=/dev/null
-ENV=/dev/null
-(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
-case $- in # ((((
-  *v*x* | *x*v* ) as_opts=-vx ;;
-  *v* ) as_opts=-v ;;
-  *x* ) as_opts=-x ;;
-  * ) as_opts= ;;
-esac
-exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
-# Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
-$as_echo "$0: could not re-execute with $CONFIG_SHELL" >&2
-as_fn_exit 255
-  fi
-  # We don't want this to propagate to other subprocesses.
-          { _as_can_reexec=; unset _as_can_reexec;}
-if test "x$CONFIG_SHELL" = x; then
-  as_bourne_compatible="if test -n \"\${ZSH_VERSION+set}\" && (emulate sh) >/dev/null 2>&1; then :
-  emulate sh
-  NULLCMD=:
-  # Pre-4.2 versions of Zsh do word splitting on \${1+\"\$@\"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '\${1+\"\$@\"}'='\"\$@\"'
-  setopt NO_GLOB_SUBST
-else
-  case \`(set -o) 2>/dev/null\` in #(
-  *posix*) :
-    set -o posix ;; #(
-  *) :
-     ;;
-esac
-fi
-"
-  as_required="as_fn_return () { (exit \$1); }
-as_fn_success () { as_fn_return 0; }
-as_fn_failure () { as_fn_return 1; }
-as_fn_ret_success () { return 0; }
-as_fn_ret_failure () { return 1; }
-
-exitcode=0
-as_fn_success || { exitcode=1; echo as_fn_success failed.; }
-as_fn_failure && { exitcode=1; echo as_fn_failure succeeded.; }
-as_fn_ret_success || { exitcode=1; echo as_fn_ret_success failed.; }
-as_fn_ret_failure && { exitcode=1; echo as_fn_ret_failure succeeded.; }
-if ( set x; as_fn_ret_success y && test x = \"\$1\" ); then :
-
-else
-  exitcode=1; echo positional parameters were not saved.
-fi
-test x\$exitcode = x0 || exit 1
-test -x / || exit 1"
-  as_suggested="  as_lineno_1=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_1a=\$LINENO
-  as_lineno_2=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_2a=\$LINENO
-  eval 'test \"x\$as_lineno_1'\$as_run'\" != \"x\$as_lineno_2'\$as_run'\" &&
-  test \"x\`expr \$as_lineno_1'\$as_run' + 1\`\" = \"x\$as_lineno_2'\$as_run'\"' || exit 1
-test \$(( 1 + 1 )) = 2 || exit 1"
-  if (eval "$as_required") 2>/dev/null; then :
-  as_have_required=yes
-else
-  as_have_required=no
-fi
-  if test x$as_have_required = xyes && (eval "$as_suggested") 2>/dev/null; then :
-
-else
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-as_found=false
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  as_found=:
-  case $as_dir in #(
-	 /*)
-	   for as_base in sh bash ksh sh5; do
-	     # Try only shells that exist, to save several forks.
-	     as_shell=$as_dir/$as_base
-	     if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
-		    { $as_echo "$as_bourne_compatible""$as_required" | as_run=a "$as_shell"; } 2>/dev/null; then :
-  CONFIG_SHELL=$as_shell as_have_required=yes
-		   if { $as_echo "$as_bourne_compatible""$as_suggested" | as_run=a "$as_shell"; } 2>/dev/null; then :
-  break 2
-fi
-fi
-	   done;;
-       esac
-  as_found=false
-done
-$as_found || { if { test -f "$SHELL" || test -f "$SHELL.exe"; } &&
-	      { $as_echo "$as_bourne_compatible""$as_required" | as_run=a "$SHELL"; } 2>/dev/null; then :
-  CONFIG_SHELL=$SHELL as_have_required=yes
-fi; }
-IFS=$as_save_IFS
-
-
-      if test "x$CONFIG_SHELL" != x; then :
-  export CONFIG_SHELL
-             # We cannot yet assume a decent shell, so we have to provide a
-# neutralization value for shells without unset; and this also
-# works around shells that cannot unset nonexistent variables.
-# Preserve -v and -x to the replacement shell.
-BASH_ENV=/dev/null
-ENV=/dev/null
-(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
-case $- in # ((((
-  *v*x* | *x*v* ) as_opts=-vx ;;
-  *v* ) as_opts=-v ;;
-  *x* ) as_opts=-x ;;
-  * ) as_opts= ;;
-esac
-exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
-# Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
-$as_echo "$0: could not re-execute with $CONFIG_SHELL" >&2
-exit 255
-fi
-
-    if test x$as_have_required = xno; then :
-  $as_echo "$0: This script requires a shell more modern than all"
-  $as_echo "$0: the shells that I found on your system."
-  if test x${ZSH_VERSION+set} = xset ; then
-    $as_echo "$0: In particular, zsh $ZSH_VERSION has bugs and should"
-    $as_echo "$0: be upgraded to zsh 4.3.4 or later."
-  else
-    $as_echo "$0: Please tell bug-autoconf@gnu.org and
-$0: http://icu-project.org/bugs about your system,
-$0: including any error possibly output before this
-$0: message. Then install a modern shell, or manually run
-$0: the script under such a shell if you do have one."
-  fi
-  exit 1
-fi
-fi
-fi
-SHELL=${CONFIG_SHELL-/bin/sh}
-export SHELL
-# Unset more variables known to interfere with behavior of common tools.
-CLICOLOR_FORCE= GREP_OPTIONS=
-unset CLICOLOR_FORCE GREP_OPTIONS
-
-## --------------------- ##
-## M4sh Shell Functions. ##
-## --------------------- ##
-# as_fn_unset VAR
-# ---------------
-# Portably unset VAR.
-as_fn_unset ()
-{
-  { eval $1=; unset $1;}
-}
-as_unset=as_fn_unset
-
-# as_fn_set_status STATUS
-# -----------------------
-# Set $? to STATUS, without forking.
-as_fn_set_status ()
-{
-  return $1
-} # as_fn_set_status
-
-# as_fn_exit STATUS
-# -----------------
-# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
-as_fn_exit ()
-{
-  set +e
-  as_fn_set_status $1
-  exit $1
-} # as_fn_exit
-
-# as_fn_mkdir_p
-# -------------
-# Create "$as_dir" as a directory, including parents if necessary.
-as_fn_mkdir_p ()
-{
-
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || eval $as_mkdir_p || {
-    as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`$as_echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-      test -d "$as_dir" && break
-    done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
-
-
-} # as_fn_mkdir_p
-
-# as_fn_executable_p FILE
-# -----------------------
-# Test if FILE is an executable regular file.
-as_fn_executable_p ()
-{
-  test -f "$1" && test -x "$1"
-} # as_fn_executable_p
-# as_fn_append VAR VALUE
-# ----------------------
-# Append the text in VALUE to the end of the definition contained in VAR. Take
-# advantage of any shell optimizations that allow amortized linear growth over
-# repeated appends, instead of the typical quadratic growth present in naive
-# implementations.
-if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null; then :
-  eval 'as_fn_append ()
-  {
-    eval $1+=\$2
-  }'
-else
-  as_fn_append ()
-  {
-    eval $1=\$$1\$2
-  }
-fi # as_fn_append
-
-# as_fn_arith ARG...
-# ------------------
-# Perform arithmetic evaluation on the ARGs, and store the result in the
-# global $as_val. Take advantage of shells that can avoid forks. The arguments
-# must be portable across $(()) and expr.
-if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null; then :
-  eval 'as_fn_arith ()
-  {
-    as_val=$(( $* ))
-  }'
-else
-  as_fn_arith ()
-  {
-    as_val=`expr "$@" || test $? -eq 1`
-  }
-fi # as_fn_arith
-
-
-# as_fn_error STATUS ERROR [LINENO LOG_FD]
-# ----------------------------------------
-# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
-# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
-# script with STATUS, using 1 if that was 0.
-as_fn_error ()
-{
-  as_status=$1; test $as_status -eq 0 && as_status=1
-  if test "$4"; then
-    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
-  fi
-  $as_echo "$as_me: error: $2" >&2
-  as_fn_exit $as_status
-} # as_fn_error
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-
-  as_lineno_1=$LINENO as_lineno_1a=$LINENO
-  as_lineno_2=$LINENO as_lineno_2a=$LINENO
-  eval 'test "x$as_lineno_1'$as_run'" != "x$as_lineno_2'$as_run'" &&
-  test "x`expr $as_lineno_1'$as_run' + 1`" = "x$as_lineno_2'$as_run'"' || {
-  # Blame Lee E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { $as_echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2; as_fn_exit 1; }
-
-  # If we had to re-execute with $CONFIG_SHELL, we're ensured to have
-  # already done that, so ensure we don't try to do so again and fall
-  # in an infinite loop.  This has already happened in practice.
-  _as_can_reexec=no; export _as_can_reexec
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in #(((((
--n*)
-  case `echo 'xy\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  xy)  ECHO_C='\c';;
-  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
-       ECHO_T='	';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir 2>/dev/null
-fi
-if (echo >conf$$.file) 2>/dev/null; then
-  if ln -s conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s='ln -s'
-    # ... but there are two gotchas:
-    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
-    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-      as_ln_s='cp -pR'
-  elif ln conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s=ln
-  else
-    as_ln_s='cp -pR'
-  fi
-else
-  as_ln_s='cp -pR'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p='mkdir -p "$as_dir"'
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-as_test_x='test -x'
-as_executable_p=as_fn_executable_p
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-test -n "$DJDIR" || exec 7<&0 </dev/null
-exec 6>&1
-
-# Name of the host.
-# hostname on some systems (SVR3.2, old GNU/Linux) returns a bogus exit status,
-# so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
-
-#
-# Initializations.
-#
-ac_default_prefix=/usr/local
-ac_clean_files=
-ac_config_libobj_dir=.
-LIBOBJS=
-cross_compiling=no
-subdirs=
-MFLAGS=
-MAKEFLAGS=
-
-# Identity of this package.
-PACKAGE_NAME='ICU'
-PACKAGE_TARNAME='International Components for Unicode'
-PACKAGE_VERSION='56.1'
-PACKAGE_STRING='ICU 56.1'
-PACKAGE_BUGREPORT='http://icu-project.org/bugs'
-PACKAGE_URL='http://icu-project.org'
-
-ac_unique_file="common/unicode/utypes.h"
-# Factoring default headers for most tests.
-ac_includes_default="\
-#include <stdio.h>
-#ifdef HAVE_SYS_TYPES_H
-# include <sys/types.h>
-#endif
-#ifdef HAVE_SYS_STAT_H
-# include <sys/stat.h>
-#endif
-#ifdef STDC_HEADERS
-# include <stdlib.h>
-# include <stddef.h>
-#else
-# ifdef HAVE_STDLIB_H
-#  include <stdlib.h>
-# endif
-#endif
-#ifdef HAVE_STRING_H
-# if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-#  include <memory.h>
-# endif
-# include <string.h>
-#endif
-#ifdef HAVE_STRINGS_H
-# include <strings.h>
-#endif
-#ifdef HAVE_INTTYPES_H
-# include <inttypes.h>
-#endif
-#ifdef HAVE_STDINT_H
-# include <stdint.h>
-#endif
-#ifdef HAVE_UNISTD_H
-# include <unistd.h>
-#endif"
-
-ac_subst_vars='UCONFIG_CXXFLAGS
-UCONFIG_CFLAGS
-UCONFIG_CPPFLAGS
-LTLIBOBJS
-LIBOBJS
-LIBCXXFLAGS
-LIBCFLAGS
-platform_make_fragment
-platform_make_fragment_name
-platform
-ICUDATA_CHAR
-U_HAVE_SAMPLES
-SAMPLES_TRUE
-U_HAVE_TESTS
-TESTS_TRUE
-ICULIBSUFFIXCNAME
-U_HAVE_LIB_SUFFIX
-ICULIBSUFFIX
-DATA_PACKAGING_MODE
-thepkgicudatadir
-pkgicudatadir
-U_HAVE_TOOLS
-TOOLS_TRUE
-U_HAVE_LAYOUTEX
-LAYOUTEX_TRUE
-U_HAVE_LAYOUT
-LAYOUT_TRUE
-U_HAVE_ICUIO
-ICUIO_TRUE
-U_HAVE_EXTRAS
-EXTRAS_TRUE
-U_HAVE_WCSCPY
-U_HAVE_WCHAR_H
-U_TIMEZONE
-U_HAVE_TIMEZONE
-U_TZNAME
-U_HAVE_TZNAME
-U_TZSET
-U_HAVE_TZSET
-U_HAVE_POPEN
-U_HAVE_PLACEMENT_NEW
-U_OVERRIDE_CXX_ALLOCATION
-U_NL_LANGINFO_CODESET
-U_HAVE_NL_LANGINFO_CODESET
-U_IS_BIG_ENDIAN
-U_HAVE_DIRENT_H
-U_HAVE_INTTYPES_H
-GENCCODE_ASSEMBLY
-HAVE_MMAP
-LIB_THREAD
-U_HAVE_ATOMIC
-U_HAVE_STD_STRING
-ENABLE_RPATH
-U_ENABLE_DYLOAD
-U_HAVE_PLUGINS
-PLUGINS_TRUE
-U_ENABLE_TRACING
-U_DISABLE_RENAMING
-AR
-RANLIB
-U_DEFAULT_SHOW_DRAFT
-UCLN_NO_AUTO_CLEANUP
-ENABLE_STATIC
-ENABLE_SHARED
-LIB_M
-COMPILE_LINK_ENVVAR
-ARFLAGS
-EGREP
-GREP
-DOXYGEN
-cross_buildroot
-U_MAKE
-cross_compiling
-INSTALL_DATA
-INSTALL_SCRIPT
-INSTALL_PROGRAM
-CPP
-ICULEHB_LIBS
-ICULEHB_CFLAGS
-PKG_CONFIG_LIBDIR
-PKG_CONFIG_PATH
-PKG_CONFIG
-ac_ct_CXX
-CXXFLAGS
-CXX
-OBJEXT
-EXEEXT
-ac_ct_CC
-LDFLAGS
-CFLAGS
-CC
-ENABLE_RELEASE
-ENABLE_DEBUG
-CPPFLAGS
-host_os
-host_vendor
-host_cpu
-host
-build_os
-build_vendor
-build_cpu
-build
-UNICODE_VERSION
-LIB_VERSION_MAJOR
-LIB_VERSION
-VERSION
-ICU_ECHO_T
-ICU_ECHO_C
-ICU_ECHO_N
-PACKAGE
-target_alias
-host_alias
-build_alias
-LIBS
-ECHO_T
-ECHO_N
-ECHO_C
-DEFS
-mandir
-localedir
-libdir
-psdir
-pdfdir
-dvidir
-htmldir
-infodir
-docdir
-oldincludedir
-includedir
-localstatedir
-sharedstatedir
-sysconfdir
-datadir
-datarootdir
-libexecdir
-sbindir
-bindir
-program_transform_name
-prefix
-exec_prefix
-PACKAGE_URL
-PACKAGE_BUGREPORT
-PACKAGE_STRING
-PACKAGE_VERSION
-PACKAGE_TARNAME
-PACKAGE_NAME
-PATH_SEPARATOR
-SHELL'
-ac_subst_files=''
-ac_user_opts='
-enable_option_checking
-enable_debug
-enable_release
-with_cross_build
-enable_strict
-enable_64bit_libs
-with_library_bits
-enable_shared
-enable_static
-enable_auto_cleanup
-enable_draft
-enable_renaming
-enable_tracing
-enable_plugins
-enable_dyload
-enable_rpath
-enable_weak_threads
-enable_extras
-enable_icuio
-enable_layout
-enable_layoutex
-enable_tools
-with_data_packaging
-with_library_suffix
-enable_tests
-enable_samples
-'
-      ac_precious_vars='build_alias
-host_alias
-target_alias
-CC
-CFLAGS
-LDFLAGS
-LIBS
-CPPFLAGS
-CXX
-CXXFLAGS
-CCC
-PKG_CONFIG
-PKG_CONFIG_PATH
-PKG_CONFIG_LIBDIR
-ICULEHB_CFLAGS
-ICULEHB_LIBS
-CPP'
-
-
-# Initialize some variables set by options.
-ac_init_help=
-ac_init_version=false
-ac_unrecognized_opts=
-ac_unrecognized_sep=
-# The variables have the same names as the options, with
-# dashes changed to underlines.
-cache_file=/dev/null
-exec_prefix=NONE
-no_create=
-no_recursion=
-prefix=NONE
-program_prefix=NONE
-program_suffix=NONE
-program_transform_name=s,x,x,
-silent=
-site=
-srcdir=
-verbose=
-x_includes=NONE
-x_libraries=NONE
-
-# Installation directory options.
-# These are left unexpanded so users can "make install exec_prefix=/foo"
-# and all the variables that are supposed to be based on exec_prefix
-# by default will actually change.
-# Use braces instead of parens because sh, perl, etc. also accept them.
-# (The list follows the same order as the GNU Coding Standards.)
-bindir='${exec_prefix}/bin'
-sbindir='${exec_prefix}/sbin'
-libexecdir='${exec_prefix}/libexec'
-datarootdir='${prefix}/share'
-datadir='${datarootdir}'
-sysconfdir='${prefix}/etc'
-sharedstatedir='${prefix}/com'
-localstatedir='${prefix}/var'
-includedir='${prefix}/include'
-oldincludedir='/usr/include'
-docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
-infodir='${datarootdir}/info'
-htmldir='${docdir}'
-dvidir='${docdir}'
-pdfdir='${docdir}'
-psdir='${docdir}'
-libdir='${exec_prefix}/lib'
-localedir='${datarootdir}/locale'
-mandir='${datarootdir}/man'
-
-ac_prev=
-ac_dashdash=
-for ac_option
-do
-  # If the previous option needs an argument, assign it.
-  if test -n "$ac_prev"; then
-    eval $ac_prev=\$ac_option
-    ac_prev=
-    continue
-  fi
-
-  case $ac_option in
-  *=?*) ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
-  *=)   ac_optarg= ;;
-  *)    ac_optarg=yes ;;
-  esac
-
-  # Accept the important Cygnus configure options, so we can diagnose typos.
-
-  case $ac_dashdash$ac_option in
-  --)
-    ac_dashdash=yes ;;
-
-  -bindir | --bindir | --bindi | --bind | --bin | --bi)
-    ac_prev=bindir ;;
-  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
-    bindir=$ac_optarg ;;
-
-  -build | --build | --buil | --bui | --bu)
-    ac_prev=build_alias ;;
-  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
-    build_alias=$ac_optarg ;;
-
-  -cache-file | --cache-file | --cache-fil | --cache-fi \
-  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
-    ac_prev=cache_file ;;
-  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
-  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
-    cache_file=$ac_optarg ;;
-
-  --config-cache | -C)
-    cache_file=config.cache ;;
-
-  -datadir | --datadir | --datadi | --datad)
-    ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=*)
-    datadir=$ac_optarg ;;
-
-  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
-  | --dataroo | --dataro | --datar)
-    ac_prev=datarootdir ;;
-  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
-  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
-    datarootdir=$ac_optarg ;;
-
-  -disable-* | --disable-*)
-    ac_useropt=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid feature name: $ac_useropt"
-    ac_useropt_orig=$ac_useropt
-    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
-    case $ac_user_opts in
-      *"
-"enable_$ac_useropt"
-"*) ;;
-      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--disable-$ac_useropt_orig"
-	 ac_unrecognized_sep=', ';;
-    esac
-    eval enable_$ac_useropt=no ;;
-
-  -docdir | --docdir | --docdi | --doc | --do)
-    ac_prev=docdir ;;
-  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
-    docdir=$ac_optarg ;;
-
-  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
-    ac_prev=dvidir ;;
-  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
-    dvidir=$ac_optarg ;;
-
-  -enable-* | --enable-*)
-    ac_useropt=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid feature name: $ac_useropt"
-    ac_useropt_orig=$ac_useropt
-    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
-    case $ac_user_opts in
-      *"
-"enable_$ac_useropt"
-"*) ;;
-      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--enable-$ac_useropt_orig"
-	 ac_unrecognized_sep=', ';;
-    esac
-    eval enable_$ac_useropt=\$ac_optarg ;;
-
-  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
-  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
-  | --exec | --exe | --ex)
-    ac_prev=exec_prefix ;;
-  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
-  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
-  | --exec=* | --exe=* | --ex=*)
-    exec_prefix=$ac_optarg ;;
-
-  -gas | --gas | --ga | --g)
-    # Obsolete; use --with-gas.
-    with_gas=yes ;;
-
-  -help | --help | --hel | --he | -h)
-    ac_init_help=long ;;
-  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
-    ac_init_help=recursive ;;
-  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
-    ac_init_help=short ;;
-
-  -host | --host | --hos | --ho)
-    ac_prev=host_alias ;;
-  -host=* | --host=* | --hos=* | --ho=*)
-    host_alias=$ac_optarg ;;
-
-  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
-    ac_prev=htmldir ;;
-  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
-  | --ht=*)
-    htmldir=$ac_optarg ;;
-
-  -includedir | --includedir | --includedi | --included | --include \
-  | --includ | --inclu | --incl | --inc)
-    ac_prev=includedir ;;
-  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
-  | --includ=* | --inclu=* | --incl=* | --inc=*)
-    includedir=$ac_optarg ;;
-
-  -infodir | --infodir | --infodi | --infod | --info | --inf)
-    ac_prev=infodir ;;
-  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
-    infodir=$ac_optarg ;;
-
-  -libdir | --libdir | --libdi | --libd)
-    ac_prev=libdir ;;
-  -libdir=* | --libdir=* | --libdi=* | --libd=*)
-    libdir=$ac_optarg ;;
-
-  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
-  | --libexe | --libex | --libe)
-    ac_prev=libexecdir ;;
-  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
-  | --libexe=* | --libex=* | --libe=*)
-    libexecdir=$ac_optarg ;;
-
-  -localedir | --localedir | --localedi | --localed | --locale)
-    ac_prev=localedir ;;
-  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
-    localedir=$ac_optarg ;;
-
-  -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst | --locals)
-    ac_prev=localstatedir ;;
-  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
-    localstatedir=$ac_optarg ;;
-
-  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
-    ac_prev=mandir ;;
-  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
-    mandir=$ac_optarg ;;
-
-  -nfp | --nfp | --nf)
-    # Obsolete; use --without-fp.
-    with_fp=no ;;
-
-  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
-  | --no-cr | --no-c | -n)
-    no_create=yes ;;
-
-  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
-  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
-    no_recursion=yes ;;
-
-  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
-  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
-  | --oldin | --oldi | --old | --ol | --o)
-    ac_prev=oldincludedir ;;
-  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
-  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
-  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
-    oldincludedir=$ac_optarg ;;
-
-  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
-    ac_prev=prefix ;;
-  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
-    prefix=$ac_optarg ;;
-
-  -program-prefix | --program-prefix | --program-prefi | --program-pref \
-  | --program-pre | --program-pr | --program-p)
-    ac_prev=program_prefix ;;
-  -program-prefix=* | --program-prefix=* | --program-prefi=* \
-  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
-    program_prefix=$ac_optarg ;;
-
-  -program-suffix | --program-suffix | --program-suffi | --program-suff \
-  | --program-suf | --program-su | --program-s)
-    ac_prev=program_suffix ;;
-  -program-suffix=* | --program-suffix=* | --program-suffi=* \
-  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
-    program_suffix=$ac_optarg ;;
-
-  -program-transform-name | --program-transform-name \
-  | --program-transform-nam | --program-transform-na \
-  | --program-transform-n | --program-transform- \
-  | --program-transform | --program-transfor \
-  | --program-transfo | --program-transf \
-  | --program-trans | --program-tran \
-  | --progr-tra | --program-tr | --program-t)
-    ac_prev=program_transform_name ;;
-  -program-transform-name=* | --program-transform-name=* \
-  | --program-transform-nam=* | --program-transform-na=* \
-  | --program-transform-n=* | --program-transform-=* \
-  | --program-transform=* | --program-transfor=* \
-  | --program-transfo=* | --program-transf=* \
-  | --program-trans=* | --program-tran=* \
-  | --progr-tra=* | --program-tr=* | --program-t=*)
-    program_transform_name=$ac_optarg ;;
-
-  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
-    ac_prev=pdfdir ;;
-  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
-    pdfdir=$ac_optarg ;;
-
-  -psdir | --psdir | --psdi | --psd | --ps)
-    ac_prev=psdir ;;
-  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
-    psdir=$ac_optarg ;;
-
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil)
-    silent=yes ;;
-
-  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
-    ac_prev=sbindir ;;
-  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
-  | --sbi=* | --sb=*)
-    sbindir=$ac_optarg ;;
-
-  -sharedstatedir | --sharedstatedir | --sharedstatedi \
-  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
-  | --sharedst | --shareds | --shared | --share | --shar \
-  | --sha | --sh)
-    ac_prev=sharedstatedir ;;
-  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
-  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
-  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
-  | --sha=* | --sh=*)
-    sharedstatedir=$ac_optarg ;;
-
-  -site | --site | --sit)
-    ac_prev=site ;;
-  -site=* | --site=* | --sit=*)
-    site=$ac_optarg ;;
-
-  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
-    ac_prev=srcdir ;;
-  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
-    srcdir=$ac_optarg ;;
-
-  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
-  | --syscon | --sysco | --sysc | --sys | --sy)
-    ac_prev=sysconfdir ;;
-  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
-  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
-    sysconfdir=$ac_optarg ;;
-
-  -target | --target | --targe | --targ | --tar | --ta | --t)
-    ac_prev=target_alias ;;
-  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
-    target_alias=$ac_optarg ;;
-
-  -v | -verbose | --verbose | --verbos | --verbo | --verb)
-    verbose=yes ;;
-
-  -version | --version | --versio | --versi | --vers | -V)
-    ac_init_version=: ;;
-
-  -with-* | --with-*)
-    ac_useropt=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid package name: $ac_useropt"
-    ac_useropt_orig=$ac_useropt
-    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
-    case $ac_user_opts in
-      *"
-"with_$ac_useropt"
-"*) ;;
-      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--with-$ac_useropt_orig"
-	 ac_unrecognized_sep=', ';;
-    esac
-    eval with_$ac_useropt=\$ac_optarg ;;
-
-  -without-* | --without-*)
-    ac_useropt=`expr "x$ac_option" : 'x-*without-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid package name: $ac_useropt"
-    ac_useropt_orig=$ac_useropt
-    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
-    case $ac_user_opts in
-      *"
-"with_$ac_useropt"
-"*) ;;
-      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--without-$ac_useropt_orig"
-	 ac_unrecognized_sep=', ';;
-    esac
-    eval with_$ac_useropt=no ;;
-
-  --x)
-    # Obsolete; use --with-x.
-    with_x=yes ;;
-
-  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
-  | --x-incl | --x-inc | --x-in | --x-i)
-    ac_prev=x_includes ;;
-  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
-  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
-    x_includes=$ac_optarg ;;
-
-  -x-libraries | --x-libraries | --x-librarie | --x-librari \
-  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
-    ac_prev=x_libraries ;;
-  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
-  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
-    x_libraries=$ac_optarg ;;
-
-  -*) as_fn_error $? "unrecognized option: \`$ac_option'
-Try \`$0 --help' for more information"
-    ;;
-
-  *=*)
-    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
-    # Reject names that are not valid shell variable names.
-    case $ac_envvar in #(
-      '' | [0-9]* | *[!_$as_cr_alnum]* )
-      as_fn_error $? "invalid variable name: \`$ac_envvar'" ;;
-    esac
-    eval $ac_envvar=\$ac_optarg
-    export $ac_envvar ;;
-
-  *)
-    # FIXME: should be removed in autoconf 3.0.
-    $as_echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      $as_echo "$as_me: WARNING: invalid host type: $ac_option" >&2
-    : "${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}"
-    ;;
-
-  esac
-done
-
-if test -n "$ac_prev"; then
-  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  as_fn_error $? "missing argument to $ac_option"
-fi
-
-if test -n "$ac_unrecognized_opts"; then
-  case $enable_option_checking in
-    no) ;;
-    fatal) as_fn_error $? "unrecognized options: $ac_unrecognized_opts" ;;
-    *)     $as_echo "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2 ;;
-  esac
-fi
-
-# Check all directory arguments for consistency.
-for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
-		datadir sysconfdir sharedstatedir localstatedir includedir \
-		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
-		libdir localedir mandir
-do
-  eval ac_val=\$$ac_var
-  # Remove trailing slashes.
-  case $ac_val in
-    */ )
-      ac_val=`expr "X$ac_val" : 'X\(.*[^/]\)' \| "X$ac_val" : 'X\(.*\)'`
-      eval $ac_var=\$ac_val;;
-  esac
-  # Be sure to have absolute directory names.
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* )  continue;;
-    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
-  esac
-  as_fn_error $? "expected an absolute directory name for --$ac_var: $ac_val"
-done
-
-# There might be people who depend on the old broken behavior: `$host'
-# used to hold the argument of --host etc.
-# FIXME: To remove some day.
-build=$build_alias
-host=$host_alias
-target=$target_alias
-
-# FIXME: To remove some day.
-if test "x$host_alias" != x; then
-  if test "x$build_alias" = x; then
-    cross_compiling=maybe
-  elif test "x$build_alias" != "x$host_alias"; then
-    cross_compiling=yes
-  fi
-fi
-
-ac_tool_prefix=
-test -n "$host_alias" && ac_tool_prefix=$host_alias-
-
-test "$silent" = yes && exec 6>/dev/null
-
-
-ac_pwd=`pwd` && test -n "$ac_pwd" &&
-ac_ls_di=`ls -di .` &&
-ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
-  as_fn_error $? "working directory cannot be determined"
-test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
-  as_fn_error $? "pwd does not report name of working directory"
-
-
-# Find the source files, if location was not specified.
-if test -z "$srcdir"; then
-  ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then the parent directory.
-  ac_confdir=`$as_dirname -- "$as_myself" ||
-$as_expr X"$as_myself" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_myself" : 'X\(//\)[^/]' \| \
-	 X"$as_myself" : 'X\(//\)$' \| \
-	 X"$as_myself" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$as_myself" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  srcdir=$ac_confdir
-  if test ! -r "$srcdir/$ac_unique_file"; then
-    srcdir=..
-  fi
-else
-  ac_srcdir_defaulted=no
-fi
-if test ! -r "$srcdir/$ac_unique_file"; then
-  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
-  as_fn_error $? "cannot find sources ($ac_unique_file) in $srcdir"
-fi
-ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
-ac_abs_confdir=`(
-	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
-	pwd)`
-# When building in place, set srcdir=.
-if test "$ac_abs_confdir" = "$ac_pwd"; then
-  srcdir=.
-fi
-# Remove unnecessary trailing slashes from srcdir.
-# Double slashes in file names in object file debugging info
-# mess up M-x gdb in Emacs.
-case $srcdir in
-*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
-esac
-for ac_var in $ac_precious_vars; do
-  eval ac_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_env_${ac_var}_value=\$${ac_var}
-  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_cv_env_${ac_var}_value=\$${ac_var}
-done
-
-#
-# Report the --help message.
-#
-if test "$ac_init_help" = "long"; then
-  # Omit some internal or obsolete options to make the list less imposing.
-  # This message is too long to be a string in the A/UX 3.1 sh.
-  cat <<_ACEOF
-\`configure' configures ICU 56.1 to adapt to many kinds of systems.
-
-Usage: $0 [OPTION]... [VAR=VALUE]...
-
-To assign environment variables (e.g., CC, CFLAGS...), specify them as
-VAR=VALUE.  See below for descriptions of some of the useful variables.
-
-Defaults for the options are specified in brackets.
-
-Configuration:
-  -h, --help              display this help and exit
-      --help=short        display options specific to this package
-      --help=recursive    display the short help of all the included packages
-  -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking ...' messages
-      --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
-  -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
-
-Installation directories:
-  --prefix=PREFIX         install architecture-independent files in PREFIX
-                          [$ac_default_prefix]
-  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
-                          [PREFIX]
-
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
-
-For better control, use the options below.
-
-Fine tuning of the installation directories:
-  --bindir=DIR            user executables [EPREFIX/bin]
-  --sbindir=DIR           system admin executables [EPREFIX/sbin]
-  --libexecdir=DIR        program executables [EPREFIX/libexec]
-  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
-  --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
-  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
-  --libdir=DIR            object code libraries [EPREFIX/lib]
-  --includedir=DIR        C header files [PREFIX/include]
-  --oldincludedir=DIR     C header files for non-gcc [/usr/include]
-  --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
-  --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
-  --infodir=DIR           info documentation [DATAROOTDIR/info]
-  --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
-  --mandir=DIR            man documentation [DATAROOTDIR/man]
-  --docdir=DIR            documentation root [DATAROOTDIR/doc/International
-                          Components for Unicode]
-  --htmldir=DIR           html documentation [DOCDIR]
-  --dvidir=DIR            dvi documentation [DOCDIR]
-  --pdfdir=DIR            pdf documentation [DOCDIR]
-  --psdir=DIR             ps documentation [DOCDIR]
-_ACEOF
-
-  cat <<\_ACEOF
-
-System types:
-  --build=BUILD     configure for building on BUILD [guessed]
-  --host=HOST       cross-compile to build programs to run on HOST [BUILD]
-_ACEOF
-fi
-
-if test -n "$ac_init_help"; then
-  case $ac_init_help in
-     short | recursive ) echo "Configuration of ICU 56.1:";;
-   esac
-  cat <<\_ACEOF
-
-Optional Features:
-  --disable-option-checking  ignore unrecognized --enable/--with options
-  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
-  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
-  --enable-debug          build debug libraries and enable the U_DEBUG define default=no
-  --enable-release        build release libraries default=yes
-  --enable-strict         compile with strict compiler options default=yes
-  --enable-64bit-libs     (deprecated, use --with-library-bits) build 64-bit libraries default= platform default
-  --enable-shared         build shared libraries default=yes
-  --enable-static         build static libraries default=no
-  --enable-auto-cleanup   enable auto cleanup of libraries default=no
-  --enable-draft          enable draft APIs (and internal APIs) default=yes
-  --enable-renaming       add a version suffix to symbols default=yes
-  --enable-tracing        enable function and data tracing default=no
-  --enable-plugins        enable plugins default=no
-  --disable-dyload        disable dynamic loading default=no
-  --enable-rpath          use rpath when linking default is only if necessary
-  --enable-weak-threads   weakly reference the threading library default=no
-  --enable-extras         build ICU extras default=yes
-  --enable-icuio          build ICU's icuio library default=yes
-  --enable-layout         build ICU's DEPRECATED layout library default=yes
-  --enable-layoutex         build ICU's Paragraph Layout library default=same-as-layout.
-            If not building with the ICU Layout library, then icu-le-hb must be installed via pkg-config.
-            See http://harfbuzz.org
-  --enable-tools         build ICU's tools default=yes
-  --enable-tests          build ICU tests default=yes
-  --enable-samples        build ICU samples default=yes
-
-Additionally, the variable FORCE_LIBS may be set before calling configure.
-If set, it will REPLACE any automatic list of libraries.
-
-Optional Packages:
-  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
-  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
-  --with-cross-build=dir specify an absolute path to the build directory of an ICU built for the current platform default=no cross dir
-  --with-library-bits=bits specify how many bits to use for the library (32, 64, 64else32, nochange) default=nochange
-  --with-data-packaging     specify how to package ICU data. Possible values:
-        files    raw files (.res, etc)
-        archive  build a single icudtXX.dat file
-        library  shared library (.dll/.so/etc.)
-        static   static library (.a/.lib/etc.)
-        auto     build shared if possible (default)
-           See http://userguide.icu-project.org/icudata for more info.
-  --with-library-suffix=suffix    tag a suffix to the library names default=
-
-Some influential environment variables:
-  CC          C compiler command
-  CFLAGS      C compiler flags
-  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
-              nonstandard directory <lib dir>
-  LIBS        libraries to pass to the linker, e.g. -l<library>
-  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
-              you have headers in a nonstandard directory <include dir>
-  CXX         C++ compiler command
-  CXXFLAGS    C++ compiler flags
-  PKG_CONFIG  path to pkg-config utility
-  PKG_CONFIG_PATH
-              directories to add to pkg-config's search path
-  PKG_CONFIG_LIBDIR
-              path overriding pkg-config's built-in search path
-  ICULEHB_CFLAGS
-              C compiler flags for ICULEHB, overriding pkg-config
-  ICULEHB_LIBS
-              linker flags for ICULEHB, overriding pkg-config
-  CPP         C preprocessor
-
-Use these variables to override the choices made by `configure' or to help
-it to find libraries and programs with nonstandard names/locations.
-
-Report bugs to <http://icu-project.org/bugs>.
-ICU home page: <http://icu-project.org>.
-_ACEOF
-ac_status=$?
-fi
-
-if test "$ac_init_help" = "recursive"; then
-  # If there are subdirs, report their specific --help.
-  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d "$ac_dir" ||
-      { cd "$srcdir" && ac_pwd=`pwd` && srcdir=. && test -d "$ac_dir"; } ||
-      continue
-    ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`$as_echo "$ac_dir" | sed 's|^\.[\\/]||'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`$as_echo "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-    cd "$ac_dir" || { ac_status=$?; continue; }
-    # Check for guested configure.
-    if test -f "$ac_srcdir/configure.gnu"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
-    elif test -f "$ac_srcdir/configure"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure" --help=recursive
-    else
-      $as_echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi || ac_status=$?
-    cd "$ac_pwd" || { ac_status=$?; break; }
-  done
-fi
-
-test -n "$ac_init_help" && exit $ac_status
-if $ac_init_version; then
-  cat <<\_ACEOF
-ICU configure 56.1
-generated by GNU Autoconf 2.69
-
-Copyright (C) 2012 Free Software Foundation, Inc.
-This configure script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it.
-
- Copyright (c) 1999-2015, International Business Machines Corporation and others. All Rights Reserved.
-_ACEOF
-  exit
-fi
-
-## ------------------------ ##
-## Autoconf initialization. ##
-## ------------------------ ##
-
-# ac_fn_c_try_compile LINENO
-# --------------------------
-# Try to compile conftest.$ac_ext, and return whether this succeeded.
-ac_fn_c_try_compile ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  rm -f conftest.$ac_objext
-  if { { ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    grep -v '^ *+' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-    mv -f conftest.er1 conftest.err
-  fi
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_retval=1
-fi
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_c_try_compile
-
-# ac_fn_cxx_try_compile LINENO
-# ----------------------------
-# Try to compile conftest.$ac_ext, and return whether this succeeded.
-ac_fn_cxx_try_compile ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  rm -f conftest.$ac_objext
-  if { { ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    grep -v '^ *+' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-    mv -f conftest.er1 conftest.err
-  fi
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_retval=1
-fi
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_cxx_try_compile
-
-# ac_fn_c_try_cpp LINENO
-# ----------------------
-# Try to preprocess conftest.$ac_ext, and return whether this succeeded.
-ac_fn_c_try_cpp ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  if { { ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    grep -v '^ *+' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-    mv -f conftest.er1 conftest.err
-  fi
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } > conftest.i && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-    ac_retval=1
-fi
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_c_try_cpp
-
-# ac_fn_cxx_try_link LINENO
-# -------------------------
-# Try to link conftest.$ac_ext, and return whether this succeeded.
-ac_fn_cxx_try_link ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  rm -f conftest.$ac_objext conftest$ac_exeext
-  if { { ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    grep -v '^ *+' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-    mv -f conftest.er1 conftest.err
-  fi
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext && {
-	 test "$cross_compiling" = yes ||
-	 test -x conftest$ac_exeext
-       }; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_retval=1
-fi
-  # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information
-  # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would
-  # interfere with the next link command; also delete a directory that is
-  # left behind by Apple's compiler.  We do this before executing the actions.
-  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_cxx_try_link
-
-# ac_fn_c_try_run LINENO
-# ----------------------
-# Try to link conftest.$ac_ext, and return whether this succeeded. Assumes
-# that executables *can* be run.
-ac_fn_c_try_run ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  if { { ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
-  { { case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; }; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: program exited with status $ac_status" >&5
-       $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-       ac_retval=$ac_status
-fi
-  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_c_try_run
-
-# ac_fn_c_compute_int LINENO EXPR VAR INCLUDES
-# --------------------------------------------
-# Tries to find the compile-time value of EXPR in a program that includes
-# INCLUDES, setting VAR accordingly. Returns whether the value could be
-# computed
-ac_fn_c_compute_int ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  if test "$cross_compiling" = yes; then
-    # Depending upon the size, compute the lo and hi bounds.
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-static int test_array [1 - 2 * !(($2) >= 0)];
-test_array [0] = 0;
-return test_array [0];
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_lo=0 ac_mid=0
-  while :; do
-    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-static int test_array [1 - 2 * !(($2) <= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_hi=$ac_mid; break
-else
-  as_fn_arith $ac_mid + 1 && ac_lo=$as_val
-			if test $ac_lo -le $ac_mid; then
-			  ac_lo= ac_hi=
-			  break
-			fi
-			as_fn_arith 2 '*' $ac_mid + 1 && ac_mid=$as_val
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-  done
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-static int test_array [1 - 2 * !(($2) < 0)];
-test_array [0] = 0;
-return test_array [0];
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_hi=-1 ac_mid=-1
-  while :; do
-    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-static int test_array [1 - 2 * !(($2) >= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_lo=$ac_mid; break
-else
-  as_fn_arith '(' $ac_mid ')' - 1 && ac_hi=$as_val
-			if test $ac_mid -le $ac_hi; then
-			  ac_lo= ac_hi=
-			  break
-			fi
-			as_fn_arith 2 '*' $ac_mid && ac_mid=$as_val
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-  done
-else
-  ac_lo= ac_hi=
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-# Binary search between lo and hi bounds.
-while test "x$ac_lo" != "x$ac_hi"; do
-  as_fn_arith '(' $ac_hi - $ac_lo ')' / 2 + $ac_lo && ac_mid=$as_val
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-static int test_array [1 - 2 * !(($2) <= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_hi=$ac_mid
-else
-  as_fn_arith '(' $ac_mid ')' + 1 && ac_lo=$as_val
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-done
-case $ac_lo in #((
-?*) eval "$3=\$ac_lo"; ac_retval=0 ;;
-'') ac_retval=1 ;;
-esac
-  else
-    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-static long int longval () { return $2; }
-static unsigned long int ulongval () { return $2; }
-#include <stdio.h>
-#include <stdlib.h>
-int
-main ()
-{
-
-  FILE *f = fopen ("conftest.val", "w");
-  if (! f)
-    return 1;
-  if (($2) < 0)
-    {
-      long int i = longval ();
-      if (i != ($2))
-	return 1;
-      fprintf (f, "%ld", i);
-    }
-  else
-    {
-      unsigned long int i = ulongval ();
-      if (i != ($2))
-	return 1;
-      fprintf (f, "%lu", i);
-    }
-  /* Do not output a trailing newline, as this causes \r\n confusion
-     on some platforms.  */
-  return ferror (f) || fclose (f) != 0;
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  echo >>conftest.val; read $3 <conftest.val; ac_retval=0
-else
-  ac_retval=1
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-rm -f conftest.val
-
-  fi
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_c_compute_int
-
-# ac_fn_c_check_header_compile LINENO HEADER VAR INCLUDES
-# -------------------------------------------------------
-# Tests whether HEADER exists and can be compiled using the include files in
-# INCLUDES, setting the cache variable VAR accordingly.
-ac_fn_c_check_header_compile ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
-$as_echo_n "checking for $2... " >&6; }
-if eval \${$3+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-#include <$2>
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  eval "$3=yes"
-else
-  eval "$3=no"
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-eval ac_res=\$$3
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-
-} # ac_fn_c_check_header_compile
-
-# ac_fn_c_try_link LINENO
-# -----------------------
-# Try to link conftest.$ac_ext, and return whether this succeeded.
-ac_fn_c_try_link ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  rm -f conftest.$ac_objext conftest$ac_exeext
-  if { { ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    grep -v '^ *+' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-    mv -f conftest.er1 conftest.err
-  fi
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext && {
-	 test "$cross_compiling" = yes ||
-	 test -x conftest$ac_exeext
-       }; then :
-  ac_retval=0
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_retval=1
-fi
-  # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information
-  # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would
-  # interfere with the next link command; also delete a directory that is
-  # left behind by Apple's compiler.  We do this before executing the actions.
-  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-  as_fn_set_status $ac_retval
-
-} # ac_fn_c_try_link
-
-# ac_fn_c_check_header_mongrel LINENO HEADER VAR INCLUDES
-# -------------------------------------------------------
-# Tests whether HEADER exists, giving a warning if it cannot be compiled using
-# the include files in INCLUDES and setting the cache variable VAR
-# accordingly.
-ac_fn_c_check_header_mongrel ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  if eval \${$3+:} false; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
-$as_echo_n "checking for $2... " >&6; }
-if eval \${$3+:} false; then :
-  $as_echo_n "(cached) " >&6
-fi
-eval ac_res=\$$3
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-else
-  # Is the header compilable?
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking $2 usability" >&5
-$as_echo_n "checking $2 usability... " >&6; }
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-#include <$2>
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_header_compiler=yes
-else
-  ac_header_compiler=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_header_compiler" >&5
-$as_echo "$ac_header_compiler" >&6; }
-
-# Is the header present?
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking $2 presence" >&5
-$as_echo_n "checking $2 presence... " >&6; }
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <$2>
-_ACEOF
-if ac_fn_c_try_cpp "$LINENO"; then :
-  ac_header_preproc=yes
-else
-  ac_header_preproc=no
-fi
-rm -f conftest.err conftest.i conftest.$ac_ext
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_header_preproc" >&5
-$as_echo "$ac_header_preproc" >&6; }
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in #((
-  yes:no: )
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: accepted by the compiler, rejected by the preprocessor!" >&5
-$as_echo "$as_me: WARNING: $2: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: proceeding with the compiler's result" >&5
-$as_echo "$as_me: WARNING: $2: proceeding with the compiler's result" >&2;}
-    ;;
-  no:yes:* )
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: present but cannot be compiled" >&5
-$as_echo "$as_me: WARNING: $2: present but cannot be compiled" >&2;}
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2:     check for missing prerequisite headers?" >&5
-$as_echo "$as_me: WARNING: $2:     check for missing prerequisite headers?" >&2;}
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: see the Autoconf documentation" >&5
-$as_echo "$as_me: WARNING: $2: see the Autoconf documentation" >&2;}
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2:     section \"Present But Cannot Be Compiled\"" >&5
-$as_echo "$as_me: WARNING: $2:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: proceeding with the compiler's result" >&5
-$as_echo "$as_me: WARNING: $2: proceeding with the compiler's result" >&2;}
-( $as_echo "## ------------------------------------------ ##
-## Report this to http://icu-project.org/bugs ##
-## ------------------------------------------ ##"
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
-$as_echo_n "checking for $2... " >&6; }
-if eval \${$3+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  eval "$3=\$ac_header_compiler"
-fi
-eval ac_res=\$$3
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-fi
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-
-} # ac_fn_c_check_header_mongrel
-
-# ac_fn_c_check_func LINENO FUNC VAR
-# ----------------------------------
-# Tests whether FUNC exists, setting the cache variable VAR accordingly
-ac_fn_c_check_func ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
-$as_echo_n "checking for $2... " >&6; }
-if eval \${$3+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-/* Define $2 to an innocuous variant, in case <limits.h> declares $2.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define $2 innocuous_$2
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char $2 (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef $2
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char $2 ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined __stub_$2 || defined __stub___$2
-choke me
-#endif
-
-int
-main ()
-{
-return $2 ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  eval "$3=yes"
-else
-  eval "$3=no"
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-eval ac_res=\$$3
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-
-} # ac_fn_c_check_func
-
-# ac_fn_c_check_type LINENO TYPE VAR INCLUDES
-# -------------------------------------------
-# Tests whether TYPE exists after having included INCLUDES, setting cache
-# variable VAR accordingly.
-ac_fn_c_check_type ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
-$as_echo_n "checking for $2... " >&6; }
-if eval \${$3+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  eval "$3=no"
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-if (sizeof ($2))
-	 return 0;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$4
-int
-main ()
-{
-if (sizeof (($2)))
-	    return 0;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-
-else
-  eval "$3=yes"
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-eval ac_res=\$$3
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-
-} # ac_fn_c_check_type
-cat >config.log <<_ACEOF
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by ICU $as_me 56.1, which was
-generated by GNU Autoconf 2.69.  Invocation command line was
-
-  $ $0 $@
-
-_ACEOF
-exec 5>>config.log
-{
-cat <<_ASUNAME
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
-
-_ASUNAME
-
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    $as_echo "PATH: $as_dir"
-  done
-IFS=$as_save_IFS
-
-} >&5
-
-cat >&5 <<_ACEOF
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-_ACEOF
-
-
-# Keep a trace of the command line.
-# Strip out --no-create and --no-recursion so they do not pile up.
-# Strip out --silent because we don't want to record it for future runs.
-# Also quote any args containing shell meta-characters.
-# Make two passes to allow for proper duplicate-argument suppression.
-ac_configure_args=
-ac_configure_args0=
-ac_configure_args1=
-ac_must_keep_next=false
-for ac_pass in 1 2
-do
-  for ac_arg
-  do
-    case $ac_arg in
-    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
-    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-    | -silent | --silent | --silen | --sile | --sil)
-      continue ;;
-    *\'*)
-      ac_arg=`$as_echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    case $ac_pass in
-    1) as_fn_append ac_configure_args0 " '$ac_arg'" ;;
-    2)
-      as_fn_append ac_configure_args1 " '$ac_arg'"
-      if test $ac_must_keep_next = true; then
-	ac_must_keep_next=false # Got value, back to normal.
-      else
-	case $ac_arg in
-	  *=* | --config-cache | -C | -disable-* | --disable-* \
-	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
-	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
-	  | -with-* | --with-* | -without-* | --without-* | --x)
-	    case "$ac_configure_args0 " in
-	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
-	    esac
-	    ;;
-	  -* ) ac_must_keep_next=true ;;
-	esac
-      fi
-      as_fn_append ac_configure_args " '$ac_arg'"
-      ;;
-    esac
-  done
-done
-{ ac_configure_args0=; unset ac_configure_args0;}
-{ ac_configure_args1=; unset ac_configure_args1;}
-
-# When interrupted or exit'd, cleanup temporary files, and complete
-# config.log.  We remove comments because anyway the quotes in there
-# would cause problems or look ugly.
-# WARNING: Use '\'' to represent an apostrophe within the trap.
-# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
-trap 'exit_status=$?
-  # Save into config.log some information that might help in debugging.
-  {
-    echo
-
-    $as_echo "## ---------------- ##
-## Cache variables. ##
-## ---------------- ##"
-    echo
-    # The following way of writing the cache mishandles newlines in values,
-(
-  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
-$as_echo "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
-      *) { eval $ac_var=; unset $ac_var;} ;;
-      esac ;;
-    esac
-  done
-  (set) 2>&1 |
-    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      sed -n \
-	"s/'\''/'\''\\\\'\'''\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
-      ;; #(
-    *)
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-)
-    echo
-
-    $as_echo "## ----------------- ##
-## Output variables. ##
-## ----------------- ##"
-    echo
-    for ac_var in $ac_subst_vars
-    do
-      eval ac_val=\$$ac_var
-      case $ac_val in
-      *\'\''*) ac_val=`$as_echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-      esac
-      $as_echo "$ac_var='\''$ac_val'\''"
-    done | sort
-    echo
-
-    if test -n "$ac_subst_files"; then
-      $as_echo "## ------------------- ##
-## File substitutions. ##
-## ------------------- ##"
-      echo
-      for ac_var in $ac_subst_files
-      do
-	eval ac_val=\$$ac_var
-	case $ac_val in
-	*\'\''*) ac_val=`$as_echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-	esac
-	$as_echo "$ac_var='\''$ac_val'\''"
-      done | sort
-      echo
-    fi
-
-    if test -s confdefs.h; then
-      $as_echo "## ----------- ##
-## confdefs.h. ##
-## ----------- ##"
-      echo
-      cat confdefs.h
-      echo
-    fi
-    test "$ac_signal" != 0 &&
-      $as_echo "$as_me: caught signal $ac_signal"
-    $as_echo "$as_me: exit $exit_status"
-  } >&5
-  rm -f core *.core core.conftest.* &&
-    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
-    exit $exit_status
-' 0
-for ac_signal in 1 2 13 15; do
-  trap 'ac_signal='$ac_signal'; as_fn_exit 1' $ac_signal
-done
-ac_signal=0
-
-# confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -f -r conftest* confdefs.h
-
-$as_echo "/* confdefs.h */" > confdefs.h
-
-# Predefined preprocessor variables.
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_NAME "$PACKAGE_NAME"
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_VERSION "$PACKAGE_VERSION"
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_STRING "$PACKAGE_STRING"
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_URL "$PACKAGE_URL"
-_ACEOF
-
-
-# Let the site file select an alternate cache file if it wants to.
-# Prefer an explicitly selected file to automatically selected ones.
-ac_site_file1=NONE
-ac_site_file2=NONE
-if test -n "$CONFIG_SITE"; then
-  # We do not want a PATH search for config.site.
-  case $CONFIG_SITE in #((
-    -*)  ac_site_file1=./$CONFIG_SITE;;
-    */*) ac_site_file1=$CONFIG_SITE;;
-    *)   ac_site_file1=./$CONFIG_SITE;;
-  esac
-elif test "x$prefix" != xNONE; then
-  ac_site_file1=$prefix/share/config.site
-  ac_site_file2=$prefix/etc/config.site
-else
-  ac_site_file1=$ac_default_prefix/share/config.site
-  ac_site_file2=$ac_default_prefix/etc/config.site
-fi
-for ac_site_file in "$ac_site_file1" "$ac_site_file2"
-do
-  test "x$ac_site_file" = xNONE && continue
-  if test /dev/null != "$ac_site_file" && test -r "$ac_site_file"; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: loading site script $ac_site_file" >&5
-$as_echo "$as_me: loading site script $ac_site_file" >&6;}
-    sed 's/^/| /' "$ac_site_file" >&5
-    . "$ac_site_file" \
-      || { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "failed to load site script $ac_site_file
-See \`config.log' for more details" "$LINENO" 5; }
-  fi
-done
-
-if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special files
-  # actually), so we avoid doing that.  DJGPP emulates it as a regular file.
-  if test /dev/null != "$cache_file" && test -f "$cache_file"; then
-    { $as_echo "$as_me:${as_lineno-$LINENO}: loading cache $cache_file" >&5
-$as_echo "$as_me: loading cache $cache_file" >&6;}
-    case $cache_file in
-      [\\/]* | ?:[\\/]* ) . "$cache_file";;
-      *)                      . "./$cache_file";;
-    esac
-  fi
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: creating cache $cache_file" >&5
-$as_echo "$as_me: creating cache $cache_file" >&6;}
-  >$cache_file
-fi
-
-# Check that the precious variables saved in the cache have kept the same
-# value.
-ac_cache_corrupted=false
-for ac_var in $ac_precious_vars; do
-  eval ac_old_set=\$ac_cv_env_${ac_var}_set
-  eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val=\$ac_cv_env_${ac_var}_value
-  eval ac_new_val=\$ac_env_${ac_var}_value
-  case $ac_old_set,$ac_new_set in
-    set,)
-      { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-$as_echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,set)
-      { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was not set in the previous run" >&5
-$as_echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,);;
-    *)
-      if test "x$ac_old_val" != "x$ac_new_val"; then
-	# differences in whitespace do not lead to failure.
-	ac_old_val_w=`echo x $ac_old_val`
-	ac_new_val_w=`echo x $ac_new_val`
-	if test "$ac_old_val_w" != "$ac_new_val_w"; then
-	  { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' has changed since the previous run:" >&5
-$as_echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
-	  ac_cache_corrupted=:
-	else
-	  { $as_echo "$as_me:${as_lineno-$LINENO}: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&5
-$as_echo "$as_me: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&2;}
-	  eval $ac_var=\$ac_old_val
-	fi
-	{ $as_echo "$as_me:${as_lineno-$LINENO}:   former value:  \`$ac_old_val'" >&5
-$as_echo "$as_me:   former value:  \`$ac_old_val'" >&2;}
-	{ $as_echo "$as_me:${as_lineno-$LINENO}:   current value: \`$ac_new_val'" >&5
-$as_echo "$as_me:   current value: \`$ac_new_val'" >&2;}
-      fi;;
-  esac
-  # Pass precious variables to config.status.
-  if test "$ac_new_set" = set; then
-    case $ac_new_val in
-    *\'*) ac_arg=$ac_var=`$as_echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
-    *) ac_arg=$ac_var=$ac_new_val ;;
-    esac
-    case " $ac_configure_args " in
-      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
-      *) as_fn_append ac_configure_args " '$ac_arg'" ;;
-    esac
-  fi
-done
-if $ac_cache_corrupted; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-  { $as_echo "$as_me:${as_lineno-$LINENO}: error: changes in the environment can compromise the build" >&5
-$as_echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  as_fn_error $? "run \`make distclean' and/or \`rm $cache_file' and start over" "$LINENO" 5
-fi
-## -------------------- ##
-## Main body of script. ##
-## -------------------- ##
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-
-
-
-
-PACKAGE="icu"
-
-
-# Use custom echo test for newline option
-# Current autoconf (2.65) gives incorrect echo newline option
-# for icu-config
-# This may be removed later - mow (June 17, 2010)
-ICU_ECHO_C= ICU_ECHO_N= ICU_ECHO_T=
-case `/bin/sh -c "echo -n x"` in
--n*)
-  case `/bin/sh -c "echo 'x\c'"` in
-  *c*) ICU_ECHO_T=' ';;     # ECHO_T is single tab character.
-  *)   ICU_ECHO_C='\c';;
-  esac;;
-*)
-  ICU_ECHO_N='-n';;
-esac
-
-
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for ICU version numbers" >&5
-$as_echo_n "checking for ICU version numbers... " >&6; }
-
-# Get the ICU version from uversion.h or other headers
-geticuversion() {
-    sed -n 's/^[ 	]*#[ 	]*define[ 	]*U_ICU_VERSION[ 	]*"\([^"]*\)".*/\1/p' "$@"
-}
-getuversion() {
-    sed -n 's/^[ 	]*#[ 	]*define[ 	]*U_UNICODE_VERSION[ 	]*"\([^"]*\)".*/\1/p' "$@"
-}
-VERSION=`geticuversion $srcdir/common/unicode/uvernum.h`
-if test x"$VERSION" = x; then
-   as_fn_error $? "Cannot determine ICU version number from uvernum.h header file" "$LINENO" 5
-fi
-
-#TODO: IcuBug:8502
-#if test "$VERSION" != "$PACKAGE_VERSION"; then
-#   AC_MSG_ERROR([configure was generated for $PACKAGE_VERSION but uvernum.h has $VERSION - please rerun autoconf])
-#fi
-
-UNICODE_VERSION=`getuversion $srcdir/common/unicode/uchar.h`
-if test x"$UNICODE_VERSION" = x; then
-    as_fn_error $? "Cannot determine Unicode version number from uchar.h header file" "$LINENO" 5
-fi
-# Compute a reasonable library version from the release version. This is
-# very bad, but that's wanted... We want to make sure that the LIB_VERSION
-# has at least a dot in it, so we'll add a .0 if needed.
-#[LIB_VERSION=`echo $VERSION | sed -e 's/\.//' -e 's/^\([^.]*\)$/\1.0/'`]
-LIB_VERSION=$VERSION
-LIB_VERSION_MAJOR=`echo $LIB_VERSION | sed 's/\..*//'`
-
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: release $VERSION, library $LIB_VERSION, unicode version $UNICODE_VERSION" >&5
-$as_echo "release $VERSION, library $LIB_VERSION, unicode version $UNICODE_VERSION" >&6; }
-
-
-
-# Determine the host system
-ac_aux_dir=
-for ac_dir in "$srcdir" "$srcdir/.." "$srcdir/../.."; do
-  if test -f "$ac_dir/install-sh"; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/install-sh -c"
-    break
-  elif test -f "$ac_dir/install.sh"; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/install.sh -c"
-    break
-  elif test -f "$ac_dir/shtool"; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/shtool install -c"
-    break
-  fi
-done
-if test -z "$ac_aux_dir"; then
-  as_fn_error $? "cannot find install-sh, install.sh, or shtool in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" "$LINENO" 5
-fi
-
-# These three variables are undocumented and unsupported,
-# and are intended to be withdrawn in a future Autoconf release.
-# They can cause serious problems if a builder's source tree is in a directory
-# whose full name contains unusual characters.
-ac_config_guess="$SHELL $ac_aux_dir/config.guess"  # Please don't use this var.
-ac_config_sub="$SHELL $ac_aux_dir/config.sub"  # Please don't use this var.
-ac_configure="$SHELL $ac_aux_dir/configure"  # Please don't use this var.
-
-
-# Make sure we can run config.sub.
-$SHELL "$ac_aux_dir/config.sub" sun4 >/dev/null 2>&1 ||
-  as_fn_error $? "cannot run $SHELL $ac_aux_dir/config.sub" "$LINENO" 5
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking build system type" >&5
-$as_echo_n "checking build system type... " >&6; }
-if ${ac_cv_build+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_build_alias=$build_alias
-test "x$ac_build_alias" = x &&
-  ac_build_alias=`$SHELL "$ac_aux_dir/config.guess"`
-test "x$ac_build_alias" = x &&
-  as_fn_error $? "cannot guess build type; you must specify one" "$LINENO" 5
-ac_cv_build=`$SHELL "$ac_aux_dir/config.sub" $ac_build_alias` ||
-  as_fn_error $? "$SHELL $ac_aux_dir/config.sub $ac_build_alias failed" "$LINENO" 5
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_build" >&5
-$as_echo "$ac_cv_build" >&6; }
-case $ac_cv_build in
-*-*-*) ;;
-*) as_fn_error $? "invalid value of canonical build" "$LINENO" 5;;
-esac
-build=$ac_cv_build
-ac_save_IFS=$IFS; IFS='-'
-set x $ac_cv_build
-shift
-build_cpu=$1
-build_vendor=$2
-shift; shift
-# Remember, the first character of IFS is used to create $*,
-# except with old shells:
-build_os=$*
-IFS=$ac_save_IFS
-case $build_os in *\ *) build_os=`echo "$build_os" | sed 's/ /-/g'`;; esac
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking host system type" >&5
-$as_echo_n "checking host system type... " >&6; }
-if ${ac_cv_host+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test "x$host_alias" = x; then
-  ac_cv_host=$ac_cv_build
-else
-  ac_cv_host=`$SHELL "$ac_aux_dir/config.sub" $host_alias` ||
-    as_fn_error $? "$SHELL $ac_aux_dir/config.sub $host_alias failed" "$LINENO" 5
-fi
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_host" >&5
-$as_echo "$ac_cv_host" >&6; }
-case $ac_cv_host in
-*-*-*) ;;
-*) as_fn_error $? "invalid value of canonical host" "$LINENO" 5;;
-esac
-host=$ac_cv_host
-ac_save_IFS=$IFS; IFS='-'
-set x $ac_cv_host
-shift
-host_cpu=$1
-host_vendor=$2
-shift; shift
-# Remember, the first character of IFS is used to create $*,
-# except with old shells:
-host_os=$*
-IFS=$ac_save_IFS
-case $host_os in *\ *) host_os=`echo "$host_os" | sed 's/ /-/g'`;; esac
-
-
-
-
-
-# This variable is needed on z/OS because the C++ compiler only recognizes .C
-_CXX_CXXSUFFIX=cpp
-export _CXX_CXXSUFFIX
-
-# Accumulate #defines
-
-# CONFIG_CPPFLAGS: These are defines that are set for ICU Build time only.
-# They are only needed for building ICU itself. Example: platform stuff
-CONFIG_CPPFLAGS=""
-# UCONFIG_CPPFLAGS: These are defines which are set for ICU build time,
-# and also a notice is output that they need to be set
-# for end-users of ICU also. uconfig.h.prepend is generated
-# with, for example, "#define U_DISABLE_RENAMING 1"
-# Example: ICU configuration stuff
-UCONFIG_CPPFLAGS=""
-# UCONFIG_CFLAGS: contains a copy of anything that needs to be set by end users
-# such as -std
-UCONFIG_CFLAGS=""
-
-# Check whether to build debug libraries
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to build debug libraries" >&5
-$as_echo_n "checking whether to build debug libraries... " >&6; }
-enabled=no
-ENABLE_DEBUG=0
-# Check whether --enable-debug was given.
-if test "${enable_debug+set}" = set; then :
-  enableval=$enable_debug;  case "${enableval}" in
-         yes|"") enabled=yes; ENABLE_DEBUG=1; CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_DEBUG=1" ;;
-         *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# Check whether to build release libraries
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to build release libraries" >&5
-$as_echo_n "checking whether to build release libraries... " >&6; }
-enabled=yes
-ENABLE_RELEASE=1
-# Check whether --enable-release was given.
-if test "${enable_release+set}" = set; then :
-  enableval=$enable_release;  case "${enableval}" in
-         no) enabled=no; ENABLE_RELEASE=0 ;;
-         *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# Don't use the default C/CXXFLags
-: ${CFLAGS=""}
-: ${CXXFLAGS=""}
-
-# Checks for compilers
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  for ac_prog in clang gcc cc c99 c89 xlc_r xlc cl.exe icc
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_CC+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
-$as_echo "$CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in clang gcc cc c99 c89 xlc_r xlc cl.exe icc
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_ac_ct_CC+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
-$as_echo "$ac_ct_CC" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-
-test -z "$CC" && { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "no acceptable C compiler found in \$PATH
-See \`config.log' for more details" "$LINENO" 5; }
-
-# Provide some information about the compiler.
-$as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
-
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files a.out a.out.dSYM a.exe b.out"
-# Try to create an executable without -o first, disregard a.out.
-# It will help us diagnose broken compilers, and finding out an intuition
-# of exeext.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the C compiler works" >&5
-$as_echo_n "checking whether the C compiler works... " >&6; }
-ac_link_default=`$as_echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-
-# The possible output files:
-ac_files="a.out conftest.exe conftest a.exe a_out.exe b.out conftest.*"
-
-ac_rmfiles=
-for ac_file in $ac_files
-do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
-    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
-  esac
-done
-rm -f $ac_rmfiles
-
-if { { ac_try="$ac_link_default"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then :
-  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
-# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
-# in a Makefile.  We should not override ac_cv_exeext if it was cached,
-# so that the user can short-circuit this test for compilers unknown to
-# Autoconf.
-for ac_file in $ac_files ''
-do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj )
-	;;
-    [ab].out )
-	# We found the default executable, but exeext='' is most
-	# certainly right.
-	break;;
-    *.* )
-	if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
-	then :; else
-	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	fi
-	# We set ac_cv_exeext here because the later test for it is not
-	# safe: cross compilers may not add the suffix if given an `-o'
-	# argument, so we may need to know it at that point already.
-	# Even if this section looks crufty: it has the advantage of
-	# actually working.
-	break;;
-    * )
-	break;;
-  esac
-done
-test "$ac_cv_exeext" = no && ac_cv_exeext=
-
-else
-  ac_file=''
-fi
-if test -z "$ac_file"; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-$as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "C compiler cannot create executables
-See \`config.log' for more details" "$LINENO" 5; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
-$as_echo_n "checking for C compiler default output file name... " >&6; }
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
-$as_echo "$ac_file" >&6; }
-ac_exeext=$ac_cv_exeext
-
-rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
-ac_clean_files=$ac_clean_files_save
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for suffix of executables" >&5
-$as_echo_n "checking for suffix of executables... " >&6; }
-if { { ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then :
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
-for ac_file in conftest.exe conftest conftest.*; do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
-    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  break;;
-    * ) break;;
-  esac
-done
-else
-  { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details" "$LINENO" 5; }
-fi
-rm -f conftest conftest$ac_cv_exeext
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_exeext" >&5
-$as_echo "$ac_cv_exeext" >&6; }
-
-rm -f conftest.$ac_ext
-EXEEXT=$ac_cv_exeext
-ac_exeext=$EXEEXT
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdio.h>
-int
-main ()
-{
-FILE *f = fopen ("conftest.out", "w");
- return ferror (f) || fclose (f) != 0;
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files="$ac_clean_files conftest.out"
-# Check that the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are cross compiling" >&5
-$as_echo_n "checking whether we are cross compiling... " >&6; }
-if test "$cross_compiling" != yes; then
-  { { ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-  if { ac_try='./conftest$ac_cv_exeext'
-  { { case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; }; then
-    cross_compiling=no
-  else
-    if test "$cross_compiling" = maybe; then
-	cross_compiling=yes
-    else
-	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details" "$LINENO" 5; }
-    fi
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $cross_compiling" >&5
-$as_echo "$cross_compiling" >&6; }
-
-rm -f conftest.$ac_ext conftest$ac_cv_exeext conftest.out
-ac_clean_files=$ac_clean_files_save
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for suffix of object files" >&5
-$as_echo_n "checking for suffix of object files... " >&6; }
-if ${ac_cv_objext+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.o conftest.obj
-if { { ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then :
-  for ac_file in conftest.o conftest.obj conftest.*; do
-  test -f "$ac_file" || continue;
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM ) ;;
-    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
-       break;;
-  esac
-done
-else
-  $as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "cannot compute suffix of object files: cannot compile
-See \`config.log' for more details" "$LINENO" 5; }
-fi
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objext" >&5
-$as_echo "$ac_cv_objext" >&6; }
-OBJEXT=$ac_cv_objext
-ac_objext=$OBJEXT
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C compiler" >&5
-$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
-if ${ac_cv_c_compiler_gnu+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_compiler_gnu=yes
-else
-  ac_compiler_gnu=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
-$as_echo "$ac_cv_c_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GCC=yes
-else
-  GCC=
-fi
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CC accepts -g" >&5
-$as_echo_n "checking whether $CC accepts -g... " >&6; }
-if ${ac_cv_prog_cc_g+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_g=yes
-else
-  CFLAGS=""
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-
-else
-  ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_g=yes
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
-$as_echo "$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $CC option to accept ISO C89" >&5
-$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
-if ${ac_cv_prog_cc_c89+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-struct stat;
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_prog_cc_c89=$ac_arg
-fi
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
-$as_echo "none needed" >&6; } ;;
-  xno)
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
-$as_echo "unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
-$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-if test "x$ac_cv_prog_cc_c89" != xno; then :
-
-fi
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-# Make sure that we try clang++ first, which provides C++11 support.
-# The g++ compiler is less likely to support C++11.
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in clang++ g++ c++ gpp xlC_r xlC aCC CC cxx cc++ cl.exe icc FCC KCC RCC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_CXX+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CXX" >&5
-$as_echo "$CXX" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in clang++ g++ c++ gpp xlC_r xlC aCC CC cxx cc++ cl.exe icc FCC KCC RCC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_ac_ct_CXX+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CXX" >&5
-$as_echo "$ac_ct_CXX" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CXX" && break
-done
-
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
-
-  fi
-fi
-# Provide some information about the compiler.
-$as_echo "$as_me:${as_lineno-$LINENO}: checking for C++ compiler version" >&5
-set X $ac_compile
-ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C++ compiler" >&5
-$as_echo_n "checking whether we are using the GNU C++ compiler... " >&6; }
-if ${ac_cv_cxx_compiler_gnu+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_compiler_gnu=yes
-else
-  ac_compiler_gnu=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cxx_compiler_gnu" >&5
-$as_echo "$ac_cv_cxx_compiler_gnu" >&6; }
-if test $ac_compiler_gnu = yes; then
-  GXX=yes
-else
-  GXX=
-fi
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CXX accepts -g" >&5
-$as_echo_n "checking whether $CXX accepts -g... " >&6; }
-if ${ac_cv_prog_cxx_g+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
-   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_prog_cxx_g=yes
-else
-  CXXFLAGS=""
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-
-else
-  ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_prog_cxx_g=yes
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_g" >&5
-$as_echo "$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-# pkg-config is needed for harfbuzz support
-
-
-
-
-
-
-
-if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
-	if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}pkg-config", so it can be a program name with args.
-set dummy ${ac_tool_prefix}pkg-config; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_path_PKG_CONFIG+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  ;;
-esac
-fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-if test -n "$PKG_CONFIG"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $PKG_CONFIG" >&5
-$as_echo "$PKG_CONFIG" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_path_PKG_CONFIG"; then
-  ac_pt_PKG_CONFIG=$PKG_CONFIG
-  # Extract the first word of "pkg-config", so it can be a program name with args.
-set dummy pkg-config; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_path_ac_pt_PKG_CONFIG+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  case $ac_pt_PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_ac_pt_PKG_CONFIG="$ac_pt_PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_ac_pt_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  ;;
-esac
-fi
-ac_pt_PKG_CONFIG=$ac_cv_path_ac_pt_PKG_CONFIG
-if test -n "$ac_pt_PKG_CONFIG"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_pt_PKG_CONFIG" >&5
-$as_echo "$ac_pt_PKG_CONFIG" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_pt_PKG_CONFIG" = x; then
-    PKG_CONFIG=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    PKG_CONFIG=$ac_pt_PKG_CONFIG
-  fi
-else
-  PKG_CONFIG="$ac_cv_path_PKG_CONFIG"
-fi
-
-fi
-if test -n "$PKG_CONFIG"; then
-	_pkg_min_version=0.20
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking pkg-config is at least version $_pkg_min_version" >&5
-$as_echo_n "checking pkg-config is at least version $_pkg_min_version... " >&6; }
-	if $PKG_CONFIG --atleast-pkgconfig-version $_pkg_min_version; then
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-	else
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-		PKG_CONFIG=""
-	fi
-fi
-
-pkg_failed=no
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for ICULEHB" >&5
-$as_echo_n "checking for ICULEHB... " >&6; }
-
-if test -n "$ICULEHB_CFLAGS"; then
-    pkg_cv_ICULEHB_CFLAGS="$ICULEHB_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"icu-le-hb\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "icu-le-hb") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_ICULEHB_CFLAGS=`$PKG_CONFIG --cflags "icu-le-hb" 2>/dev/null`
-		      test "x$?" != "x0" && pkg_failed=yes
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-if test -n "$ICULEHB_LIBS"; then
-    pkg_cv_ICULEHB_LIBS="$ICULEHB_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"icu-le-hb\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "icu-le-hb") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_ICULEHB_LIBS=`$PKG_CONFIG --libs "icu-le-hb" 2>/dev/null`
-		      test "x$?" != "x0" && pkg_failed=yes
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-
-
-
-if test $pkg_failed = yes; then
-   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-
-if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
-        _pkg_short_errors_supported=yes
-else
-        _pkg_short_errors_supported=no
-fi
-        if test $_pkg_short_errors_supported = yes; then
-	        ICULEHB_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "icu-le-hb" 2>&1`
-        else
-	        ICULEHB_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "icu-le-hb" 2>&1`
-        fi
-	# Put the nasty error message in config.log where it belongs
-	echo "$ICULEHB_PKG_ERRORS" >&5
-
-	:
-elif test $pkg_failed = untried; then
-     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-	:
-else
-	ICULEHB_CFLAGS=$pkg_cv_ICULEHB_CFLAGS
-	ICULEHB_LIBS=$pkg_cv_ICULEHB_LIBS
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-	have_icu_le_hb=true
-fi
-
-# Ensure that if CXXFLAGS/CFLAGS were not set when calling configure, set it correctly based on (enable/disable) debug or release option
-# The release mode use is the default one for autoconf
-if test "$GCC" = yes; then
-    if test "$CFLAGS" = ""; then
-        if test "$ENABLE_DEBUG" = 1; then
-            CFLAGS=-g
-        fi
-        if test "$ENABLE_RELEASE" = 1; then
-            CFLAGS="$CFLAGS -O2"
-        fi
-    fi
-    if test "$CXXFLAGS" = ""; then
-        if test "$ENABLE_DEBUG" = 1; then
-            CXXFLAGS=-g
-        fi
-        if test "$ENABLE_RELEASE" = 1; then
-            CXXFLAGS="$CXXFLAGS -O2"
-        fi
-    fi
-fi
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking how to run the C preprocessor" >&5
-$as_echo_n "checking how to run the C preprocessor... " >&6; }
-# On Suns, sometimes $CPP names a directory.
-if test -n "$CPP" && test -d "$CPP"; then
-  CPP=
-fi
-if test -z "$CPP"; then
-  if ${ac_cv_prog_CPP+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-      # Double quotes because CPP needs to be expanded
-    for CPP in "$CC -E" "$CC -E -traditional-cpp" "/lib/cpp"
-    do
-      ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if ac_fn_c_try_cpp "$LINENO"; then :
-
-else
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.i conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether nonexistent headers
-  # can be detected and how.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if ac_fn_c_try_cpp "$LINENO"; then :
-  # Broken: success on invalid input.
-continue
-else
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.i conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.i conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then :
-  break
-fi
-
-    done
-    ac_cv_prog_CPP=$CPP
-
-fi
-  CPP=$ac_cv_prog_CPP
-else
-  ac_cv_prog_CPP=$CPP
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $CPP" >&5
-$as_echo "$CPP" >&6; }
-ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if ac_fn_c_try_cpp "$LINENO"; then :
-
-else
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.i conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether nonexistent headers
-  # can be detected and how.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if ac_fn_c_try_cpp "$LINENO"; then :
-  # Broken: success on invalid input.
-continue
-else
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.i conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.i conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then :
-
-else
-  { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details" "$LINENO" 5; }
-fi
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-# Find a good install program.  We prefer a C program (faster),
-# so one script is as good as another.  But avoid the broken or
-# incompatible versions:
-# SysV /etc/install, /usr/sbin/install
-# SunOS /usr/etc/install
-# IRIX /sbin/install
-# AIX /bin/install
-# AmigaOS /C/install, which installs bootblocks on floppy discs
-# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
-# AFS /usr/afsws/bin/install, which mishandles nonexistent args
-# SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
-# OS/2's system install, which has a completely different semantic
-# ./install, which can be erroneously created by make from ./install.sh.
-# Reject install programs that cannot install multiple files.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for a BSD-compatible install" >&5
-$as_echo_n "checking for a BSD-compatible install... " >&6; }
-if test -z "$INSTALL"; then
-if ${ac_cv_path_install+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    # Account for people who put trailing slashes in PATH elements.
-case $as_dir/ in #((
-  ./ | .// | /[cC]/* | \
-  /etc/* | /usr/sbin/* | /usr/etc/* | /sbin/* | /usr/afsws/bin/* | \
-  ?:[\\/]os2[\\/]install[\\/]* | ?:[\\/]OS2[\\/]INSTALL[\\/]* | \
-  /usr/ucb/* ) ;;
-  *)
-    # OSF1 and SCO ODT 3.0 have their own names for install.
-    # Don't use installbsd from OSF since it installs stuff as root
-    # by default.
-    for ac_prog in ginstall scoinst install; do
-      for ac_exec_ext in '' $ac_executable_extensions; do
-	if as_fn_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
-	  if test $ac_prog = install &&
-	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
-	    # AIX install.  It has an incompatible calling convention.
-	    :
-	  elif test $ac_prog = install &&
-	    grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
-	    # program-specific install script used by HP pwplus--don't use.
-	    :
-	  else
-	    rm -rf conftest.one conftest.two conftest.dir
-	    echo one > conftest.one
-	    echo two > conftest.two
-	    mkdir conftest.dir
-	    if "$as_dir/$ac_prog$ac_exec_ext" -c conftest.one conftest.two "`pwd`/conftest.dir" &&
-	      test -s conftest.one && test -s conftest.two &&
-	      test -s conftest.dir/conftest.one &&
-	      test -s conftest.dir/conftest.two
-	    then
-	      ac_cv_path_install="$as_dir/$ac_prog$ac_exec_ext -c"
-	      break 3
-	    fi
-	  fi
-	fi
-      done
-    done
-    ;;
-esac
-
-  done
-IFS=$as_save_IFS
-
-rm -rf conftest.one conftest.two conftest.dir
-
-fi
-  if test "${ac_cv_path_install+set}" = set; then
-    INSTALL=$ac_cv_path_install
-  else
-    # As a last resort, use the slow shell script.  Don't cache a
-    # value for INSTALL within a source directory, because that will
-    # break other packages using the cache if that directory is
-    # removed, or if the value is a relative name.
-    INSTALL=$ac_install_sh
-  fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $INSTALL" >&5
-$as_echo "$INSTALL" >&6; }
-
-# Use test -z because SunOS4 sh mishandles braces in ${var-val}.
-# It thinks the first close brace ends the variable substitution.
-test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
-
-test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'
-
-test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
-
-
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-# make sure install is relative to srcdir - if a script
-if test "$srcdir" = "."; then
-  # If srcdir isn't just ., then (srcdir) is already prepended.
-  if test "${ac_install_sh}" = "${INSTALL}"; then
-   INSTALL="\\\$(top_srcdir)/${ac_install_sh}"
-  fi
-fi
-
-#AC_CHECK_PROG(AUTOCONF, autoconf, autoconf, true)
-#AC_CHECK_PROG(STRIP, strip, strip, true)
-
-# Check for the platform make
-for ac_prog in gmake gnumake
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_path_U_MAKE+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  case $U_MAKE in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_U_MAKE="$U_MAKE" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_U_MAKE="$as_dir/$ac_word$ac_exec_ext"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  ;;
-esac
-fi
-U_MAKE=$ac_cv_path_U_MAKE
-if test -n "$U_MAKE"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $U_MAKE" >&5
-$as_echo "$U_MAKE" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-  test -n "$U_MAKE" && break
-done
-test -n "$U_MAKE" || U_MAKE="make"
-
-
-
-
-
-# Check whether --with-cross-build was given.
-if test "${with_cross_build+set}" = set; then :
-  withval=$with_cross_build; cross_buildroot="${withval}"
-else
-  cross_buildroot=""
-fi
-
-
-if test "X$cross_buildroot" = "X"; then
-    if test "$cross_compiling" = "yes"; then
-        as_fn_error $? "Error! Cross compiling but no --with-cross-build option specified - please supply the path to an executable ICU's build root" "$LINENO" 5
-	    fi
-else
-    if test -f "${cross_buildroot}/config/icucross.mk"; then
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: Using cross buildroot: $cross_buildroot" >&5
-$as_echo "Using cross buildroot: $cross_buildroot" >&6; }
-    else
-        if test -d "${cross_buildroot}"; then
-            as_fn_error $? "${cross_buildroot}/config/icucross.mk not found. Please build ICU in ${cross_buildroot} first." "$LINENO" 5
-        else
-            as_fn_error $? "No such directory ${cross_buildroot} supplied as the argument to --with-cross-build. Use an absolute path." "$LINENO" 5
-        fi
-    fi
-fi
-
-
-# Check for doxygen to generate documentation
-# Extract the first word of "doxygen", so it can be a program name with args.
-set dummy doxygen; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_path_DOXYGEN+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  case $DOXYGEN in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_DOXYGEN="$DOXYGEN" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-as_dummy="$PATH:/usr/local/bin:/usr/bin"
-for as_dir in $as_dummy
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_DOXYGEN="$as_dir/$ac_word$ac_exec_ext"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  ;;
-esac
-fi
-DOXYGEN=$ac_cv_path_DOXYGEN
-if test -n "$DOXYGEN"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $DOXYGEN" >&5
-$as_echo "$DOXYGEN" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-
-# Check that the linker is usable
-
-case "${host}" in
-    *-*-cygwin*|*-*-mingw*)
-        if test "$GCC" != yes && test -n "`link --version 2>&1 | grep 'GNU coreutils'`"; then
-            as_fn_error $? "link.exe is not a valid linker. Your PATH is incorrect.
-                  Please follow the directions in ICU's readme." "$LINENO" 5
-        fi;;
-    *);;
-esac
-
-# Determine the executable suffix
-# We don't use AC_EXEEXT because some compilers output separate debugging
-# files, which confuses the AC_EXEEXT macro.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking checking for executable suffix" >&5
-$as_echo_n "checking checking for executable suffix... " >&6; }
-case "${host}" in
-    *-*-cygwin*|*-*-mingw*)  EXEEXT=.exe ;;
-    *)      EXEEXT="" ;;
-esac
-ac_exeext=$EXEEXT
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $EXEEXT" >&5
-$as_echo "$EXEEXT" >&6; }
-
-
-# Determine how strict we want to be when compiling
-
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether strict compiling is on" >&5
-$as_echo_n "checking whether strict compiling is on... " >&6; }
-    # Check whether --enable-strict was given.
-if test "${enable_strict+set}" = set; then :
-  enableval=$enable_strict;
-        if test "$enableval" = no
-        then
-            ac_use_strict_options=no
-        else
-            ac_use_strict_options=yes
-        fi
-
-else
-  ac_use_strict_options=yes
-fi
-
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_use_strict_options" >&5
-$as_echo "$ac_use_strict_options" >&6; }
-
-    if test "$ac_use_strict_options" = yes
-    then
-        if test "$GCC" = yes
-        then
-            case "${host}" in
-            *)
-                # Do not use -ansi. It limits us to C90, and it breaks some platforms.
-                # We use -std=c99 to disable the gnu99 defaults and its associated warnings
-                CFLAGS="$CFLAGS -std=c99"
-                ;;
-            esac
-
-            CFLAGS="$CFLAGS -Wall -pedantic -Wshadow -Wpointer-arith -Wmissing-prototypes -Wwrite-strings"
-        else
-            case "${host}" in
-            *-*-cygwin)
-                if test "`$CC /help 2>&1 | head -c9`" = "Microsoft"
-                then
-                    CFLAGS="$CFLAGS /W4"
-                fi ;;
-            *-*-mingw*)
-                CFLAGS="$CFLAGS -W4" ;;
-            esac
-        fi
-        if test "$GXX" = yes
-        then
-            CXXFLAGS="$CXXFLAGS -W -Wall -pedantic -Wpointer-arith -Wwrite-strings -Wno-long-long"
-        else
-            case "${host}" in
-            *-*-cygwin)
-                if test "`$CXX /help 2>&1 | head -c9`" = "Microsoft"
-                then
-                    CXXFLAGS="$CXXFLAGS /W4"
-                fi ;;
-            *-*-mingw*)
-                CFLAGS="$CFLAGS -W4" ;;
-            esac
-        fi
-    fi
-
-
-# Check if we can build and use 64-bit libraries
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for grep that handles long lines and -e" >&5
-$as_echo_n "checking for grep that handles long lines and -e... " >&6; }
-if ${ac_cv_path_GREP+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -z "$GREP"; then
-  ac_path_GREP_found=false
-  # Loop through the user's path and test for each of PROGNAME-LIST
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_prog in grep ggrep; do
-    for ac_exec_ext in '' $ac_executable_extensions; do
-      ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
-      as_fn_executable_p "$ac_path_GREP" || continue
-# Check for GNU ac_path_GREP and select it if it is found.
-  # Check for GNU $ac_path_GREP
-case `"$ac_path_GREP" --version 2>&1` in
-*GNU*)
-  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
-*)
-  ac_count=0
-  $as_echo_n 0123456789 >"conftest.in"
-  while :
-  do
-    cat "conftest.in" "conftest.in" >"conftest.tmp"
-    mv "conftest.tmp" "conftest.in"
-    cp "conftest.in" "conftest.nl"
-    $as_echo 'GREP' >> "conftest.nl"
-    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
-    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
-    as_fn_arith $ac_count + 1 && ac_count=$as_val
-    if test $ac_count -gt ${ac_path_GREP_max-0}; then
-      # Best one so far, save it but keep looking for a better one
-      ac_cv_path_GREP="$ac_path_GREP"
-      ac_path_GREP_max=$ac_count
-    fi
-    # 10*(2^10) chars as input seems more than enough
-    test $ac_count -gt 10 && break
-  done
-  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
-esac
-
-      $ac_path_GREP_found && break 3
-    done
-  done
-  done
-IFS=$as_save_IFS
-  if test -z "$ac_cv_path_GREP"; then
-    as_fn_error $? "no acceptable grep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
-  fi
-else
-  ac_cv_path_GREP=$GREP
-fi
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_GREP" >&5
-$as_echo "$ac_cv_path_GREP" >&6; }
- GREP="$ac_cv_path_GREP"
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for egrep" >&5
-$as_echo_n "checking for egrep... " >&6; }
-if ${ac_cv_path_EGREP+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
-   then ac_cv_path_EGREP="$GREP -E"
-   else
-     if test -z "$EGREP"; then
-  ac_path_EGREP_found=false
-  # Loop through the user's path and test for each of PROGNAME-LIST
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_prog in egrep; do
-    for ac_exec_ext in '' $ac_executable_extensions; do
-      ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
-      as_fn_executable_p "$ac_path_EGREP" || continue
-# Check for GNU ac_path_EGREP and select it if it is found.
-  # Check for GNU $ac_path_EGREP
-case `"$ac_path_EGREP" --version 2>&1` in
-*GNU*)
-  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
-*)
-  ac_count=0
-  $as_echo_n 0123456789 >"conftest.in"
-  while :
-  do
-    cat "conftest.in" "conftest.in" >"conftest.tmp"
-    mv "conftest.tmp" "conftest.in"
-    cp "conftest.in" "conftest.nl"
-    $as_echo 'EGREP' >> "conftest.nl"
-    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
-    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
-    as_fn_arith $ac_count + 1 && ac_count=$as_val
-    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
-      # Best one so far, save it but keep looking for a better one
-      ac_cv_path_EGREP="$ac_path_EGREP"
-      ac_path_EGREP_max=$ac_count
-    fi
-    # 10*(2^10) chars as input seems more than enough
-    test $ac_count -gt 10 && break
-  done
-  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
-esac
-
-      $ac_path_EGREP_found && break 3
-    done
-  done
-  done
-IFS=$as_save_IFS
-  if test -z "$ac_cv_path_EGREP"; then
-    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
-  fi
-else
-  ac_cv_path_EGREP=$EGREP
-fi
-
-   fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP" >&5
-$as_echo "$ac_cv_path_EGREP" >&6; }
- EGREP="$ac_cv_path_EGREP"
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for ANSI C header files" >&5
-$as_echo_n "checking for ANSI C header files... " >&6; }
-if ${ac_cv_header_stdc+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdlib.h>
-#include <stdarg.h>
-#include <string.h>
-#include <float.h>
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_header_stdc=yes
-else
-  ac_cv_header_stdc=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-if test $ac_cv_header_stdc = yes; then
-  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <string.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "memchr" >/dev/null 2>&1; then :
-
-else
-  ac_cv_header_stdc=no
-fi
-rm -f conftest*
-
-fi
-
-if test $ac_cv_header_stdc = yes; then
-  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdlib.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "free" >/dev/null 2>&1; then :
-
-else
-  ac_cv_header_stdc=no
-fi
-rm -f conftest*
-
-fi
-
-if test $ac_cv_header_stdc = yes; then
-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
-  if test "$cross_compiling" = yes; then :
-  :
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <ctype.h>
-#include <stdlib.h>
-#if ((' ' & 0x0FF) == 0x020)
-# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
-# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
-#else
-# define ISLOWER(c) \
-		   (('a' <= (c) && (c) <= 'i') \
-		     || ('j' <= (c) && (c) <= 'r') \
-		     || ('s' <= (c) && (c) <= 'z'))
-# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
-#endif
-
-#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
-int
-main ()
-{
-  int i;
-  for (i = 0; i < 256; i++)
-    if (XOR (islower (i), ISLOWER (i))
-	|| toupper (i) != TOUPPER (i))
-      return 2;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-
-else
-  ac_cv_header_stdc=no
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_stdc" >&5
-$as_echo "$ac_cv_header_stdc" >&6; }
-if test $ac_cv_header_stdc = yes; then
-
-$as_echo "#define STDC_HEADERS 1" >>confdefs.h
-
-fi
-
-# On IRIX 5.3, sys/types and inttypes.h are conflicting.
-for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
-		  inttypes.h stdint.h unistd.h
-do :
-  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
-ac_fn_c_check_header_compile "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default
-"
-if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
-  cat >>confdefs.h <<_ACEOF
-#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
-done
-
-
-
-    BITS_REQ=nochange
-    ENABLE_64BIT_LIBS=unknown
-    ## revisit this for cross-compile.
-
-    # Check whether --enable-64bit-libs was given.
-if test "${enable_64bit_libs+set}" = set; then :
-  enableval=$enable_64bit_libs; echo "note, use --with-library-bits instead of --*-64bit-libs"
-         case "${enableval}" in
-            no|false|32) with_library_bits=32;  ;;
-            yes|true|64) with_library_bits=64else32 ;;
-            nochange) with_library_bits=nochange; ;;
-            *) as_fn_error $? "bad value ${enableval} for '--*-64bit-libs'" "$LINENO" 5 ;;
-            esac
-fi
-
-
-
-
-# Check whether --with-library-bits was given.
-if test "${with_library_bits+set}" = set; then :
-  withval=$with_library_bits; case "${withval}" in
-            ""|nochange) BITS_REQ=$withval ;;
-            32|64|64else32) BITS_REQ=$withval ;;
-            *) as_fn_error $? "bad value ${withval} for --with-library-bits" "$LINENO" 5 ;;
-            esac
-fi
-
-
-    # don't use these for cross compiling
-    if test "$cross_compiling" = "yes" -a "${BITS_REQ}" != "nochange"; then
-        as_fn_error $? "Don't specify bitness when cross compiling. See readme.html for help with cross compilation., and set compiler options manually." "$LINENO" 5
-    fi
-    # The cast to long int works around a bug in the HP C Compiler
-# version HP92453-01 B.11.11.23709.GP, which incorrectly rejects
-# declarations like `int a3[[(sizeof (unsigned char)) >= 0]];'.
-# This bug is HP SR number 8606223364.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking size of void *" >&5
-$as_echo_n "checking size of void *... " >&6; }
-if ${ac_cv_sizeof_void_p+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if ac_fn_c_compute_int "$LINENO" "(long int) (sizeof (void *))" "ac_cv_sizeof_void_p"        "$ac_includes_default"; then :
-
-else
-  if test "$ac_cv_type_void_p" = yes; then
-     { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "cannot compute sizeof (void *)
-See \`config.log' for more details" "$LINENO" 5; }
-   else
-     ac_cv_sizeof_void_p=0
-   fi
-fi
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sizeof_void_p" >&5
-$as_echo "$ac_cv_sizeof_void_p" >&6; }
-
-
-
-cat >>confdefs.h <<_ACEOF
-#define SIZEOF_VOID_P $ac_cv_sizeof_void_p
-_ACEOF
-
-
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether runnable 64 bit binaries are built by default" >&5
-$as_echo_n "checking whether runnable 64 bit binaries are built by default... " >&6; }
-    case $ac_cv_sizeof_void_p in
-        8) DEFAULT_64BIT=yes ;;
-        4) DEFAULT_64BIT=no ;;
-        *) DEFAULT_64BIT=unknown
-    esac
-    BITS_GOT=unknown
-
-    # 'OK' here means, we can exit any further checking, everything's copa
-    BITS_OK=yes
-
-    # do we need to check for buildable/runnable 32 or 64 bit?
-    BITS_CHECK_32=no
-    BITS_CHECK_64=no
-
-    # later, can we run the 32/64 bit binaries so made?
-    BITS_RUN_32=no
-    BITS_RUN_64=no
-
-    if test "$DEFAULT_64BIT" = "yes"; then
-        # we get 64 bits by default.
-        BITS_GOT=64
-        case "$BITS_REQ" in
-            32)
-                # need to look for 32 bit support.
-                BITS_CHECK_32=yes
-                # not copa.
-                BITS_OK=no;;
-            # everyone else is happy.
-            nochange) ;;
-            *) ;;
-        esac
-    elif test "$DEFAULT_64BIT" = "no"; then
-        # not 64 bit by default.
-        BITS_GOT=32
-        case "$BITS_REQ" in
-            64|64else32)
-                BITS_CHECK_64=yes
-                #BITS_CHECK_32=yes
-                BITS_OK=no;;
-            nochange) ;;
-            *) ;;
-        esac
-    elif test "$DEFAULT_64BIT" = "unknown"; then
-        # cross compiling.
-        BITS_GOT=unknown
-        case "$BITS_REQ" in
-            64|64else32) BITS_OK=no
-            BITS_CHECK_32=yes
-            BITS_CHECK_64=yes ;;
-            32) BITS_OK=no;;
-            nochange) ;;
-            *) ;;
-        esac
-    fi
-
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $DEFAULT_64BIT" >&5
-$as_echo "$DEFAULT_64BIT" >&6; };
-
-    if test "$BITS_OK" != "yes"; then
-        # not copa. back these up.
-        CFLAGS_OLD="${CFLAGS}"
-        CXXFLAGS_OLD="${CXXFLAGS}"
-        LDFLAGS_OLD="${LDFLAGS}"
-        ARFLAGS_OLD="${ARFLAGS}"
-
-        CFLAGS_32="${CFLAGS}"
-        CXXFLAGS_32="${CXXFLAGS}"
-        LDFLAGS_32="${LDFLAGS}"
-        ARFLAGS_32="${ARFLAGS}"
-
-        CFLAGS_64="${CFLAGS}"
-        CXXFLAGS_64="${CXXFLAGS}"
-        LDFLAGS_64="${LDFLAGS}"
-        ARFLAGS_64="${ARFLAGS}"
-
-        CAN_BUILD_64=unknown
-        CAN_BUILD_32=unknown
-        # These results can't be cached because is sets compiler flags.
-        if test "$BITS_CHECK_64" = "yes"; then
-            { $as_echo "$as_me:${as_lineno-$LINENO}: checking how to build 64-bit executables" >&5
-$as_echo_n "checking how to build 64-bit executables... " >&6; }
-            CAN_BUILD_64=no
-            ####
-            # Find out if we think we can *build* for 64 bit. Doesn't check whether we can run it.
-            #  Note, we don't have to actually check if the options work- we'll try them before using them.
-            #  So, only try actually testing the options, if you are trying to decide between multiple options.
-            # On exit from the following clauses:
-            # if CAN_BUILD_64=yes:
-            #    *FLAGS are assumed to contain the right settings for 64bit
-            # else if CAN_BUILD_64=no: (default)
-            #    *FLAGS are assumed to be trashed, and will be reset from *FLAGS_OLD
-
-            if test "$GCC" = yes; then
-                CFLAGS="${CFLAGS} -m64"
-                CXXFLAGS="${CXXFLAGS} -m64"
-                cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-            else
-                case "${host}" in
-                sparc*-*-solaris*)
-                    # 1. try -m64
-                    CFLAGS="${CFLAGS} -m64"
-                    CXXFLAGS="${CXXFLAGS} -m64"
-                    if test "$cross_compiling" = yes; then :
-  CAN_BUILD_64=unknown
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-                    if test "$CAN_BUILD_64" != yes; then
-                        # Nope. back out changes.
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # 2. try xarch=v9 [deprecated]
-                        ## TODO: cross compile: the following won't work.
-                        SPARCV9=`isainfo -n 2>&1 | grep sparcv9`
-                        SOL64=`$CXX -xarch=v9 2>&1 && $CC -xarch=v9 2>&1 | grep -v usage:`
-                        # "Warning: -xarch=v9 is deprecated, use -m64 to create 64-bit programs"
-                        if test -z "$SOL64" && test -n "$SPARCV9"; then
-                            CFLAGS="${CFLAGS} -xtarget=ultra -xarch=v9"
-                            CXXFLAGS="${CXXFLAGS} -xtarget=ultra -xarch=v9"
-                            LDFLAGS="${LDFLAGS} -xtarget=ultra -xarch=v9"
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                i386-*-solaris*)
-                    # 1. try -m64
-                    CFLAGS="${CFLAGS} -m64"
-                    CXXFLAGS="${CXXFLAGS} -m64"
-                    if test "$cross_compiling" = yes; then :
-  CAN_BUILD_64=unknown
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-                    if test "$CAN_BUILD_64" != yes; then
-                        # Nope. back out changes.
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # 2. try the older compiler option
-                        ## TODO: cross compile problem
-                        AMD64=`isainfo -n 2>&1 | grep amd64`
-                        SOL64=`$CXX -xtarget=generic64 2>&1 && $CC -xtarget=generic64 2>&1 | grep -v usage:`
-                        if test -z "$SOL64" && test -n "$AMD64"; then
-                            CFLAGS="${CFLAGS} -xtarget=generic64"
-                            CXXFLAGS="${CXXFLAGS} -xtarget=generic64"
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                ia64-*-linux*)
-                    # check for ecc/ecpc compiler support
-                    ## TODO: cross compiler problem
-                    if test -n "`$CXX --help 2>&1 && $CC --help 2>&1 | grep -v Intel`"; then
-                        if test -n "`$CXX --help 2>&1 && $CC --help 2>&1 | grep -v Itanium`"; then
-                            CAN_BUILD_64=yes
-                        fi
-                    fi
-                    ;;
-                *-*-cygwin)
-                    # vcvarsamd64.bat should have been used to enable 64-bit builds.
-                    # We only do this check to display the correct answer.
-                    ## TODO: cross compiler problem
-                    if test -n "`$CXX -help 2>&1 | grep 'for x64'`"; then
-                        CAN_BUILD_64=yes
-                    fi
-                    ;;
-                *-*-aix*|powerpc64-*-linux*)
-                    CFLAGS="${CFLAGS} -q64"
-                    CXXFLAGS="${CXXFLAGS} -q64"
-                    LDFLAGS="${LDFLAGS} -q64"
-                    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-                    if test "$CAN_BUILD_64" = yes; then
-                        # worked- set other options.
-                        case "${host}" in
-                        *-*-aix*)
-                            # tell AIX what executable mode to use.
-                            ARFLAGS="${ARFLAGS} -X64"
-                        esac
-                    fi
-                    ;;
-                *-*-hpux*)
-                    # First we try the newer +DD64, if that doesn't work,
-                    # try other options.
-
-                    CFLAGS="${CFLAGS} +DD64"
-                    CXXFLAGS="${CXXFLAGS} +DD64"
-                    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-                    if test "$CAN_BUILD_64" != yes; then
-                        # reset
-                        CFLAGS="${CFLAGS_OLD}"
-                        CXXFLAGS="${CXXFLAGS_OLD}"
-                        # append
-                        CFLAGS="${CFLAGS} +DA2.0W"
-                        CXXFLAGS="${CXXFLAGS} +DA2.0W"
-                        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-                    fi
-                    ;;
-                *-*ibm-openedition*|*-*-os390*)
-                    CFLAGS="${CFLAGS} -Wc,lp64"
-                    CXXFLAGS="${CXXFLAGS} -Wc,lp64"
-                    LDFLAGS="${LDFLAGS} -Wl,lp64"
-                    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_64=yes
-else
-  CAN_BUILD_64=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-                    ;;
-                *)
-                    # unknown platform.
-                    ;;
-                esac
-            fi
-            { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CAN_BUILD_64" >&5
-$as_echo "$CAN_BUILD_64" >&6; }
-            if test "$CAN_BUILD_64" = yes; then
-                { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether runnable 64-bit binaries are being built " >&5
-$as_echo_n "checking whether runnable 64-bit binaries are being built ... " >&6; }
-                if test "$cross_compiling" = yes; then :
-  BITS_RUN_64=unknown
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==64)?0:1;}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  BITS_RUN_64=yes
-else
-  BITS_RUN_64=no
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-                { $as_echo "$as_me:${as_lineno-$LINENO}: result: $BITS_RUN_64" >&5
-$as_echo "$BITS_RUN_64" >&6; };
-
-                CFLAGS_64="${CFLAGS}"
-                CXXFLAGS_64="${CXXFLAGS}"
-                LDFLAGS_64="${LDFLAGS}"
-                ARFLAGS_64="${ARFLAGS}"
-            fi
-            # put it back.
-            CFLAGS="${CFLAGS_OLD}"
-            CXXFLAGS="${CXXFLAGS_OLD}"
-            LDFLAGS="${LDFLAGS_OLD}"
-            ARFLAGS="${ARFLAGS_OLD}"
-        fi
-        if test "$BITS_CHECK_32" = "yes"; then
-            # see comment under 'if BITS_CHECK_64', above.
-            { $as_echo "$as_me:${as_lineno-$LINENO}: checking how to build 32-bit executables" >&5
-$as_echo_n "checking how to build 32-bit executables... " >&6; }
-            if test "$GCC" = yes; then
-                CFLAGS="${CFLAGS} -m32"
-                CXXFLAGS="${CXXFLAGS} -m32"
-                cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==32)?0:1;}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CAN_BUILD_32=yes
-else
-  CAN_BUILD_32=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-            fi
-            { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CAN_BUILD_32" >&5
-$as_echo "$CAN_BUILD_32" >&6; }
-            if test "$CAN_BUILD_32" = yes; then
-                { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether runnable 32-bit binaries are being built " >&5
-$as_echo_n "checking whether runnable 32-bit binaries are being built ... " >&6; }
-                if test "$cross_compiling" = yes; then :
-  BITS_RUN_32=unknown
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(void) {return (sizeof(void*)*8==32)?0:1;}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  BITS_RUN_32=yes
-else
-  BITS_RUN_32=no
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-                { $as_echo "$as_me:${as_lineno-$LINENO}: result: $BITS_RUN_32" >&5
-$as_echo "$BITS_RUN_32" >&6; };
-                CFLAGS_32="${CFLAGS}"
-                CXXFLAGS_32="${CXXFLAGS}"
-                LDFLAGS_32="${LDFLAGS}"
-                ARFLAGS_32="${ARFLAGS}"
-            fi
-            # put it back.
-            CFLAGS="${CFLAGS_OLD}"
-            CXXFLAGS="${CXXFLAGS_OLD}"
-            LDFLAGS="${LDFLAGS_OLD}"
-            ARFLAGS="${ARFLAGS_OLD}"
-        fi
-
-        ##
-        # OK. Now, we've tested for 32 and 64 bitness. Let's see what we'll do.
-        #
-
-        # First, implement 64else32
-        if test "$BITS_REQ" = "64else32"; then
-            if test "$BITS_RUN_64" = "yes"; then
-                BITS_REQ=64
-            else
-                # no changes.
-                BITS_OK=yes
-            fi
-        fi
-
-        # implement.
-        if test "$BITS_REQ" = "32" -a "$BITS_RUN_32" = "yes"; then
-            CFLAGS="${CFLAGS_32}"
-            CXXFLAGS="${CXXFLAGS_32}"
-            LDFLAGS="${LDFLAGS_32}"
-            ARFLAGS="${ARFLAGS_32}"
-            BITS_OK=yes
-        elif test "$BITS_REQ" = "64" -a "$BITS_RUN_64" = "yes"; then
-            CFLAGS="${CFLAGS_64}"
-            CXXFLAGS="${CXXFLAGS_64}"
-            LDFLAGS="${LDFLAGS_64}"
-            ARFLAGS="${ARFLAGS_64}"
-            BITS_OK=yes
-        elif test "$BITS_OK" != "yes"; then
-            as_fn_error $? "Requested $BITS_REQ bit binaries but could not compile and execute them. See readme.html for help with cross compilation., and set compiler options manually." "$LINENO" 5
-        fi
-     fi
-
-
-
-
-# Determine the Makefile fragment
-
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking which Makefile fragment to use for ${host}" >&5
-$as_echo_n "checking which Makefile fragment to use for ${host}... " >&6; }
-if ${icu_cv_host_frag+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-
-case "${host}" in
-*-*-solaris*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-solaris-gcc
-	else
-		icu_cv_host_frag=mh-solaris
-	fi ;;
-alpha*-*-linux-gnu)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-alpha-linux-gcc
-	else
-		icu_cv_host_frag=mh-alpha-linux-cc
-	fi ;;
-powerpc*-*-linux*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-linux
-	else
-		icu_cv_host_frag=mh-linux-va
-	fi ;;
-*-*-linux*|*-*-gnu|*-*-k*bsd*-gnu|*-*-kopensolaris*-gnu) icu_cv_host_frag=mh-linux ;;
-i[34567]86-*-cygwin)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-cygwin
-	else
-		icu_cv_host_frag=mh-cygwin-msvc
-	fi ;;
-x86_64-*-cygwin)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-cygwin64
-	else
-		icu_cv_host_frag=mh-cygwin-msvc
-	fi ;;
-*-*-mingw*)
-	if test "$GCC" = yes; then
-                cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-#ifndef __MINGW64__
-#error This is not MinGW64
-#endif
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  icu_cv_host_frag=mh-mingw64
-else
-  icu_cv_host_frag=mh-mingw
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-	else
-	        case "${host}" in
-		*-*-mingw*) icu_cv_host_frag=mh-msys-msvc ;;
-		*-*-cygwin) icu_cv_host_frag=mh-cygwin-msvc ;;
-		esac
-	fi ;;
-*-*-*bsd*|*-*-dragonfly*) 	icu_cv_host_frag=mh-bsd-gcc ;;
-*-*-aix*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-aix-gcc
-	else
-		icu_cv_host_frag=mh-aix-va
-	fi ;;
-*-*-hpux*)
-	if test "$GCC" = yes; then
-		icu_cv_host_frag=mh-hpux-gcc
-	else
-		case "$CXX" in
-		*aCC)    icu_cv_host_frag=mh-hpux-acc ;;
-		esac
-	fi ;;
-*-*ibm-openedition*|*-*-os390*)	icu_cv_host_frag=mh-os390 ;;
-*-*-os400*)	icu_cv_host_frag=mh-os400 ;;
-*-apple-rhapsody*)	icu_cv_host_frag=mh-darwin ;;
-*-apple-darwin*)	icu_cv_host_frag=mh-darwin ;;
-*-*-beos)       icu_cv_host_frag=mh-beos ;;
-*-*-haiku)      icu_cv_host_frag=mh-haiku ;;
-*-*-irix*)	icu_cv_host_frag=mh-irix ;;
-*-dec-osf*) icu_cv_host_frag=mh-alpha-osf ;;
-*-*-nto*)	icu_cv_host_frag=mh-qnx ;;
-*-ncr-*)	icu_cv_host_frag=mh-mpras ;;
-*) 		icu_cv_host_frag=mh-unknown ;;
-esac
-
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $icu_cv_host_frag" >&5
-$as_echo "$icu_cv_host_frag" >&6; }
-
-
-# Checks for libraries and other host specific stuff
-# On HP/UX, don't link to -lm from a shared lib because it isn't
-#  PIC (at least on 10.2)
-case "${host}" in
-	*-*-hpux*) 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for floor in -lm" >&5
-$as_echo_n "checking for floor in -lm... " >&6; }
-if ${ac_cv_lib_m_floor+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lm  $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char floor ();
-int
-main ()
-{
-return floor ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_m_floor=yes
-else
-  ac_cv_lib_m_floor=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_m_floor" >&5
-$as_echo "$ac_cv_lib_m_floor" >&6; }
-if test "x$ac_cv_lib_m_floor" = xyes; then :
-  LIB_M="-lm"
-fi
- ;;
-
-	*) 		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for floor in -lm" >&5
-$as_echo_n "checking for floor in -lm... " >&6; }
-if ${ac_cv_lib_m_floor+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lm  $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char floor ();
-int
-main ()
-{
-return floor ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_m_floor=yes
-else
-  ac_cv_lib_m_floor=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_m_floor" >&5
-$as_echo "$ac_cv_lib_m_floor" >&6; }
-if test "x$ac_cv_lib_m_floor" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBM 1
-_ACEOF
-
-  LIBS="-lm $LIBS"
-
-fi
-
-			LIB_M="" ;;
-esac
-
-
-# Check whether to build shared libraries
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to build shared libraries" >&5
-$as_echo_n "checking whether to build shared libraries... " >&6; }
-enabled=no
-# Check whether --enable-shared was given.
-if test "${enable_shared+set}" = set; then :
-  enableval=$enable_shared;  case "${enableval}" in
-	     yes|"") enabled=yes; ENABLE_SHARED=YES ;;
-	     no);;
-	     *) ;;
-    esac
-else
-  enabled=yes; ENABLE_SHARED=YES
-
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# Check whether to build static libraries
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to build static libraries" >&5
-$as_echo_n "checking whether to build static libraries... " >&6; }
-enabled=no
-# Check whether --enable-static was given.
-if test "${enable_static+set}" = set; then :
-  enableval=$enable_static;  case "${enableval}" in
-	     yes|"") enabled=yes; ENABLE_STATIC=YES ;;
-	     no) ;;
-	     *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# When building release static library, there might be some optimization flags we can use
-if test "$ENABLE_STATIC" = "YES"; then
-    if test "$ENABLE_SHARED" != "YES"; then
-        if test "$ENABLE_RELEASE" = 1; then
-            { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we can use static library optimization option" >&5
-$as_echo_n "checking whether we can use static library optimization option... " >&6; }
-            CHECK_STATIC_OPT_FLAG=no
-
-            OLD_CPPFLAGS="${CPPFLAGS}"
-            OLD_LDFLAGS="${LDFLAGS}"
-
-            case "${host}" in
-            *-linux*|i*86-*-*bsd*|i*86-pc-gnu)
-                if test "$GCC" = yes; then
-                    CPPFLAGS="${CPPFLAGS} -ffunction-sections -fdata-sections"
-                    LDFLAGS="${LDFLAGS} -Wl,--gc-sections"
-                fi
-                ;;
-            *)
-                ;;
-            esac
-
-            cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  CHECK_STATIC_OPT_FLAG=yes
-else
-  CHECK_STATIC_OPT_FLAG=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-            { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CHECK_STATIC_OPT_FLAG" >&5
-$as_echo "$CHECK_STATIC_OPT_FLAG" >&6; }
-            if test "$CHECK_STATIC_OPT_FLAG" = no; then
-                CPPFLAGS="${OLD_CPPFLAGS}"
-                LDFLAGS="${OLD_LDFLAGS}"
-            fi
-        fi
-    fi
-fi
-
-
-# Check whether to enable auto cleanup of libraries
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to enable auto cleanup of libraries" >&5
-$as_echo_n "checking whether to enable auto cleanup of libraries... " >&6; }
-enabled=no
-UCLN_NO_AUTO_CLEANUP=1
-# Check whether --enable-auto-cleanup was given.
-if test "${enable_auto_cleanup+set}" = set; then :
-  enableval=$enable_auto_cleanup;  case "${enableval}" in
-         yes) enabled=yes;
-         CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DUCLN_NO_AUTO_CLEANUP=0";
-         UCLN_NO_AUTO_CLEANUP=0
-          ;;
-         *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# MSVC floating-point option
-MSVC_RELEASE_FLAG=""
-if test $enabled = yes
-then
-    if test $icu_cv_host_frag = mh-cygwin-msvc -o $icu_cv_host_frag = mh-msys-msvc
-    then
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-    #if defined _MSC_VER && _MSC_VER >= 1400
-    #else
-    Microsoft Visual C++ < 2005
-    #endif
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  MSVC_RELEASE_FLAG="/fp:precise"
-else
-  MSVC_RELEASE_FLAG="/Op"
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-
-        CFLAGS="${CFLAGS} ${MSVC_RELEASE_FLAG}"
-        CXXFLAGS="${CXXFLAGS} ${MSVC_RELEASE_FLAG}"
-    fi
-fi
-
-# Check whether to enabled draft APIs
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to enable draft APIs" >&5
-$as_echo_n "checking whether to enable draft APIs... " >&6; }
-enabled=yes
-U_DEFAULT_SHOW_DRAFT=1
-# Check whether --enable-draft was given.
-if test "${enable_draft+set}" = set; then :
-  enableval=$enable_draft;  case "${enableval}" in
-         no) enabled=no; U_DEFAULT_SHOW_DRAFT=0;
-         CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_DEFAULT_SHOW_DRAFT=0"
-          ;;
-         *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-# Make sure that we can use draft API in ICU.
-if test "$U_DEFAULT_SHOW_DRAFT" = 0; then
-    CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_SHOW_DRAFT_API"
-fi
-
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ranlib; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_RANLIB+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$RANLIB"; then
-  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-RANLIB=$ac_cv_prog_RANLIB
-if test -n "$RANLIB"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $RANLIB" >&5
-$as_echo "$RANLIB" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_RANLIB"; then
-  ac_ct_RANLIB=$RANLIB
-  # Extract the first word of "ranlib", so it can be a program name with args.
-set dummy ranlib; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_ac_ct_RANLIB+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_RANLIB"; then
-  ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_RANLIB="ranlib"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
-if test -n "$ac_ct_RANLIB"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_RANLIB" >&5
-$as_echo "$ac_ct_RANLIB" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_ct_RANLIB" = x; then
-    RANLIB=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    RANLIB=$ac_ct_RANLIB
-  fi
-else
-  RANLIB="$ac_cv_prog_RANLIB"
-fi
-
-
-# look for 'ar' the proper way
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ar; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_AR+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$AR"; then
-  ac_cv_prog_AR="$AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_AR="${ac_tool_prefix}ar"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-AR=$ac_cv_prog_AR
-if test -n "$AR"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $AR" >&5
-$as_echo "$AR" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_AR"; then
-  ac_ct_AR=$AR
-  # Extract the first word of "ar", so it can be a program name with args.
-set dummy ar; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_prog_ac_ct_AR+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if test -n "$ac_ct_AR"; then
-  ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_AR="ar"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_AR=$ac_cv_prog_ac_ct_AR
-if test -n "$ac_ct_AR"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_AR" >&5
-$as_echo "$ac_ct_AR" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-  if test "x$ac_ct_AR" = x; then
-    AR="false"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
-$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
-ac_tool_warned=yes ;;
-esac
-    AR=$ac_ct_AR
-  fi
-else
-  AR="$ac_cv_prog_AR"
-fi
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to enable renaming of symbols" >&5
-$as_echo_n "checking whether to enable renaming of symbols... " >&6; }
-enabled=yes
-U_DISABLE_RENAMING=0
-# Check whether --enable-renaming was given.
-if test "${enable_renaming+set}" = set; then :
-  enableval=$enable_renaming;  case "${enableval}" in
-	     yes|"") enabled=yes ;;
-	     no) enabled=no; U_DISABLE_RENAMING=1;
-             UCONFIG_CPPFLAGS="${UCONFIG_CPPFLAGS} -DU_DISABLE_RENAMING=1"
-              ;;
-	     *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to enable function and data tracing" >&5
-$as_echo_n "checking whether to enable function and data tracing... " >&6; }
-enabled=no
-U_ENABLE_TRACING=0
-# Check whether --enable-tracing was given.
-if test "${enable_tracing+set}" = set; then :
-  enableval=$enable_tracing;  case "${enableval}" in
-	     yes|"") enabled=yes;
-                     CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_ENABLE_TRACING=1";
-                     U_ENABLE_TRACING=1 ;;
-	     no) enabled=no; U_ENABLE_TRACING=0 ;;
-	     *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enabled" >&5
-$as_echo "$enabled" >&6; }
-
-
-# check if elf.h is present.
-for ac_header in elf.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "elf.h" "ac_cv_header_elf_h" "$ac_includes_default"
-if test "x$ac_cv_header_elf_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_ELF_H 1
-_ACEOF
-
-fi
-
-done
-
-if test "x$ac_cv_header_elf_h" = "xyes"; then
-    CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_HAVE_ELF_H=1";
-fi
-
-# Enable/disable plugins
-# Check whether --enable-plugins was given.
-if test "${enable_plugins+set}" = set; then :
-  enableval=$enable_plugins; case "${enableval}" in
-		yes) plugins=true ;;
-		no)  plugins=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-plugins" "$LINENO" 5 ;;
-		esac
-else
-  plugins=false
-fi
-
-
-
-if test "$plugins" = true; then
-  PLUGINS_TRUE=
-  U_HAVE_PLUGINS=1
-else
-  PLUGINS_TRUE='#'
-  U_HAVE_PLUGINS=0
-fi
-
-if test "x$plugins" = "xtrue"; then
-   UCONFIG_CPPFLAGS="$UCONFIG_CPPFLAGS -DUCONFIG_ENABLE_PLUGINS=1"
-fi
-
-
-U_ENABLE_DYLOAD=1
-enable=yes
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether to enable dynamic loading of plugins. Ignored if plugins disabled." >&5
-$as_echo_n "checking whether to enable dynamic loading of plugins. Ignored if plugins disabled.... " >&6; }
-# Check whether --enable-dyload was given.
-if test "${enable_dyload+set}" = set; then :
-  enableval=$enable_dyload;  case "${enableval}" in
-	     yes|"")
-		     U_ENABLE_DYLOAD=1
-                     enable=yes
-                     ;;
-	     no)
-	     	 U_ENABLE_DYLOAD=0;
-                 enable=no;
-                 CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DU_ENABLE_DYLOAD=0";
-                 ;;
-	     *) ;;
-    esac
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $enable" >&5
-$as_echo "$enable" >&6; }
-
-
-if test "$enable" = "yes"; then
-   for ac_header in dlfcn.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "dlfcn.h" "ac_cv_header_dlfcn_h" "$ac_includes_default"
-if test "x$ac_cv_header_dlfcn_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_DLFCN_H 1
-_ACEOF
-
-fi
-
-done
-
-   #AC_MSG_RESULT($enabled)
-   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for library containing dlopen" >&5
-$as_echo_n "checking for library containing dlopen... " >&6; }
-if ${ac_cv_search_dlopen+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_func_search_save_LIBS=$LIBS
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char dlopen ();
-int
-main ()
-{
-return dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-for ac_lib in '' dl; do
-  if test -z "$ac_lib"; then
-    ac_res="none required"
-  else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-  fi
-  if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_search_dlopen=$ac_res
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext
-  if ${ac_cv_search_dlopen+:} false; then :
-  break
-fi
-done
-if ${ac_cv_search_dlopen+:} false; then :
-
-else
-  ac_cv_search_dlopen=no
-fi
-rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_dlopen" >&5
-$as_echo "$ac_cv_search_dlopen" >&6; }
-ac_res=$ac_cv_search_dlopen
-if test "$ac_res" != no; then :
-  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
-
-fi
-
-   for ac_func in dlopen
-do :
-  ac_fn_c_check_func "$LINENO" "dlopen" "ac_cv_func_dlopen"
-if test "x$ac_cv_func_dlopen" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_DLOPEN 1
-_ACEOF
-
-fi
-done
-
-
-   if test "x$ac_cv_func_dlopen" != xyes; then
-      CONFIG_CPPFLAGS="$CONFIG_CPPFLAGS -DHAVE_DLOPEN=0"
-   fi
-fi
-
-# Check for miscellanous functions.
-# So, use for putil / tools only.
-# Note that this will generate HAVE_GETTIMEOFDAY, not U_HAVE_GETTIMEOFDAY
-for ac_func in gettimeofday
-do :
-  ac_fn_c_check_func "$LINENO" "gettimeofday" "ac_cv_func_gettimeofday"
-if test "x$ac_cv_func_gettimeofday" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_GETTIMEOFDAY 1
-_ACEOF
-
-fi
-done
-
-
-
-# Check whether to use the evil rpath or not
-# Check whether --enable-rpath was given.
-if test "${enable_rpath+set}" = set; then :
-  enableval=$enable_rpath;  case "${enableval}" in
-	     yes|"") ENABLE_RPATH=YES ;;
-	     no) ;;
-	     *) ;;
-    esac
-else
-  ENABLE_RPATH=NO
-
-fi
-
-
-
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if we have a C++ compiler" >&5
-$as_echo_n "checking if we have a C++ compiler... " >&6; }
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  cxx_okay=yes
-else
-  cxx_okay=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-if test $cxx_okay = yes
-then
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: Good" >&5
-$as_echo "Good" >&6; }
-else
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-	as_fn_error $? "C++ compiler $CXX does not work or no compiler found" "$LINENO" 5
-fi
-
-if [ "$GXX" = yes ]; then
-    # if CXXFLAGS does not have a "-std=" setting, set it now to -std=c++0x,
-    # and check that the compiler still works.
-    if ! echo "$CXXFLAGS" | grep '\-std=' >/dev/null 2>&1; then
-        OLD_CXXFLAGS="${CXXFLAGS}"
-        CXXFLAGS="$CXXFLAGS --std=c++0x"
-        { $as_echo "$as_me:${as_lineno-$LINENO}: checking if we have a C++11 compiler" >&5
-$as_echo_n "checking if we have a C++11 compiler... " >&6; }
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  cxx11_okay=yes
-else
-  cxx11_okay=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: $cxx11_okay" >&5
-$as_echo "$cxx11_okay" >&6; }
-        if [ $cxx11_okay = yes ]; then
-            { $as_echo "$as_me:${as_lineno-$LINENO}: Adding CXXFLAGS option --std=c++0x" >&5
-$as_echo "$as_me: Adding CXXFLAGS option --std=c++0x" >&6;}
-            UCONFIG_CXXFLAGS="${UCONFIG_CXXFLAGS} --std=c++0x"
-        else
-            CXXFLAGS="$OLD_CXXFLAGS"
-        fi
-    fi
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if #include <string> works" >&5
-$as_echo_n "checking if #include <string> works... " >&6; }
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <string>
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_header_stdstring=yes
-else
-  ac_cv_header_stdstring=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_stdstring" >&5
-$as_echo "$ac_cv_header_stdstring" >&6; }
-if test $ac_cv_header_stdstring = yes
-then
-	U_HAVE_STD_STRING=1
-else
-        U_HAVE_STD_STRING=0
-        CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_STD_STRING=0"
-fi
-
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if #include <atomic> works" >&5
-$as_echo_n "checking if #include <atomic> works... " >&6; }
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <atomic>
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  ac_cv_header_atomic=yes
-else
-  ac_cv_header_atomic=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_atomic" >&5
-$as_echo "$ac_cv_header_atomic" >&6; }
-if test $ac_cv_header_atomic = yes
-then
-	U_HAVE_ATOMIC=1
-else
-        U_HAVE_ATOMIC=0
-fi
-# Make this available via CPPFLAGS
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_ATOMIC=${U_HAVE_ATOMIC}"
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-# Always build ICU with multi-threading support.
-OLD_LIBS=${LIBS}
-
-# For Compaq Tru64 (OSF1), we must look for pthread_attr_init
-# and must do this before seaching for pthread_mutex_destroy, or
-# we will pick up libpthreads.so not libpthread.so
-# If this fails, then we must test for HPUX specials, before
-# moving on to a more generic test
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_attr_init in -lpthread" >&5
-$as_echo_n "checking for pthread_attr_init in -lpthread... " >&6; }
-if ${ac_cv_lib_pthread_pthread_attr_init+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char pthread_attr_init ();
-int
-main ()
-{
-return pthread_attr_init ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_pthread_pthread_attr_init=yes
-else
-  ac_cv_lib_pthread_pthread_attr_init=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_attr_init" >&5
-$as_echo "$ac_cv_lib_pthread_pthread_attr_init" >&6; }
-if test "x$ac_cv_lib_pthread_pthread_attr_init" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBPTHREAD 1
-_ACEOF
-
-  LIBS="-lpthread $LIBS"
-
-fi
-
-if test $ac_cv_lib_pthread_pthread_attr_init = yes; then
-  :
-else
-  # Locate the right library for POSIX threads. We look for the
-  # symbols in the libraries first, because on Solaris libc provides
-  # pthread_create but libpthread has the real code :(
-  # AIX uses libpthreads instead of libpthread, and HP/UX uses libpthread
-  # FreeBSD users may need libpthread if they do not have libc_r.
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for library containing pthread_mutex_destroy" >&5
-$as_echo_n "checking for library containing pthread_mutex_destroy... " >&6; }
-if ${ac_cv_search_pthread_mutex_destroy+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_func_search_save_LIBS="$LIBS"
-ac_cv_search_pthread_mutex_destroy="no"
-for i in pthread pthreads c_r ; do
-LIBS="-l$i  $ac_func_search_save_LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char pthread_mutex_destroy ();
-int
-main ()
-{
-return pthread_mutex_destroy ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_search_pthread_mutex_destroy="-l$i"
-break
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-done
-if test "$ac_cv_search_pthread_mutex_destroy" = "no"; then
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char pthread_mutex_destroy ();
-int
-main ()
-{
-return pthread_mutex_destroy ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_search_pthread_mutex_destroy="none required"
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-LIBS="$ac_func_search_save_LIBS"
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_pthread_mutex_destroy" >&5
-$as_echo "$ac_cv_search_pthread_mutex_destroy" >&6; }
-if test "$ac_cv_search_pthread_mutex_destroy" != "no"; then
-  test "$ac_cv_search_pthread_mutex_destroy" = "none required" || LIBS="$ac_cv_search_pthread_mutex_destroy $LIBS"
-
-else :
-
-fi
-
-  if test "$ac_cv_search_pthread_mutex_destroy" != no; then
-    :
-  else
-    # For HP 11
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_mutex_init in -lpthread" >&5
-$as_echo_n "checking for pthread_mutex_init in -lpthread... " >&6; }
-if ${ac_cv_lib_pthread_pthread_mutex_init+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char pthread_mutex_init ();
-int
-main ()
-{
-return pthread_mutex_init ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_pthread_pthread_mutex_init=yes
-else
-  ac_cv_lib_pthread_pthread_mutex_init=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_mutex_init" >&5
-$as_echo "$ac_cv_lib_pthread_pthread_mutex_init" >&6; }
-if test "x$ac_cv_lib_pthread_pthread_mutex_init" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBPTHREAD 1
-_ACEOF
-
-  LIBS="-lpthread $LIBS"
-
-fi
-
-    if test $ac_cv_lib_pthread_pthread_mutex_init = yes; then
-      :
-    fi
-  fi
-
-  ac_fn_c_check_func "$LINENO" "pthread_mutex_lock" "ac_cv_func_pthread_mutex_lock"
-if test "x$ac_cv_func_pthread_mutex_lock" = xyes; then :
-
-fi
-
-
-  if test $ac_cv_func_pthread_mutex_lock = yes; then
-    :
-  fi
-fi
-# Check to see if we are using CygWin with MSVC
-case "${host}" in
-*-pc-cygwin*|*-pc-mingw*)
-  # For gcc, the thread options are set by mh-mingw/mh-cygwin
-  # For msvc, the thread options are set by runConfigureICU
-  :
-  ;;
-*-*-hpux*)
-  # Add -mt because it does several nice things on newer compilers.
-  case "${icu_cv_host_frag}" in
-    mh-hpux-acc)
-      OLD_CXXFLAGS="${CXXFLAGS}"
-      CXXFLAGS="${CXXFLAGS} -mt"
-      if test x"`${CXX} ${CXXFLAGS} 2>&1`" != x""; then
-         CXXFLAGS="${OLD_CXXFLAGS}"
-      else
-         UCONFIG_CXXFLAGS="${UCONFIG_CXXFLAGS} -mt"
-      fi
-    ;;
-  esac
-  ;;
-*-*-solaris*)
-  case "${icu_cv_host_frag}" in
-    mh-solaris)
-         LIBS="${LIBS} -mt"
-    ;;
-  esac
-  ;;
-esac
-
-# Check whether --enable-weak-threads was given.
-if test "${enable_weak_threads+set}" = set; then :
-  enableval=$enable_weak_threads; case "${enableval}" in
-		yes)
-            LIB_THREAD="${LIBS%${OLD_LIBS}}"
-            LIBS=${OLD_LIBS}
-            ;;
-		no)  ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-weak-threads" "$LINENO" 5 ;;
-		esac
-fi
-
-
-
-# Check for mmap()
-
-# The AC_FUNC_MMAP macro doesn't work properly.  It seems to be too specific.
-# Do this check instead.
-HAVE_MMAP=0
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for mmap" >&5
-$as_echo_n "checking for mmap... " >&6; }
-if ${ac_cv_func_mmap_ok+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <unistd.h>
-#include <sys/mman.h>
-#include <sys/stat.h>
-#include <fcntl.h>
-int
-main ()
-{
-mmap((void *)0, 0, PROT_READ, 0, 0, 0);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_func_mmap_ok=yes
-else
-  ac_cv_func_mmap_ok=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_mmap_ok" >&5
-$as_echo "$ac_cv_func_mmap_ok" >&6; }
-if test $ac_cv_func_mmap_ok = yes
-then
-    HAVE_MMAP=1
-else
-    CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_MMAP=0"
-fi
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for genccode assembly" >&5
-$as_echo_n "checking for genccode assembly... " >&6; }
-
-# Check to see if genccode can generate simple assembly.
-GENCCODE_ASSEMBLY=
-case "${host}" in
-*-linux*|*-kfreebsd*-gnu*|i*86-*-*bsd*|i*86-pc-gnu)
-    if test "$GCC" = yes; then
-        # We're using gcc, and the simple -a gcc command line works for genccode
-        GENCCODE_ASSEMBLY="-a gcc"
-    fi ;;
-i*86-*-solaris*)
-    if test "$GCC" = yes; then
-        # When using gcc, look if we're also using GNU as.
-        # When using GNU as, the simple -a gcc command line works for genccode.
-        asv=`"${CC}" -print-prog-name=as 2>/dev/null`
-        asv=`"${asv}" --version 2>/dev/null`
-        case "X${asv}" in
-        X*GNU*) GENCCODE_ASSEMBLY="-a gcc" ;;
-        X*) GENCCODE_ASSEMBLY="-a sun-x86" ;;
-        esac
-        unset asv
-    else
-        GENCCODE_ASSEMBLY="-a sun-x86"
-    fi ;;
-sparc-*-solaris*)
-    GENCCODE_ASSEMBLY="-a sun"
-    ;;
-ia64-*-hpux*)
-# There has been some issues with building ICU data on HPUX ia64 aCC
-# when using the assemble code setting below.  For now, build without
-# assemble code for this platform.  This will increase the build time.
-#    GENCCODE_ASSEMBLY="-a aCC-ia64"
-    ;;
-esac
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $GENCCODE_ASSEMBLY" >&5
-$as_echo "$GENCCODE_ASSEMBLY" >&6; }
-
-# Checks for header files
-for ac_header in inttypes.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "inttypes.h" "ac_cv_header_inttypes_h" "$ac_includes_default"
-if test "x$ac_cv_header_inttypes_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_INTTYPES_H 1
-_ACEOF
-
-fi
-
-done
-
-if test $ac_cv_header_inttypes_h = no; then
- U_HAVE_INTTYPES_H=0
- CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INTTYPES_H=0"
-else
- U_HAVE_INTTYPES_H=1
-fi
-if test "$CC" = ccc; then
- { $as_echo "$as_me:${as_lineno-$LINENO}: result: \"C compiler set to CCC ${CC}\" " >&5
-$as_echo "\"C compiler set to CCC ${CC}\" " >&6; }
- case "${host}" in
-        alpha*-*-*) U_HAVE_INTTYPES_H=0;
-        CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INTTYPES_H=0"
- esac
-fi
-
-
-
-for ac_header in dirent.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "dirent.h" "ac_cv_header_dirent_h" "$ac_includes_default"
-if test "x$ac_cv_header_dirent_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_DIRENT_H 1
-_ACEOF
-
-fi
-
-done
-
-if test $ac_cv_header_dirent_h = no; then
- U_HAVE_DIRENT_H=0
- CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_DIRENT_H=0"
-else
- U_HAVE_DIRENT_H=1
-fi
-
-
-
-# Check for endianness
- { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether byte ordering is bigendian" >&5
-$as_echo_n "checking whether byte ordering is bigendian... " >&6; }
-if ${ac_cv_c_bigendian+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_c_bigendian=unknown
-    # See if we're dealing with a universal compiler.
-    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#ifndef __APPLE_CC__
-	       not a universal capable compiler
-	     #endif
-	     typedef int dummy;
-
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-
-	# Check for potential -arch flags.  It is not universal unless
-	# there are at least two -arch flags with different values.
-	ac_arch=
-	ac_prev=
-	for ac_word in $CC $CFLAGS $CPPFLAGS $LDFLAGS; do
-	 if test -n "$ac_prev"; then
-	   case $ac_word in
-	     i?86 | x86_64 | ppc | ppc64)
-	       if test -z "$ac_arch" || test "$ac_arch" = "$ac_word"; then
-		 ac_arch=$ac_word
-	       else
-		 ac_cv_c_bigendian=universal
-		 break
-	       fi
-	       ;;
-	   esac
-	   ac_prev=
-	 elif test "x$ac_word" = "x-arch"; then
-	   ac_prev=arch
-	 fi
-       done
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-    if test $ac_cv_c_bigendian = unknown; then
-      # See if sys/param.h defines the BYTE_ORDER macro.
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <sys/types.h>
-	     #include <sys/param.h>
-
-int
-main ()
-{
-#if ! (defined BYTE_ORDER && defined BIG_ENDIAN \
-		     && defined LITTLE_ENDIAN && BYTE_ORDER && BIG_ENDIAN \
-		     && LITTLE_ENDIAN)
-	      bogus endian macros
-	     #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  # It does; now see whether it defined to BIG_ENDIAN or not.
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <sys/types.h>
-		#include <sys/param.h>
-
-int
-main ()
-{
-#if BYTE_ORDER != BIG_ENDIAN
-		 not big endian
-		#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_c_bigendian=yes
-else
-  ac_cv_c_bigendian=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-    fi
-    if test $ac_cv_c_bigendian = unknown; then
-      # See if <limits.h> defines _LITTLE_ENDIAN or _BIG_ENDIAN (e.g., Solaris).
-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <limits.h>
-
-int
-main ()
-{
-#if ! (defined _LITTLE_ENDIAN || defined _BIG_ENDIAN)
-	      bogus endian macros
-	     #endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  # It does; now see whether it defined to _BIG_ENDIAN or not.
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <limits.h>
-
-int
-main ()
-{
-#ifndef _BIG_ENDIAN
-		 not big endian
-		#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  ac_cv_c_bigendian=yes
-else
-  ac_cv_c_bigendian=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-    fi
-    if test $ac_cv_c_bigendian = unknown; then
-      # Compile a test program.
-      if test "$cross_compiling" = yes; then :
-  # Try to guess by grepping values from an object file.
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-short int ascii_mm[] =
-		  { 0x4249, 0x4765, 0x6E44, 0x6961, 0x6E53, 0x7953, 0 };
-		short int ascii_ii[] =
-		  { 0x694C, 0x5454, 0x656C, 0x6E45, 0x6944, 0x6E61, 0 };
-		int use_ascii (int i) {
-		  return ascii_mm[i] + ascii_ii[i];
-		}
-		short int ebcdic_ii[] =
-		  { 0x89D3, 0xE3E3, 0x8593, 0x95C5, 0x89C4, 0x9581, 0 };
-		short int ebcdic_mm[] =
-		  { 0xC2C9, 0xC785, 0x95C4, 0x8981, 0x95E2, 0xA8E2, 0 };
-		int use_ebcdic (int i) {
-		  return ebcdic_mm[i] + ebcdic_ii[i];
-		}
-		extern int foo;
-
-int
-main ()
-{
-return use_ascii (foo) == use_ebcdic (foo);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  if grep BIGenDianSyS conftest.$ac_objext >/dev/null; then
-	      ac_cv_c_bigendian=yes
-	    fi
-	    if grep LiTTleEnDian conftest.$ac_objext >/dev/null ; then
-	      if test "$ac_cv_c_bigendian" = unknown; then
-		ac_cv_c_bigendian=no
-	      else
-		# finding both strings is unlikely to happen, but who knows?
-		ac_cv_c_bigendian=unknown
-	      fi
-	    fi
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$ac_includes_default
-int
-main ()
-{
-
-	     /* Are we little or big endian?  From Harbison&Steele.  */
-	     union
-	     {
-	       long int l;
-	       char c[sizeof (long int)];
-	     } u;
-	     u.l = 1;
-	     return u.c[sizeof (long int) - 1] == 1;
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_run "$LINENO"; then :
-  ac_cv_c_bigendian=no
-else
-  ac_cv_c_bigendian=yes
-fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
-  conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-
-    fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_bigendian" >&5
-$as_echo "$ac_cv_c_bigendian" >&6; }
- case $ac_cv_c_bigendian in #(
-   yes)
-     $as_echo "#define WORDS_BIGENDIAN 1" >>confdefs.h
-;; #(
-   no)
-      ;; #(
-   universal)
-
-$as_echo "#define AC_APPLE_UNIVERSAL_BUILD 1" >>confdefs.h
-
-     ;; #(
-   *)
-     as_fn_error $? "unknown endianness
- presetting ac_cv_c_bigendian=no (or yes) will help" "$LINENO" 5 ;;
- esac
-
-if test $ac_cv_c_bigendian = no; then
-U_IS_BIG_ENDIAN=0
-U_ENDIAN_CHAR="l"
-else
-U_IS_BIG_ENDIAN=1
-U_ENDIAN_CHAR="b"
-fi
-
-
-# Do various POSIX related checks
-U_HAVE_NL_LANGINFO_CODESET=0
-U_NL_LANGINFO_CODESET=-1
-ac_fn_c_check_func "$LINENO" "nl_langinfo" "ac_cv_func_nl_langinfo"
-if test "x$ac_cv_func_nl_langinfo" = xyes; then :
-  U_HAVE_NL_LANGINFO=1
-else
-  U_HAVE_NL_LANGINFO=0
-fi
-
-if test $U_HAVE_NL_LANGINFO -eq 1; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for nl_langinfo's argument to obtain the codeset" >&5
-$as_echo_n "checking for nl_langinfo's argument to obtain the codeset... " >&6; }
-if ${ac_cv_nl_langinfo_codeset+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_cv_nl_langinfo_codeset="unknown"
-  for a in CODESET _NL_CTYPE_CODESET_NAME; do
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <langinfo.h>
-int
-main ()
-{
-nl_langinfo($a);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_nl_langinfo_codeset="$a"; break
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-  done
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_nl_langinfo_codeset" >&5
-$as_echo "$ac_cv_nl_langinfo_codeset" >&6; }
-  if test x$ac_cv_nl_langinfo_codeset != xunknown
-  then
-      U_HAVE_NL_LANGINFO_CODESET=1
-      U_NL_LANGINFO_CODESET=$ac_cv_nl_langinfo_codeset
-      if test "x${ac_cv_nl_langinfo_codeset}" != "xCODESET"
-      then
-        CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DNL_LANGINFO_CODESET=${ac_cv_nl_langinfo_codeset}"
-      fi
-  else
-      CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_NL_LANGINFO_CODESET=0"
-  fi
-fi
-
-
-
-# Namespace support checks
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for namespace support" >&5
-$as_echo_n "checking for namespace support... " >&6; }
-if ${ac_cv_namespace_ok+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-namespace x_version {void f(){}}
-    namespace x = x_version;
-    using namespace x_version;
-
-int
-main ()
-{
-f();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  ac_cv_namespace_ok=yes
-else
-  ac_cv_namespace_ok=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_namespace_ok" >&5
-$as_echo "$ac_cv_namespace_ok" >&6; }
-if test $ac_cv_namespace_ok = no
-then
-    as_fn_error $? "Namespace support is required to build ICU." "$LINENO" 5
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for properly overriding new and delete" >&5
-$as_echo_n "checking for properly overriding new and delete... " >&6; }
-U_OVERRIDE_CXX_ALLOCATION=0
-U_HAVE_PLACEMENT_NEW=0
-if ${ac_cv_override_cxx_allocation_ok+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdlib.h>
-    class UMemory {
-    public:
-    void *operator new(size_t size) {return malloc(size);}
-    void *operator new[](size_t size) {return malloc(size);}
-    void operator delete(void *p) {free(p);}
-    void operator delete[](void *p) {free(p);}
-    };
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  ac_cv_override_cxx_allocation_ok=yes
-else
-  ac_cv_override_cxx_allocation_ok=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_override_cxx_allocation_ok" >&5
-$as_echo "$ac_cv_override_cxx_allocation_ok" >&6; }
-if test $ac_cv_override_cxx_allocation_ok = yes
-then
-    U_OVERRIDE_CXX_ALLOCATION=1
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking for placement new and delete" >&5
-$as_echo_n "checking for placement new and delete... " >&6; }
-    if ${ac_cv_override_placement_new_ok+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdlib.h>
-        class UMemory {
-        public:
-        void *operator new(size_t size) {return malloc(size);}
-        void *operator new[](size_t size) {return malloc(size);}
-        void operator delete(void *p) {free(p);}
-        void operator delete[](void *p) {free(p);}
-        void * operator new(size_t, void *ptr) { return ptr; }
-        void operator delete(void *, void *) {}
-        };
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_link "$LINENO"; then :
-  ac_cv_override_placement_new_ok=yes
-else
-  ac_cv_override_placement_new_ok=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-
-    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_override_placement_new_ok" >&5
-$as_echo "$ac_cv_override_placement_new_ok" >&6; }
-    if test $ac_cv_override_placement_new_ok = yes
-    then
-        U_HAVE_PLACEMENT_NEW=1
-    else
-        CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_PLACEMENT_NEW=0"
-    fi
-else
-    CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_OVERRIDE_CXX_ALLOCATION=0"
-fi
-
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-ac_fn_c_check_func "$LINENO" "popen" "ac_cv_func_popen"
-if test "x$ac_cv_func_popen" = xyes; then :
-
-fi
-
-if test x$ac_cv_func_popen = xyes
-then
-     U_HAVE_POPEN=1
-else
-     CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_POPEN=0"
-     U_HAVE_POPEN=0
-fi
-
-
-ac_fn_c_check_func "$LINENO" "tzset" "ac_cv_func_tzset"
-if test "x$ac_cv_func_tzset" = xyes; then :
-
-fi
-
-U_HAVE_TZSET=0
-if test x$ac_cv_func_tzset = xyes
-then
-    U_TZSET=tzset
-    U_HAVE_TZSET=1
-else
-    ac_fn_c_check_func "$LINENO" "_tzset" "ac_cv_func__tzset"
-if test "x$ac_cv_func__tzset" = xyes; then :
-
-fi
-
-    if test x$ac_cv_func__tzset = xyes
-    then
-        U_TZSET=_tzset
-        U_HAVE_TZSET=1
-    else
-      CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_TZSET=0"
-    fi
-fi
-
-
-
-U_HAVE_TZNAME=0
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for tzname" >&5
-$as_echo_n "checking for tzname... " >&6; }
-if ${ac_cv_var_tzname+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#ifndef __USE_POSIX
-#define __USE_POSIX
-#endif
-#include <stdlib.h>
-#include <time.h>
-#ifndef tzname /* For SGI.  */
-extern char *tzname[]; /* RS6000 and others reject char **tzname.  */
-#endif
-int
-main ()
-{
-atoi(*tzname);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_var_tzname=yes
-else
-  ac_cv_var_tzname=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_var_tzname" >&5
-$as_echo "$ac_cv_var_tzname" >&6; }
-if test $ac_cv_var_tzname = yes; then
-  U_TZNAME=tzname
-  U_HAVE_TZNAME=1
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for _tzname" >&5
-$as_echo_n "checking for _tzname... " >&6; }
-if ${ac_cv_var__tzname+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdlib.h>
-  #include <time.h>
-  extern char *_tzname[];
-int
-main ()
-{
-atoi(*_tzname);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_var__tzname=yes
-else
-  ac_cv_var__tzname=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_var__tzname" >&5
-$as_echo "$ac_cv_var__tzname" >&6; }
-    if test $ac_cv_var__tzname = yes; then
-      U_TZNAME=_tzname
-      U_HAVE_TZNAME=1
-    else
-     CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_TZNAME=0"
-    fi
-fi
-
-
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for timezone" >&5
-$as_echo_n "checking for timezone... " >&6; }
-if ${ac_cv_var_timezone+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#ifndef __USE_POSIX
-#define __USE_POSIX
-#endif
-#ifndef __USE_XOPEN
-#define __USE_XOPEN
-#endif
-#include <time.h>
-
-int
-main ()
-{
-timezone = 1;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_var_timezone=yes
-else
-  ac_cv_var_timezone=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_var_timezone" >&5
-$as_echo "$ac_cv_var_timezone" >&6; }
-U_HAVE_TIMEZONE=0
-if test $ac_cv_var_timezone = yes; then
-  U_TIMEZONE=timezone
-  U_HAVE_TIMEZONE=1
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for __timezone" >&5
-$as_echo_n "checking for __timezone... " >&6; }
-if ${ac_cv_var___timezone+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <time.h>
-int
-main ()
-{
-__timezone = 1;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_var___timezone=yes
-else
-  ac_cv_var___timezone=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_var___timezone" >&5
-$as_echo "$ac_cv_var___timezone" >&6; }
-  if test $ac_cv_var___timezone = yes; then
-    U_TIMEZONE=__timezone
-    U_HAVE_TIMEZONE=1
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking for _timezone" >&5
-$as_echo_n "checking for _timezone... " >&6; }
-if ${ac_cv_var__timezone+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <time.h>
-int
-main ()
-{
-_timezone = 1;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_var__timezone=yes
-else
-  ac_cv_var__timezone=no
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_var__timezone" >&5
-$as_echo "$ac_cv_var__timezone" >&6; }
-    if test $ac_cv_var__timezone = yes; then
-      U_TIMEZONE=_timezone
-      U_HAVE_TIMEZONE=1
-    else
-     CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_TIMEZONE=0"
-    fi
-  fi
-fi
-
-
-
-# Checks for typedefs
-ac_fn_c_check_type "$LINENO" "int8_t" "ac_cv_type_int8_t" "$ac_includes_default"
-if test "x$ac_cv_type_int8_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define int8_t signed char
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "uint8_t" "ac_cv_type_uint8_t" "$ac_includes_default"
-if test "x$ac_cv_type_uint8_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define uint8_t unsigned char
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "int16_t" "ac_cv_type_int16_t" "$ac_includes_default"
-if test "x$ac_cv_type_int16_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define int16_t signed short
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "uint16_t" "ac_cv_type_uint16_t" "$ac_includes_default"
-if test "x$ac_cv_type_uint16_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define uint16_t unsigned short
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "int32_t" "ac_cv_type_int32_t" "$ac_includes_default"
-if test "x$ac_cv_type_int32_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define int32_t signed long
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "uint32_t" "ac_cv_type_uint32_t" "$ac_includes_default"
-if test "x$ac_cv_type_uint32_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define uint32_t unsigned long
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "int64_t" "ac_cv_type_int64_t" "$ac_includes_default"
-if test "x$ac_cv_type_int64_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define int64_t signed long long
-_ACEOF
-
-fi
-
-ac_fn_c_check_type "$LINENO" "uint64_t" "ac_cv_type_uint64_t" "$ac_includes_default"
-if test "x$ac_cv_type_uint64_t" = xyes; then :
-
-else
-
-cat >>confdefs.h <<_ACEOF
-#define uint64_t unsigned long long
-_ACEOF
-
-fi
-
-
-if test $ac_cv_type_int8_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INT8_T=0"
-fi
-
-if test $ac_cv_type_uint8_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_UINT8_T=0"
-fi
-
-if test $ac_cv_type_int16_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INT16_T=0"
-fi
-
-if test $ac_cv_type_uint16_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_UINT16_T=0"
-fi
-
-if test $ac_cv_type_int32_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INT32_T=0"
-fi
-
-if test $ac_cv_type_uint32_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_UINT32_T=0"
-fi
-
-if test $ac_cv_type_int64_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_INT64_T=0"
-fi
-
-if test $ac_cv_type_uint64_t = no; then
-CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_UINT64_T=0"
-fi
-
-# Do various wchar_t related checks
-ac_fn_c_check_header_mongrel "$LINENO" "wchar.h" "ac_cv_header_wchar_h" "$ac_includes_default"
-if test "x$ac_cv_header_wchar_h" = xyes; then :
-
-fi
-
-
-if test "$ac_cv_header_wchar_h" = no
-then
-    U_HAVE_WCHAR_H=0
-    U_HAVE_WCSCPY=0
-    CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_WCHAR_H=0 -DU_HAVE_WCSCPY=0"
-else
-
-$as_echo "#define HAVE_WCHAR_H 1" >>confdefs.h
-
-    U_HAVE_WCHAR_H=1
-    # Some broken systems have wchar.h but not some of its functions...
-    { $as_echo "$as_me:${as_lineno-$LINENO}: checking for library containing wcscpy" >&5
-$as_echo_n "checking for library containing wcscpy... " >&6; }
-if ${ac_cv_search_wcscpy+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  ac_func_search_save_LIBS=$LIBS
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char wcscpy ();
-int
-main ()
-{
-return wcscpy ();
-  ;
-  return 0;
-}
-_ACEOF
-for ac_lib in '' wcs w; do
-  if test -z "$ac_lib"; then
-    ac_res="none required"
-  else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-  fi
-  if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_search_wcscpy=$ac_res
-fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext
-  if ${ac_cv_search_wcscpy+:} false; then :
-  break
-fi
-done
-if ${ac_cv_search_wcscpy+:} false; then :
-
-else
-  ac_cv_search_wcscpy=no
-fi
-rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_wcscpy" >&5
-$as_echo "$ac_cv_search_wcscpy" >&6; }
-ac_res=$ac_cv_search_wcscpy
-if test "$ac_res" != no; then :
-  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
-
-fi
-
-    if test "$ac_cv_search_wcscpy" != no; then
-      U_HAVE_WCSCPY=1
-    else
-      U_HAVE_WCSCPY=0
-      CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_HAVE_WCSCPY=0"
-    fi
-fi
-
-
-
-# The cast to long int works around a bug in the HP C Compiler
-# version HP92453-01 B.11.11.23709.GP, which incorrectly rejects
-# declarations like `int a3[[(sizeof (unsigned char)) >= 0]];'.
-# This bug is HP SR number 8606223364.
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking size of wchar_t" >&5
-$as_echo_n "checking size of wchar_t... " >&6; }
-if ${ac_cv_sizeof_wchar_t+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  if ac_fn_c_compute_int "$LINENO" "(long int) (sizeof (wchar_t))" "ac_cv_sizeof_wchar_t"        "
-#if STDC_HEADERS
-#include <stddef.h>
-#endif
-#include <stdlib.h>
-#if HAVE_WCHAR_H
-#include <string.h>
-#include <wchar.h>
-#endif
-"; then :
-
-else
-  if test "$ac_cv_type_wchar_t" = yes; then
-     { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "cannot compute sizeof (wchar_t)
-See \`config.log' for more details" "$LINENO" 5; }
-   else
-     ac_cv_sizeof_wchar_t=0
-   fi
-fi
-
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sizeof_wchar_t" >&5
-$as_echo "$ac_cv_sizeof_wchar_t" >&6; }
-
-
-
-cat >>confdefs.h <<_ACEOF
-#define SIZEOF_WCHAR_T $ac_cv_sizeof_wchar_t
-_ACEOF
-
-
-U_SIZEOF_WCHAR_T=$ac_cv_sizeof_wchar_t
-# We do this check to verify that everything is okay.
-if test $U_SIZEOF_WCHAR_T = 0; then
-    if test $U_HAVE_WCHAR_H=1; then
-       as_fn_error $? "There is wchar.h but the size of wchar_t is 0" "$LINENO" 5
-    fi
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for UTF-16 string literal support" >&5
-$as_echo_n "checking for UTF-16 string literal support... " >&6; }
-U_CHECK_UTF16_STRING=1
-CHECK_UTF16_STRING_RESULT="unknown"
-
-case "${host}" in
-*-*-aix*|powerpc64-*-linux*)
-    if test "$GCC" = no; then
-        OLD_CFLAGS="${CFLAGS}"
-        OLD_CXXFLAGS="${CXXFLAGS}"
-        CFLAGS="${CFLAGS} -qutf"
-        CXXFLAGS="${CXXFLAGS} -qutf"
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-const unsigned short hello[] = u"hello";
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  U_CHECK_UTF16_STRING=1
-else
-  U_CHECK_UTF16_STRING=0
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-        if test "$U_CHECK_UTF16_STRING" = 0; then
-            CFLAGS="${OLD_CFLAGS}"
-            CXXFLAGS="${OLD_CXXFLAGS}"
-        else
-            UCONFIG_CXXFLAGS="${UCONFIG_CXXFLAGS} -qutf"
-            CHECK_UTF16_STRING_RESULT="-qutf"
-        fi
-    fi
-    ;;
-*-*-solaris*)
-    if test "$GCC" = no; then
-        OLD_CFLAGS="${CFLAGS}"
-        OLD_CXXFLAGS="${CXXFLAGS}"
-        CFLAGS="${CFLAGS} -xustr=ascii_utf16_ushort"
-        CXXFLAGS="${CXXFLAGS} -xustr=ascii_utf16_ushort"
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-const unsigned short hello[] = U"hello";
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  U_CHECK_UTF16_STRING=1
-else
-  U_CHECK_UTF16_STRING=0
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-        if test "$U_CHECK_UTF16_STRING" = 0; then
-            CFLAGS="${OLD_CFLAGS}"
-            CXXFLAGS="${OLD_CXXFLAGS}"
-        else
-            CHECK_UTF16_STRING_RESULT="-xustr=ascii_utf16_ushort"
-            UCONFIG_CXXFLAGS="${UCONFIG_CXXFLAGS} -xustr=ascii_utf16_ushort"
-            UCONFIG_CFLAGS="${UCONFIG_CFLAGS} -xustr=ascii_utf16_ushort"
-            # Since we can't detect the availability of this UTF-16 syntax at compile time,
-            # we depend on configure telling us that we can use it.
-            # Since we can't ensure ICU users use -xustr=ascii_utf16_ushort,
-            # we only use this macro within ICU.
-            # If an ICU user uses icu-config, this feature will be enabled.
-            CONFIG_CPPFLAGS="${CONFIG_CPPFLAGS} -DU_CHECK_UTF16_STRING=1"
-            U_CHECK_UTF16_STRING=0
-        fi
-    fi
-    ;;
-*-*-hpux*)
-    if test "$GCC" = no; then
-        # The option will be detected at compile time without additional compiler options.
-        CHECK_UTF16_STRING_RESULT="available"
-    fi
-    ;;
-*-*-cygwin)
-    # wchar_t can be used
-    CHECK_UTF16_STRING_RESULT="available"
-    ;;
-*)
-    ;;
-esac
-
-# GCC >= 4.4 supports UTF16 string literals. The CFLAGS and CXXFLAGS may change in the future.
-if test "$CHECK_UTF16_STRING_RESULT" = "unknown"; then
-    if test "$GCC" = yes; then
-        OLD_CFLAGS="${CFLAGS}"
-        CFLAGS="${CFLAGS} -std=gnu99"
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-static const char16_t test[] = u"This is a UTF16 literal string.";
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  CC_UTF16_STRING=1
-else
-  CC_UTF16_STRING=0
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-        if test "$CC_UTF16_STRING" = 1; then
-            UCONFIG_CFLAGS="${UCONFIG_CFLAGS} -std=gnu99"
-            CHECK_UTF16_STRING_RESULT="C only";
-        else
-            CFLAGS="${OLD_CFLAGS}"
-        fi
-    fi
-    if test "$GXX" = yes; then
-        # -Wno-return-type-c-linkage is desired so that stable ICU API is not warned about.
-        ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-static const char16_t test[] = u"This is a UTF16 literal string.";
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_cxx_try_compile "$LINENO"; then :
-  CXX_UTF16_STRING=1
-else
-  CXX_UTF16_STRING=0
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-        ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-        if test "$CXX_UTF16_STRING" = 1; then
-            if test "$CC_UTF16_STRING" = 1; then
-                CHECK_UTF16_STRING_RESULT="available";
-            else
-                CHECK_UTF16_STRING_RESULT="C++ only";
-            fi
-        fi
-    fi
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $CHECK_UTF16_STRING_RESULT" >&5
-$as_echo "$CHECK_UTF16_STRING_RESULT" >&6; }
-
-# Enable/disable extras
-# Check whether --enable-extras was given.
-if test "${enable_extras+set}" = set; then :
-  enableval=$enable_extras; case "${enableval}" in
-		yes) extras=true ;;
-		no)  extras=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-extras" "$LINENO" 5 ;;
-		esac
-else
-  extras=true
-fi
-
-
-
-if test "$extras" = true; then
-  EXTRAS_TRUE=
-  U_HAVE_EXTRAS=1
-else
-  EXTRAS_TRUE='#'
-  U_HAVE_EXTRAS=0
-fi
-# Check whether --enable-icuio was given.
-if test "${enable_icuio+set}" = set; then :
-  enableval=$enable_icuio; case "${enableval}" in
-		yes) icuio=true ;;
-		no)  icuio=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-icuio" "$LINENO" 5 ;;
-		esac
-else
-  icuio=true
-fi
-
-
-
-if test "$icuio" = true; then
-  ICUIO_TRUE=
-  U_HAVE_ICUIO=1
-else
-  ICUIO_TRUE='#'
-  U_HAVE_ICUIO=0
-fi
-
-# Enable/disable layout
-# Check whether --enable-layout was given.
-if test "${enable_layout+set}" = set; then :
-  enableval=$enable_layout; case "${enableval}" in
-		yes) layout=true ;;
-		no)  layout=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-layout" "$LINENO" 5 ;;
-		esac
-else
-  layout=true
-fi
-
-
-
-if test "$layout" = true; then
-  LAYOUT_TRUE=
-  U_HAVE_LAYOUT=1
-else
-  LAYOUT_TRUE='#'
-  U_HAVE_LAYOUT=0
-fi
-
-# Enable/disable layoutex
-# Check whether --enable-layoutex was given.
-if test "${enable_layoutex+set}" = set; then :
-  enableval=$enable_layoutex; case "${enableval}" in
-		yes) layoutex=true ;;
-		no)  layoutex=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-layoutex" "$LINENO" 5 ;;
-		esac
-else
-  layoutex=$layout
-fi
-
-
-
-if test "$layoutex" = true; then
-  LAYOUTEX_TRUE=
-  U_HAVE_LAYOUTEX=1
-else
-  LAYOUTEX_TRUE='#'
-  U_HAVE_LAYOUTEX=0
-fi
-
-# Enable/disable tools
-# Check whether --enable-tools was given.
-if test "${enable_tools+set}" = set; then :
-  enableval=$enable_tools; case "${enableval}" in
-		yes) tools=true ;;
-		no)  tools=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-tools" "$LINENO" 5 ;;
-		esac
-else
-  tools=true
-fi
-
-
-
-if test "$tools" = true; then
-  TOOLS_TRUE=
-  U_HAVE_TOOLS=1
-else
-  TOOLS_TRUE='#'
-  U_HAVE_TOOLS=0
-fi
-
-
-# Check whether --with-data-packaging was given.
-if test "${with_data_packaging+set}" = set; then :
-  withval=$with_data_packaging; case "${withval}" in
-                files|archive|library) datapackaging=$withval ;;
-		auto) datapackaging=$withval ;;
-		common) datapackaging=archive ;;
-		dll) datapackaging=library ;;
-		static) datapackaging=static ;;
-		*) as_fn_error $? "bad value ${withval} for --with-data-packaging" "$LINENO" 5 ;;
-		esac
-else
-  datapackaging=
-fi
-
-
-# Note:  'thesysconfdir' is an evaluated version, for Man pages, so also for thedatadir, thelibdir, etc..
-# thesysconfdir=`eval echo $sysconfdir`
-thedatadir=`eval echo $datadir`
-# Always put raw data files in share/icu/{version}, etc.   Never use lib/icu/{version} for data files.. Actual shared libraries will go in {libdir}.
-pkgicudatadir=$datadir
-thepkgicudatadir=$thedatadir
-
-
-
-
-if test x"$datapackaging" = x -o x"$datapackaging" = xauto; then
-	# default to library
-	datapackaging=library
-	if test "$ENABLE_STATIC" = "YES"; then
-		if test "$ENABLE_SHARED" != "YES"; then
-			datapackaging=static
-		fi
-	fi
-fi
-
-datapackaging_dir=`eval echo $thedatadir`"/icu/${VERSION}"
-
-datapackaging_msg="(No explaination for mode $datapackaging.)"
-
-datapackaging_msg_path="ICU will look in $datapackaging_dir which is the installation location. Call u_setDataDirectory() or use the ICU_DATA environment variable to override."
-datapackaging_msg_set="ICU will use the linked data library. If linked with the stub library located in stubdata/, the application can use udata_setCommonData() or set a data path to override."
-datapackaging_howfound="(unknown)"
-
-case "$datapackaging" in
-    files)
-    DATA_PACKAGING_MODE=files
-    datapackaging_msg="ICU data will be stored in individual files."
-    datapackaging_howfound="$datapackaging_msg_path"
-    ;;
-    archive)
-    DATA_PACKAGING_MODE=common
-    datapackaging_msg="ICU data will be stored in a single .dat file."
-    datapackaging_howfound="$datapackaging_msg_path"
-    ;;
-    library)
-    DATA_PACKAGING_MODE=dll
-    datapackaging_msg="ICU data will be linked with ICU."
-    if test "$ENABLE_STATIC" = "YES"; then
-        datapackaging_msg="$datapackaging_msg A static data library will be built. "
-    fi
-    if test "$ENABLE_SHARED" = "YES"; then
-        datapackaging_msg="$datapackaging_msg A shared data library will be built. "
-    fi
-    datapackaging_howfound="$datapackaging_msg_set"
-    ;;
-    static)
-    DATA_PACKAGING_MODE=static
-    datapackaging_msg="ICU data will be stored in a static library."
-    datapackaging_howfound="$datapackaging_msg_set"
-    ;;
-esac
-
-
-# Sets a library suffix
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for a library suffix to use" >&5
-$as_echo_n "checking for a library suffix to use... " >&6; }
-
-# Check whether --with-library-suffix was given.
-if test "${with_library_suffix+set}" = set; then :
-  withval=$with_library_suffix; ICULIBSUFFIX="${withval}"
-else
-  ICULIBSUFFIX=
-fi
-
-msg=$ICULIBSUFFIX
-if test "$msg" = ""; then
-    msg=none
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $msg" >&5
-$as_echo "$msg" >&6; }
-
-if test "$ICULIBSUFFIX" != ""
-then
-    U_HAVE_LIB_SUFFIX=1
-    ICULIBSUFFIXCNAME=`echo _$ICULIBSUFFIX | sed 's/^A-Za-z0-9_/_/g'`
-    UCONFIG_CPPFLAGS="${UCONFIG_CPPFLAGS} -DU_HAVE_LIB_SUFFIX=1 -DU_LIB_SUFFIX_C_NAME=${ICULIBSUFFIXCNAME} "
-else
-    U_HAVE_LIB_SUFFIX=0
-fi
-
-
-
-# Enable/disable tests
-# Check whether --enable-tests was given.
-if test "${enable_tests+set}" = set; then :
-  enableval=$enable_tests; case "${enableval}" in
-		yes) tests=true ;;
-		no)  tests=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-tests" "$LINENO" 5 ;;
-		esac
-else
-  tests=true
-fi
-
-
-
-if test "$tests" = true; then
-  TESTS_TRUE=
-  U_HAVE_TESTS=1
-else
-  TESTS_TRUE='#'
-  U_HAVE_TESTS=0
-fi
-
-# Enable/disable samples
-# Check whether --enable-samples was given.
-if test "${enable_samples+set}" = set; then :
-  enableval=$enable_samples; case "${enableval}" in
-		yes) samples=true ;;
-		no)  samples=false ;;
-		*) as_fn_error $? "bad value ${enableval} for --enable-samples" "$LINENO" 5 ;;
-		esac
-else
-  samples=true
-fi
-
-
-
-if test "$samples" = true; then
-  SAMPLES_TRUE=
-  U_HAVE_SAMPLES=1
-else
-  SAMPLES_TRUE='#'
-  U_HAVE_SAMPLES=0
-fi
-
-ICUDATA_CHAR=$U_ENDIAN_CHAR
-
-# Platform-specific Makefile setup
-# set ICUDATA_CHAR to 'e' for any EBCDIC (which should be big endian) platform.
-case "${host}" in
-	*-*-solaris*) 	platform=U_SOLARIS ;;
-	*-*-linux*|*-*-gnu|*-*-k*bsd*-gnu|*-*-kopensolaris*-gnu)        platform=U_LINUX ;;
-	*-*-*bsd*|*-*-dragonfly*) 	platform=U_BSD ;;
-	*-*-aix*) 	platform=U_AIX ;;
-	*-*-hpux*) 	platform=U_HPUX ;;
-	*-apple-darwin*|*-apple-rhapsody*)	platform=U_DARWIN ;;
-	*-*-cygwin*)	platform=U_CYGWIN ;;
-	*-*-mingw*)	platform=U_MINGW ;;
-	*-*ibm-openedition*|*-*-os390*)	platform=OS390
-			if test "${ICU_ENABLE_ASCII_STRINGS}" != "1"; then
-				ICUDATA_CHAR="e"
-			fi ;;
-	*-*-os400*)	platform=OS400
-			if test "${ICU_ENABLE_ASCII_STRINGS}" != "1"; then
-				ICUDATA_CHAR="e"
-			fi ;;
-	*-*-nto*)	platform=U_QNX ;;
-	*-dec-osf*) 	platform=U_OSF ;;
-	*-*-beos)		platform=U_BEOS ;;
-	*-*-irix*)		platform=U_IRIX ;;
-	*-ncr-*)		platform=U_MPRAS ;;
-	*) 		platform=U_UNKNOWN_PLATFORM ;;
-esac
-
-
-platform_make_fragment_name="$icu_cv_host_frag"
-platform_make_fragment='$(top_srcdir)/config/'"$platform_make_fragment_name"
-
-
-
-if test "${FORCE_LIBS}" != ""; then
-   echo " *** Overriding automatically chosen LIBS=$LIBS, using instead FORCE_LIBS=${FORCE_LIBS}"  1>&6
-   LIBS=${FORCE_LIBS}
-fi
-
-# Now that we're done using CPPFLAGS etc. for tests, we can change it
-# for build.
-
-if test "${CC}" == "clang"; then
-   CLANGCFLAGS="-Qunused-arguments -Wno-parentheses-equality"
-else
-   CLANGCFLAGS=""
-fi
-
-if test "${CXX}" == "clang++"; then
-   CLANGCXXFLAGS="-Qunused-arguments -Wno-parentheses-equality"
-else
-   CLANGCXXFLAGS=""
-fi
-
-CPPFLAGS="$CPPFLAGS \$(THREADSCPPFLAGS)"
-CFLAGS="$CFLAGS \$(THREADSCFLAGS) $CLANGCFLAGS"
-CXXFLAGS="$CXXFLAGS \$(THREADSCXXFLAGS) $CLANGCXXFLAGS"
-
-
-
-
-# append all config cppflags
-CPPFLAGS="$CPPFLAGS $CONFIG_CPPFLAGS $UCONFIG_CPPFLAGS"
-
-echo "CPPFLAGS=$CPPFLAGS"
-echo "CFLAGS=$CFLAGS"
-echo "CXXFLAGS=$CXXFLAGS"
-
-
-# output the Makefiles
-ac_config_files="$ac_config_files icudefs.mk Makefile data/pkgdataMakefile config/Makefile.inc config/icu.pc config/pkgdataMakefile data/Makefile stubdata/Makefile common/Makefile i18n/Makefile layout/Makefile layoutex/Makefile io/Makefile extra/Makefile extra/uconv/Makefile extra/uconv/pkgdataMakefile extra/scrptrun/Makefile tools/Makefile tools/ctestfw/Makefile tools/toolutil/Makefile tools/makeconv/Makefile tools/genrb/Makefile tools/genccode/Makefile tools/gencmn/Makefile tools/gencnval/Makefile tools/gendict/Makefile tools/gentest/Makefile tools/gennorm2/Makefile tools/genbrk/Makefile tools/gensprep/Makefile tools/icuinfo/Makefile tools/icupkg/Makefile tools/icuswap/Makefile tools/pkgdata/Makefile tools/tzcode/Makefile tools/gencfu/Makefile test/Makefile test/compat/Makefile test/testdata/Makefile test/testdata/pkgdataMakefile test/hdrtst/Makefile test/intltest/Makefile test/cintltst/Makefile test/iotest/Makefile test/letest/Makefile test/perf/Makefile test/perf/collationperf/Makefile test/perf/collperf/Makefile test/perf/collperf2/Makefile test/perf/dicttrieperf/Makefile test/perf/ubrkperf/Makefile test/perf/charperf/Makefile test/perf/convperf/Makefile test/perf/normperf/Makefile test/perf/DateFmtPerf/Makefile test/perf/howExpensiveIs/Makefile test/perf/strsrchperf/Makefile test/perf/unisetperf/Makefile test/perf/usetperf/Makefile test/perf/ustrperf/Makefile test/perf/utfperf/Makefile test/perf/utrie2perf/Makefile test/perf/leperf/Makefile samples/Makefile samples/date/Makefile samples/cal/Makefile samples/layout/Makefile"
-
-cat >confcache <<\_ACEOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs, see configure's option --config-cache.
-# It is not useful on other systems.  If it contains results you don't
-# want to keep, you may remove or edit it.
-#
-# config.status only pays attention to the cache file if you give it
-# the --recheck option to rerun configure.
-#
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
-# following values.
-
-_ACEOF
-
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, we kill variables containing newlines.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-(
-  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
-$as_echo "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
-      *) { eval $ac_var=; unset $ac_var;} ;;
-      esac ;;
-    esac
-  done
-
-  (set) 2>&1 |
-    case $as_nl`(ac_space=' '; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      # `set' does not quote correctly, so add quotes: double-quote
-      # substitution turns \\\\ into \\, and sed turns \\ into \.
-      sed -n \
-	"s/'/'\\\\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;; #(
-    *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-) |
-  sed '
-     /^ac_cv_env_/b end
-     t clear
-     :clear
-     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
-     t end
-     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     :end' >>confcache
-if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
-  if test -w "$cache_file"; then
-    if test "x$cache_file" != "x/dev/null"; then
-      { $as_echo "$as_me:${as_lineno-$LINENO}: updating cache $cache_file" >&5
-$as_echo "$as_me: updating cache $cache_file" >&6;}
-      if test ! -f "$cache_file" || test -h "$cache_file"; then
-	cat confcache >"$cache_file"
-      else
-        case $cache_file in #(
-        */* | ?:*)
-	  mv -f confcache "$cache_file"$$ &&
-	  mv -f "$cache_file"$$ "$cache_file" ;; #(
-        *)
-	  mv -f confcache "$cache_file" ;;
-	esac
-      fi
-    fi
-  else
-    { $as_echo "$as_me:${as_lineno-$LINENO}: not updating unwritable cache $cache_file" >&5
-$as_echo "$as_me: not updating unwritable cache $cache_file" >&6;}
-  fi
-fi
-rm -f confcache
-
-test "x$prefix" = xNONE && prefix=$ac_default_prefix
-# Let make expand exec_prefix.
-test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-
-# Transform confdefs.h into DEFS.
-# Protect against shell expansion while executing Makefile rules.
-# Protect against Makefile macro expansion.
-#
-# If the first sed substitution is executed (which looks for macros that
-# take arguments), then branch to the quote section.  Otherwise,
-# look for a macro that doesn't take arguments.
-ac_script='
-:mline
-/\\$/{
- N
- s,\\\n,,
- b mline
-}
-t clear
-:clear
-s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*([^)]*)\)[	 ]*\(.*\)/-D\1=\2/g
-t quote
-s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)/-D\1=\2/g
-t quote
-b any
-:quote
-s/[	 `~#$^&*(){}\\|;'\''"<>?]/\\&/g
-s/\[/\\&/g
-s/\]/\\&/g
-s/\$/$$/g
-H
-:any
-${
-	g
-	s/^\n//
-	s/\n/ /g
-	p
-}
-'
-DEFS=`sed -n "$ac_script" confdefs.h`
-
-
-ac_libobjs=
-ac_ltlibobjs=
-U=
-for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
-  # 1. Remove the extension, and $U if already installed.
-  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
-  ac_i=`$as_echo "$ac_i" | sed "$ac_script"`
-  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
-  #    will be set to the directory where LIBOBJS objects are built.
-  as_fn_append ac_libobjs " \${LIBOBJDIR}$ac_i\$U.$ac_objext"
-  as_fn_append ac_ltlibobjs " \${LIBOBJDIR}$ac_i"'$U.lo'
-done
-LIBOBJS=$ac_libobjs
-
-LTLIBOBJS=$ac_ltlibobjs
-
-
-
-
-: "${CONFIG_STATUS=./config.status}"
-ac_write_fail=0
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files $CONFIG_STATUS"
-{ $as_echo "$as_me:${as_lineno-$LINENO}: creating $CONFIG_STATUS" >&5
-$as_echo "$as_me: creating $CONFIG_STATUS" >&6;}
-as_write_fail=0
-cat >$CONFIG_STATUS <<_ASEOF || as_write_fail=1
-#! $SHELL
-# Generated by $as_me.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-
-SHELL=\${CONFIG_SHELL-$SHELL}
-export SHELL
-_ASEOF
-cat >>$CONFIG_STATUS <<\_ASEOF || as_write_fail=1
-## -------------------- ##
-## M4sh Initialization. ##
-## -------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then :
-  emulate sh
-  NULLCMD=:
-  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in #(
-  *posix*) :
-    set -o posix ;; #(
-  *) :
-     ;;
-esac
-fi
-
-
-as_nl='
-'
-export as_nl
-# Printing a long string crashes Solaris 7 /usr/bin/printf.
-as_echo='\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\'
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo$as_echo
-# Prefer a ksh shell builtin over an external printf program on Solaris,
-# but without wasting forks for bash or zsh.
-if test -z "$BASH_VERSION$ZSH_VERSION" \
-    && (test "X`print -r -- $as_echo`" = "X$as_echo") 2>/dev/null; then
-  as_echo='print -r --'
-  as_echo_n='print -rn --'
-elif (test "X`printf %s $as_echo`" = "X$as_echo") 2>/dev/null; then
-  as_echo='printf %s\n'
-  as_echo_n='printf %s'
-else
-  if test "X`(/usr/ucb/echo -n -n $as_echo) 2>/dev/null`" = "X-n $as_echo"; then
-    as_echo_body='eval /usr/ucb/echo -n "$1$as_nl"'
-    as_echo_n='/usr/ucb/echo -n'
-  else
-    as_echo_body='eval expr "X$1" : "X\\(.*\\)"'
-    as_echo_n_body='eval
-      arg=$1;
-      case $arg in #(
-      *"$as_nl"*)
-	expr "X$arg" : "X\\(.*\\)$as_nl";
-	arg=`expr "X$arg" : ".*$as_nl\\(.*\\)"`;;
-      esac;
-      expr "X$arg" : "X\\(.*\\)" | tr -d "$as_nl"
-    '
-    export as_echo_n_body
-    as_echo_n='sh -c $as_echo_n_body as_echo'
-  fi
-  export as_echo_body
-  as_echo='sh -c $as_echo_body as_echo'
-fi
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  PATH_SEPARATOR=:
-  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
-    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
-      PATH_SEPARATOR=';'
-  }
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-as_myself=
-case $0 in #((
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-  done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  $as_echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  exit 1
-fi
-
-# Unset variables that we do not need and which cause bugs (e.g. in
-# pre-3.0 UWIN ksh).  But do not cause bugs in bash 2.01; the "|| exit 1"
-# suppresses any "Segmentation fault" message there.  '((' could
-# trigger a bug in pdksh 5.2.14.
-for as_var in BASH_ENV ENV MAIL MAILPATH
-do eval test x\${$as_var+set} = xset \
-  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-LC_ALL=C
-export LC_ALL
-LANGUAGE=C
-export LANGUAGE
-
-# CDPATH.
-(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
-
-
-# as_fn_error STATUS ERROR [LINENO LOG_FD]
-# ----------------------------------------
-# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
-# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
-# script with STATUS, using 1 if that was 0.
-as_fn_error ()
-{
-  as_status=$1; test $as_status -eq 0 && as_status=1
-  if test "$4"; then
-    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
-  fi
-  $as_echo "$as_me: error: $2" >&2
-  as_fn_exit $as_status
-} # as_fn_error
-
-
-# as_fn_set_status STATUS
-# -----------------------
-# Set $? to STATUS, without forking.
-as_fn_set_status ()
-{
-  return $1
-} # as_fn_set_status
-
-# as_fn_exit STATUS
-# -----------------
-# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
-as_fn_exit ()
-{
-  set +e
-  as_fn_set_status $1
-  exit $1
-} # as_fn_exit
-
-# as_fn_unset VAR
-# ---------------
-# Portably unset VAR.
-as_fn_unset ()
-{
-  { eval $1=; unset $1;}
-}
-as_unset=as_fn_unset
-# as_fn_append VAR VALUE
-# ----------------------
-# Append the text in VALUE to the end of the definition contained in VAR. Take
-# advantage of any shell optimizations that allow amortized linear growth over
-# repeated appends, instead of the typical quadratic growth present in naive
-# implementations.
-if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null; then :
-  eval 'as_fn_append ()
-  {
-    eval $1+=\$2
-  }'
-else
-  as_fn_append ()
-  {
-    eval $1=\$$1\$2
-  }
-fi # as_fn_append
-
-# as_fn_arith ARG...
-# ------------------
-# Perform arithmetic evaluation on the ARGs, and store the result in the
-# global $as_val. Take advantage of shells that can avoid forks. The arguments
-# must be portable across $(()) and expr.
-if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null; then :
-  eval 'as_fn_arith ()
-  {
-    as_val=$(( $* ))
-  }'
-else
-  as_fn_arith ()
-  {
-    as_val=`expr "$@" || test $? -eq 1`
-  }
-fi # as_fn_arith
-
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in #(((((
--n*)
-  case `echo 'xy\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  xy)  ECHO_C='\c';;
-  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
-       ECHO_T='	';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir 2>/dev/null
-fi
-if (echo >conf$$.file) 2>/dev/null; then
-  if ln -s conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s='ln -s'
-    # ... but there are two gotchas:
-    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
-    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-      as_ln_s='cp -pR'
-  elif ln conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s=ln
-  else
-    as_ln_s='cp -pR'
-  fi
-else
-  as_ln_s='cp -pR'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-
-# as_fn_mkdir_p
-# -------------
-# Create "$as_dir" as a directory, including parents if necessary.
-as_fn_mkdir_p ()
-{
-
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || eval $as_mkdir_p || {
-    as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`$as_echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-      test -d "$as_dir" && break
-    done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
-
-
-} # as_fn_mkdir_p
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p='mkdir -p "$as_dir"'
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-
-# as_fn_executable_p FILE
-# -----------------------
-# Test if FILE is an executable regular file.
-as_fn_executable_p ()
-{
-  test -f "$1" && test -x "$1"
-} # as_fn_executable_p
-as_test_x='test -x'
-as_executable_p=as_fn_executable_p
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-exec 6>&1
-## ----------------------------------- ##
-## Main body of $CONFIG_STATUS script. ##
-## ----------------------------------- ##
-_ASEOF
-test $as_write_fail = 0 && chmod +x $CONFIG_STATUS || ac_write_fail=1
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-# Save the log message, to keep $0 and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.
-ac_log="
-This file was extended by ICU $as_me 56.1, which was
-generated by GNU Autoconf 2.69.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-on `(hostname || uname -n) 2>/dev/null | sed 1q`
-"
-
-_ACEOF
-
-case $ac_config_files in *"
-"*) set x $ac_config_files; shift; ac_config_files=$*;;
-esac
-
-
-
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-# Files that config.status was made for.
-config_files="$ac_config_files"
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-ac_cs_usage="\
-\`$as_me' instantiates files and other configuration actions
-from templates according to the current configuration.  Unless the files
-and actions are specified as TAGs, all are instantiated by default.
-
-Usage: $0 [OPTION]... [TAG]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number and configuration settings, then exit
-      --config     print configuration, then exit
-  -q, --quiet, --silent
-                   do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-      --file=FILE[:TEMPLATE]
-                   instantiate the configuration file FILE
-
-Configuration files:
-$config_files
-
-Report bugs to <http://icu-project.org/bugs>.
-ICU home page: <http://icu-project.org>."
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
-ac_cs_version="\\
-ICU config.status 56.1
-configured by $0, generated by GNU Autoconf 2.69,
-  with options \\"\$ac_cs_config\\"
-
-Copyright (C) 2012 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-
-ac_pwd='$ac_pwd'
-srcdir='$srcdir'
-INSTALL='$INSTALL'
-test -n "\$AWK" || AWK=awk
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-# The default lists apply if the user does not specify any file.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=?*)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
-    ac_shift=:
-    ;;
-  --*=)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=
-    ac_shift=:
-    ;;
-  *)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
-    ;;
-  esac
-
-  case $ac_option in
-  # Handling of the options.
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
-    $as_echo "$ac_cs_version"; exit ;;
-  --config | --confi | --conf | --con | --co | --c )
-    $as_echo "$ac_cs_config"; exit ;;
-  --debug | --debu | --deb | --de | --d | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    case $ac_optarg in
-    *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    '') as_fn_error $? "missing file argument" ;;
-    esac
-    as_fn_append CONFIG_FILES " '$ac_optarg'"
-    ac_need_defaults=false;;
-  --he | --h |  --help | --hel | -h )
-    $as_echo "$ac_cs_usage"; exit ;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
-
-  # This is an error.
-  -*) as_fn_error $? "unrecognized option: \`$1'
-Try \`$0 --help' for more information." ;;
-
-  *) as_fn_append ac_config_targets " $1"
-     ac_need_defaults=false ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-if \$ac_cs_recheck; then
-  set X $SHELL '$0' $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
-  shift
-  \$as_echo "running CONFIG_SHELL=$SHELL \$*" >&6
-  CONFIG_SHELL='$SHELL'
-  export CONFIG_SHELL
-  exec "\$@"
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-  $as_echo "$ac_log"
-} >&5
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-
-# Handling of arguments.
-for ac_config_target in $ac_config_targets
-do
-  case $ac_config_target in
-    "icudefs.mk") CONFIG_FILES="$CONFIG_FILES icudefs.mk" ;;
-    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-    "data/pkgdataMakefile") CONFIG_FILES="$CONFIG_FILES data/pkgdataMakefile" ;;
-    "config/Makefile.inc") CONFIG_FILES="$CONFIG_FILES config/Makefile.inc" ;;
-    "config/icu.pc") CONFIG_FILES="$CONFIG_FILES config/icu.pc" ;;
-    "config/pkgdataMakefile") CONFIG_FILES="$CONFIG_FILES config/pkgdataMakefile" ;;
-    "data/Makefile") CONFIG_FILES="$CONFIG_FILES data/Makefile" ;;
-    "stubdata/Makefile") CONFIG_FILES="$CONFIG_FILES stubdata/Makefile" ;;
-    "common/Makefile") CONFIG_FILES="$CONFIG_FILES common/Makefile" ;;
-    "i18n/Makefile") CONFIG_FILES="$CONFIG_FILES i18n/Makefile" ;;
-    "layout/Makefile") CONFIG_FILES="$CONFIG_FILES layout/Makefile" ;;
-    "layoutex/Makefile") CONFIG_FILES="$CONFIG_FILES layoutex/Makefile" ;;
-    "io/Makefile") CONFIG_FILES="$CONFIG_FILES io/Makefile" ;;
-    "extra/Makefile") CONFIG_FILES="$CONFIG_FILES extra/Makefile" ;;
-    "extra/uconv/Makefile") CONFIG_FILES="$CONFIG_FILES extra/uconv/Makefile" ;;
-    "extra/uconv/pkgdataMakefile") CONFIG_FILES="$CONFIG_FILES extra/uconv/pkgdataMakefile" ;;
-    "extra/scrptrun/Makefile") CONFIG_FILES="$CONFIG_FILES extra/scrptrun/Makefile" ;;
-    "tools/Makefile") CONFIG_FILES="$CONFIG_FILES tools/Makefile" ;;
-    "tools/ctestfw/Makefile") CONFIG_FILES="$CONFIG_FILES tools/ctestfw/Makefile" ;;
-    "tools/toolutil/Makefile") CONFIG_FILES="$CONFIG_FILES tools/toolutil/Makefile" ;;
-    "tools/makeconv/Makefile") CONFIG_FILES="$CONFIG_FILES tools/makeconv/Makefile" ;;
-    "tools/genrb/Makefile") CONFIG_FILES="$CONFIG_FILES tools/genrb/Makefile" ;;
-    "tools/genccode/Makefile") CONFIG_FILES="$CONFIG_FILES tools/genccode/Makefile" ;;
-    "tools/gencmn/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gencmn/Makefile" ;;
-    "tools/gencnval/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gencnval/Makefile" ;;
-    "tools/gendict/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gendict/Makefile" ;;
-    "tools/gentest/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gentest/Makefile" ;;
-    "tools/gennorm2/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gennorm2/Makefile" ;;
-    "tools/genbrk/Makefile") CONFIG_FILES="$CONFIG_FILES tools/genbrk/Makefile" ;;
-    "tools/gensprep/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gensprep/Makefile" ;;
-    "tools/icuinfo/Makefile") CONFIG_FILES="$CONFIG_FILES tools/icuinfo/Makefile" ;;
-    "tools/icupkg/Makefile") CONFIG_FILES="$CONFIG_FILES tools/icupkg/Makefile" ;;
-    "tools/icuswap/Makefile") CONFIG_FILES="$CONFIG_FILES tools/icuswap/Makefile" ;;
-    "tools/pkgdata/Makefile") CONFIG_FILES="$CONFIG_FILES tools/pkgdata/Makefile" ;;
-    "tools/tzcode/Makefile") CONFIG_FILES="$CONFIG_FILES tools/tzcode/Makefile" ;;
-    "tools/gencfu/Makefile") CONFIG_FILES="$CONFIG_FILES tools/gencfu/Makefile" ;;
-    "test/Makefile") CONFIG_FILES="$CONFIG_FILES test/Makefile" ;;
-    "test/compat/Makefile") CONFIG_FILES="$CONFIG_FILES test/compat/Makefile" ;;
-    "test/testdata/Makefile") CONFIG_FILES="$CONFIG_FILES test/testdata/Makefile" ;;
-    "test/testdata/pkgdataMakefile") CONFIG_FILES="$CONFIG_FILES test/testdata/pkgdataMakefile" ;;
-    "test/hdrtst/Makefile") CONFIG_FILES="$CONFIG_FILES test/hdrtst/Makefile" ;;
-    "test/intltest/Makefile") CONFIG_FILES="$CONFIG_FILES test/intltest/Makefile" ;;
-    "test/cintltst/Makefile") CONFIG_FILES="$CONFIG_FILES test/cintltst/Makefile" ;;
-    "test/iotest/Makefile") CONFIG_FILES="$CONFIG_FILES test/iotest/Makefile" ;;
-    "test/letest/Makefile") CONFIG_FILES="$CONFIG_FILES test/letest/Makefile" ;;
-    "test/perf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/Makefile" ;;
-    "test/perf/collationperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/collationperf/Makefile" ;;
-    "test/perf/collperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/collperf/Makefile" ;;
-    "test/perf/collperf2/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/collperf2/Makefile" ;;
-    "test/perf/dicttrieperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/dicttrieperf/Makefile" ;;
-    "test/perf/ubrkperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/ubrkperf/Makefile" ;;
-    "test/perf/charperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/charperf/Makefile" ;;
-    "test/perf/convperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/convperf/Makefile" ;;
-    "test/perf/normperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/normperf/Makefile" ;;
-    "test/perf/DateFmtPerf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/DateFmtPerf/Makefile" ;;
-    "test/perf/howExpensiveIs/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/howExpensiveIs/Makefile" ;;
-    "test/perf/strsrchperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/strsrchperf/Makefile" ;;
-    "test/perf/unisetperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/unisetperf/Makefile" ;;
-    "test/perf/usetperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/usetperf/Makefile" ;;
-    "test/perf/ustrperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/ustrperf/Makefile" ;;
-    "test/perf/utfperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/utfperf/Makefile" ;;
-    "test/perf/utrie2perf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/utrie2perf/Makefile" ;;
-    "test/perf/leperf/Makefile") CONFIG_FILES="$CONFIG_FILES test/perf/leperf/Makefile" ;;
-    "samples/Makefile") CONFIG_FILES="$CONFIG_FILES samples/Makefile" ;;
-    "samples/date/Makefile") CONFIG_FILES="$CONFIG_FILES samples/date/Makefile" ;;
-    "samples/cal/Makefile") CONFIG_FILES="$CONFIG_FILES samples/cal/Makefile" ;;
-    "samples/layout/Makefile") CONFIG_FILES="$CONFIG_FILES samples/layout/Makefile" ;;
-
-  *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
-  esac
-done
-
-
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-fi
-
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason against having it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Hook for its removal unless debugging.
-# Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
-$debug ||
-{
-  tmp= ac_tmp=
-  trap 'exit_status=$?
-  : "${ac_tmp:=$tmp}"
-  { test ! -d "$ac_tmp" || rm -fr "$ac_tmp"; } && exit $exit_status
-' 0
-  trap 'as_fn_exit 1' 1 2 13 15
-}
-# Create a (secure) tmp directory for tmp files.
-
-{
-  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
-  test -d "$tmp"
-}  ||
-{
-  tmp=./conf$$-$RANDOM
-  (umask 077 && mkdir "$tmp")
-} || as_fn_error $? "cannot create a temporary directory in ." "$LINENO" 5
-ac_tmp=$tmp
-
-# Set up the scripts for CONFIG_FILES section.
-# No need to generate them if there are no CONFIG_FILES.
-# This happens for instance with `./config.status config.h'.
-if test -n "$CONFIG_FILES"; then
-
-
-ac_cr=`echo X | tr X '\015'`
-# On cygwin, bash can eat \r inside `` if the user requested igncr.
-# But we know of no other shell where ac_cr would be empty at this
-# point, so we can use a bashism as a fallback.
-if test "x$ac_cr" = x; then
-  eval ac_cr=\$\'\\r\'
-fi
-ac_cs_awk_cr=`$AWK 'BEGIN { print "a\rb" }' </dev/null 2>/dev/null`
-if test "$ac_cs_awk_cr" = "a${ac_cr}b"; then
-  ac_cs_awk_cr='\\r'
-else
-  ac_cs_awk_cr=$ac_cr
-fi
-
-echo 'BEGIN {' >"$ac_tmp/subs1.awk" &&
-_ACEOF
-
-
-{
-  echo "cat >conf$$subs.awk <<_ACEOF" &&
-  echo "$ac_subst_vars" | sed 's/.*/&!$&$ac_delim/' &&
-  echo "_ACEOF"
-} >conf$$subs.sh ||
-  as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
-ac_delim_num=`echo "$ac_subst_vars" | grep -c '^'`
-ac_delim='%!_!# '
-for ac_last_try in false false false false false :; do
-  . ./conf$$subs.sh ||
-    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
-
-  ac_delim_n=`sed -n "s/.*$ac_delim\$/X/p" conf$$subs.awk | grep -c X`
-  if test $ac_delim_n = $ac_delim_num; then
-    break
-  elif $ac_last_try; then
-    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
-  else
-    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
-  fi
-done
-rm -f conf$$subs.sh
-
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-cat >>"\$ac_tmp/subs1.awk" <<\\_ACAWK &&
-_ACEOF
-sed -n '
-h
-s/^/S["/; s/!.*/"]=/
-p
-g
-s/^[^!]*!//
-:repl
-t repl
-s/'"$ac_delim"'$//
-t delim
-:nl
-h
-s/\(.\{148\}\)..*/\1/
-t more1
-s/["\\]/\\&/g; s/^/"/; s/$/\\n"\\/
-p
-n
-b repl
-:more1
-s/["\\]/\\&/g; s/^/"/; s/$/"\\/
-p
-g
-s/.\{148\}//
-t nl
-:delim
-h
-s/\(.\{148\}\)..*/\1/
-t more2
-s/["\\]/\\&/g; s/^/"/; s/$/"/
-p
-b
-:more2
-s/["\\]/\\&/g; s/^/"/; s/$/"\\/
-p
-g
-s/.\{148\}//
-t delim
-' <conf$$subs.awk | sed '
-/^[^""]/{
-  N
-  s/\n//
-}
-' >>$CONFIG_STATUS || ac_write_fail=1
-rm -f conf$$subs.awk
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-_ACAWK
-cat >>"\$ac_tmp/subs1.awk" <<_ACAWK &&
-  for (key in S) S_is_set[key] = 1
-  FS = ""
-
-}
-{
-  line = $ 0
-  nfields = split(line, field, "@")
-  substed = 0
-  len = length(field[1])
-  for (i = 2; i < nfields; i++) {
-    key = field[i]
-    keylen = length(key)
-    if (S_is_set[key]) {
-      value = S[key]
-      line = substr(line, 1, len) "" value "" substr(line, len + keylen + 3)
-      len += length(value) + length(field[++i])
-      substed = 1
-    } else
-      len += 1 + keylen
-  }
-
-  print line
-}
-
-_ACAWK
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-if sed "s/$ac_cr//" < /dev/null > /dev/null 2>&1; then
-  sed "s/$ac_cr\$//; s/$ac_cr/$ac_cs_awk_cr/g"
-else
-  cat
-fi < "$ac_tmp/subs1.awk" > "$ac_tmp/subs.awk" \
-  || as_fn_error $? "could not setup config files machinery" "$LINENO" 5
-_ACEOF
-
-# VPATH may cause trouble with some makes, so we remove sole $(srcdir),
-# ${srcdir} and @srcdir@ entries from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=[	 ]*/{
-h
-s///
-s/^/:/
-s/[	 ]*$/:/
-s/:\$(srcdir):/:/g
-s/:\${srcdir}:/:/g
-s/:@srcdir@:/:/g
-s/^:*//
-s/:*$//
-x
-s/\(=[	 ]*\).*/\1/
-G
-s/\n//
-s/^[^=]*=[	 ]*$//
-}'
-fi
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-fi # test -n "$CONFIG_FILES"
-
-
-eval set X "  :F $CONFIG_FILES      "
-shift
-for ac_tag
-do
-  case $ac_tag in
-  :[FHLC]) ac_mode=$ac_tag; continue;;
-  esac
-  case $ac_mode$ac_tag in
-  :[FHL]*:*);;
-  :L* | :C*:*) as_fn_error $? "invalid tag \`$ac_tag'" "$LINENO" 5;;
-  :[FH]-) ac_tag=-:-;;
-  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
-  esac
-  ac_save_IFS=$IFS
-  IFS=:
-  set x $ac_tag
-  IFS=$ac_save_IFS
-  shift
-  ac_file=$1
-  shift
-
-  case $ac_mode in
-  :L) ac_source=$1;;
-  :[FH])
-    ac_file_inputs=
-    for ac_f
-    do
-      case $ac_f in
-      -) ac_f="$ac_tmp/stdin";;
-      *) # Look for the file first in the build tree, then in the source tree
-	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
-	 test -f "$ac_f" ||
-	   case $ac_f in
-	   [\\/$]*) false;;
-	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
-	   esac ||
-	   as_fn_error 1 "cannot find input file: \`$ac_f'" "$LINENO" 5;;
-      esac
-      case $ac_f in *\'*) ac_f=`$as_echo "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
-      as_fn_append ac_file_inputs " '$ac_f'"
-    done
-
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
-    # use $as_me), people would be surprised to read:
-    #    /* config.h.  Generated by config.status.  */
-    configure_input='Generated from '`
-	  $as_echo "$*" | sed 's|^[^:]*/||;s|:[^:]*/|, |g'
-	`' by configure.'
-    if test x"$ac_file" != x-; then
-      configure_input="$ac_file.  $configure_input"
-      { $as_echo "$as_me:${as_lineno-$LINENO}: creating $ac_file" >&5
-$as_echo "$as_me: creating $ac_file" >&6;}
-    fi
-    # Neutralize special characters interpreted by sed in replacement strings.
-    case $configure_input in #(
-    *\&* | *\|* | *\\* )
-       ac_sed_conf_input=`$as_echo "$configure_input" |
-       sed 's/[\\\\&|]/\\\\&/g'`;; #(
-    *) ac_sed_conf_input=$configure_input;;
-    esac
-
-    case $ac_tag in
-    *:-:* | *:-) cat >"$ac_tmp/stdin" \
-      || as_fn_error $? "could not create $ac_file" "$LINENO" 5 ;;
-    esac
-    ;;
-  esac
-
-  ac_dir=`$as_dirname -- "$ac_file" ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  as_dir="$ac_dir"; as_fn_mkdir_p
-  ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`$as_echo "$ac_dir" | sed 's|^\.[\\/]||'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`$as_echo "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-
-  case $ac_mode in
-  :F)
-  #
-  # CONFIG_FILE
-  #
-
-  case $INSTALL in
-  [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
-  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
-  esac
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-# If the template does not know about datarootdir, expand it.
-# FIXME: This hack should be removed a few years after 2.60.
-ac_datarootdir_hack=; ac_datarootdir_seen=
-ac_sed_dataroot='
-/datarootdir/ {
-  p
-  q
-}
-/@datadir@/p
-/@docdir@/p
-/@infodir@/p
-/@localedir@/p
-/@mandir@/p'
-case `eval "sed -n \"\$ac_sed_dataroot\" $ac_file_inputs"` in
-*datarootdir*) ac_datarootdir_seen=yes;;
-*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
-  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
-$as_echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-  ac_datarootdir_hack='
-  s&@datadir@&$datadir&g
-  s&@docdir@&$docdir&g
-  s&@infodir@&$infodir&g
-  s&@localedir@&$localedir&g
-  s&@mandir@&$mandir&g
-  s&\\\${datarootdir}&$datarootdir&g' ;;
-esac
-_ACEOF
-
-# Neutralize VPATH when `$srcdir' = `.'.
-# Shell code in configure.ac might set extrasub.
-# FIXME: do we really want to maintain this feature?
-cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
-ac_sed_extra="$ac_vpsub
-$extrasub
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s|@configure_input@|$ac_sed_conf_input|;t t
-s&@top_builddir@&$ac_top_builddir_sub&;t t
-s&@top_build_prefix@&$ac_top_build_prefix&;t t
-s&@srcdir@&$ac_srcdir&;t t
-s&@abs_srcdir@&$ac_abs_srcdir&;t t
-s&@top_srcdir@&$ac_top_srcdir&;t t
-s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
-s&@builddir@&$ac_builddir&;t t
-s&@abs_builddir@&$ac_abs_builddir&;t t
-s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
-s&@INSTALL@&$ac_INSTALL&;t t
-$ac_datarootdir_hack
-"
-eval sed \"\$ac_sed_extra\" "$ac_file_inputs" | $AWK -f "$ac_tmp/subs.awk" \
-  >$ac_tmp/out || as_fn_error $? "could not create $ac_file" "$LINENO" 5
-
-test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
-  { ac_out=`sed -n '/\${datarootdir}/p' "$ac_tmp/out"`; test -n "$ac_out"; } &&
-  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' \
-      "$ac_tmp/out"`; test -z "$ac_out"; } &&
-  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined" >&5
-$as_echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined" >&2;}
-
-  rm -f "$ac_tmp/stdin"
-  case $ac_file in
-  -) cat "$ac_tmp/out" && rm -f "$ac_tmp/out";;
-  *) rm -f "$ac_file" && mv "$ac_tmp/out" "$ac_file";;
-  esac \
-  || as_fn_error $? "could not create $ac_file" "$LINENO" 5
- ;;
-
-
-
-  esac
-
-done # for ac_tag
-
-
-as_fn_exit 0
-_ACEOF
-ac_clean_files=$ac_clean_files_save
-
-test $ac_write_fail = 0 ||
-  as_fn_error $? "write failure creating $CONFIG_STATUS" "$LINENO" 5
-
-
-# configure is writing to config.log, and then calls config.status.
-# config.status does its own redirection, appending to config.log.
-# Unfortunately, on DOS this fails, as config.log is still kept open
-# by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
-# effectively closing config.log, so it can be properly (re)opened and
-# appended to by config.status.  When coming back to configure, we
-# need to make the FD available again.
-if test "$no_create" != yes; then
-  ac_cs_success=:
-  ac_config_status_args=
-  test "$silent" = yes &&
-    ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
-  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
-  exec 5>>config.log
-  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
-  # would make configure fail if this is the last instruction.
-  $ac_cs_success || as_fn_exit 1
-fi
-if test -n "$ac_unrecognized_opts" && test "$enable_option_checking" != no; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: unrecognized options: $ac_unrecognized_opts" >&5
-$as_echo "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2;}
-fi
-
-
-echo
-echo "ICU for C/C++ $VERSION is ready to be built."
-echo "=== Important Notes: ==="
-
-echo "Data Packaging: $datapackaging"
-echo " This means: $datapackaging_msg"
-echo " To locate data: $datapackaging_howfound"
-
-if test -n "`$U_MAKE -v 2>&1 | grep '^GNU Make'`"; then
-echo "Building ICU: Use a GNU make such as $U_MAKE to build ICU."
-else
-echo "** WARNING: $U_MAKE may not be GNU make."
-echo "This may cause ICU to fail to build. Please make sure that GNU make"
-echo "is in your PATH so that the configure script can detect its location."
-fi
-if test "x$AR" = "xfalse"; then
-  echo "*** WARNING: Archiver ar not found. Set AR= or fix PATH. Some builds (such as static) may fail."
-fi
-
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking the version of \"$U_MAKE\"" >&5
-$as_echo_n "checking the version of \"$U_MAKE\"... " >&6; }
-if "$U_MAKE" -f "$srcdir/config/gmakever.mk" PLATFORM="$platform"; then
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: ok" >&5
-$as_echo "ok" >&6; }
-else
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: too old or test failed - try upgrading GNU Make" >&5
-$as_echo "too old or test failed - try upgrading GNU Make" >&6; }
-fi
-
-
-if test -n "$UCONFIG_CPPFLAGS"; then
-   HDRFILE="uconfig.h.prepend"
-   echo "*** WARNING: You must set the following flags before code compiled against this ICU will function properly:"
-   echo
-   echo "   ${UCONFIG_CPPFLAGS}"
-   echo
-   echo 'The recommended way to do this is to prepend the following lines to source/common/unicode/uconfig.h or #include them near the top of that file.'
-   echo "Creating the file ${HDRFILE}"
-   echo
-   echo '---------------   ' "${HDRFILE}"
-   echo > "${HDRFILE}"
-   echo '/* ICU customizations: put these lines at the top of uconfig.h */' >> "${HDRFILE}"
-   echo >> "${HDRFILE}"
-   for flag in ${UCONFIG_CPPFLAGS};
-   do
-        echo " /* $flag */" >> "${HDRFILE}"
-        case "${flag}" in
-        -D*=*)
-           \echo "${flag}" | sed -n 's%-D\([^=]*\)=%#define \1 %p' >> "${HDRFILE}"
-          \echo >> "${HDRFILE}"
-          ;;
-        -D*)
-           \echo "${flag}" | sed -n 's%-D\([^=]*\)%#define \1 %p' >> "${HDRFILE}"
-          \echo >> "${HDRFILE}"
-          ;;
-        *)
-          \echo "/*  Not sure how to handle this argument: ${flag} */" >> "${HDRFILE}"
-          \echo >> "${HDRFILE}"
-          ;;
-        esac
-   done
-   cat "${HDRFILE}"
-   \echo  "/* End of ${HDRFILE} ------------ */" >> "${HDRFILE}"
-   echo >> "${HDRFILE}"
-   echo '--------------- end ' "${HDRFILE}"
-fi
-
-
-if test -n "$UCONFIG_CFLAGS"; then
-   echo "C   apps may want to build with CFLAGS   = ${UCONFIG_CFLAGS}"
-fi
-
-if test -n "$UCONFIG_CXXFLAGS"; then
-   echo "C++ apps may want to build with CXXFLAGS = ${UCONFIG_CXXFLAGS}"
-fi
-
-if test "$tools" = false;
-then
-        echo "## Note: you have disabled ICU's tools. This ICU cannot build its own data or tests."
-        echo "## Expect build failures in the 'data', 'test', and other directories."
-fi
-
-$as_unset _CXX_CXXSUFFIX
diff --git a/intl/icu/source/i18n/timezone.cpp.orig b/intl/icu/source/i18n/timezone.cpp.orig
deleted file mode 100644
--- a/intl/icu/source/i18n/timezone.cpp.orig
+++ /dev/null
@@ -1,1698 +0,0 @@
-/*
-*******************************************************************************
-* Copyright (C) 1997-2015, International Business Machines Corporation and
-* others. All Rights Reserved.
-*******************************************************************************
-*
-* File TIMEZONE.CPP
-*
-* Modification History:
-*
-*   Date        Name        Description
-*   12/05/96    clhuang     Creation.
-*   04/21/97    aliu        General clean-up and bug fixing.
-*   05/08/97    aliu        Fixed Hashtable code per code review.
-*   07/09/97    helena      Changed createInstance to createDefault.
-*   07/29/97    aliu        Updated with all-new list of 96 UNIX-derived
-*                           TimeZones.  Changed mechanism to load from static
-*                           array rather than resource bundle.
-*   07/07/1998  srl         Bugfixes from the Java side: UTC GMT CAT NST
-*                           Added getDisplayName API
-*                           going to add custom parsing.
-*
-*                           ISSUES:
-*                               - should getDisplayName cache something?
-*                               - should custom time zones be cached? [probably]
-*  08/10/98     stephen     Brought getDisplayName() API in-line w/ conventions
-*  08/19/98     stephen     Changed createTimeZone() to never return 0
-*  09/02/98     stephen     Added getOffset(monthLen) and hasSameRules()
-*  09/15/98     stephen     Added getStaticClassID()
-*  02/22/99     stephen     Removed character literals for EBCDIC safety
-*  05/04/99     stephen     Changed initDefault() for Mutex issues
-*  07/12/99     helena      HPUX 11 CC Port.
-*  12/03/99     aliu        Moved data out of static table into icudata.dll.
-*                           Substantial rewrite of zone lookup, default zone, and
-*                           available IDs code.  Misc. cleanup.
-*********************************************************************************/
-
-#include "utypeinfo.h"  // for 'typeid' to work
-
-#include "unicode/utypes.h"
-#include "unicode/ustring.h"
-#include "uassert.h"
-#include "ustr_imp.h"
-
-#ifdef U_DEBUG_TZ
-# include <stdio.h>
-# include "uresimp.h" // for debugging
-
-static void debug_tz_loc(const char *f, int32_t l)
-{
-  fprintf(stderr, "%s:%d: ", f, l);
-}
-
-static void debug_tz_msg(const char *pat, ...)
-{
-  va_list ap;
-  va_start(ap, pat);
-  vfprintf(stderr, pat, ap);
-  fflush(stderr);
-}
-static char gStrBuf[256];
-#define U_DEBUG_TZ_STR(x) u_austrncpy(gStrBuf,x,sizeof(gStrBuf)-1)
-// must use double parens, i.e.:  U_DEBUG_TZ_MSG(("four is: %d",4));
-#define U_DEBUG_TZ_MSG(x) {debug_tz_loc(__FILE__,__LINE__);debug_tz_msg x;}
-#else
-#define U_DEBUG_TZ_MSG(x)
-#endif
-
-#if !UCONFIG_NO_FORMATTING
-
-#include "unicode/simpletz.h"
-#include "unicode/calendar.h"
-#include "unicode/gregocal.h"
-#include "unicode/ures.h"
-#include "unicode/tzfmt.h"
-#include "unicode/numfmt.h"
-#include "gregoimp.h"
-#include "uresimp.h" // struct UResourceBundle
-#include "olsontz.h"
-#include "mutex.h"
-#include "unicode/udata.h"
-#include "ucln_in.h"
-#include "cstring.h"
-#include "cmemory.h"
-#include "unicode/strenum.h"
-#include "uassert.h"
-#include "zonemeta.h"
-
-#define kZONEINFO "zoneinfo64"
-#define kREGIONS  "Regions"
-#define kZONES    "Zones"
-#define kRULES    "Rules"
-#define kNAMES    "Names"
-#define kTZVERSION  "TZVersion"
-#define kLINKS    "links"
-#define kMAX_CUSTOM_HOUR    23
-#define kMAX_CUSTOM_MIN     59
-#define kMAX_CUSTOM_SEC     59
-#define MINUS 0x002D
-#define PLUS 0x002B
-#define ZERO_DIGIT 0x0030
-#define COLON 0x003A
-
-// Static data and constants
-
-static const UChar         WORLD[] = {0x30, 0x30, 0x31, 0x00}; /* "001" */
-
-static const UChar         GMT_ID[] = {0x47, 0x4D, 0x54, 0x00}; /* "GMT" */
-static const UChar         UNKNOWN_ZONE_ID[] = {0x45, 0x74, 0x63, 0x2F, 0x55, 0x6E, 0x6B, 0x6E, 0x6F, 0x77, 0x6E, 0x00}; /* "Etc/Unknown" */
-static const int32_t       GMT_ID_LENGTH = 3;
-static const int32_t       UNKNOWN_ZONE_ID_LENGTH = 11;
-
-static icu::TimeZone* DEFAULT_ZONE = NULL;
-static icu::UInitOnce gDefaultZoneInitOnce = U_INITONCE_INITIALIZER;
-
-static icu::TimeZone* _GMT = NULL;
-static icu::TimeZone* _UNKNOWN_ZONE = NULL;
-static icu::UInitOnce gStaticZonesInitOnce = U_INITONCE_INITIALIZER;
-
-static char TZDATA_VERSION[16];
-static icu::UInitOnce gTZDataVersionInitOnce = U_INITONCE_INITIALIZER;
-
-static int32_t* MAP_SYSTEM_ZONES = NULL;
-static int32_t* MAP_CANONICAL_SYSTEM_ZONES = NULL;
-static int32_t* MAP_CANONICAL_SYSTEM_LOCATION_ZONES = NULL;
-
-static int32_t LEN_SYSTEM_ZONES = 0;
-static int32_t LEN_CANONICAL_SYSTEM_ZONES = 0;
-static int32_t LEN_CANONICAL_SYSTEM_LOCATION_ZONES = 0;
-
-static icu::UInitOnce gSystemZonesInitOnce = U_INITONCE_INITIALIZER;
-static icu::UInitOnce gCanonicalZonesInitOnce = U_INITONCE_INITIALIZER;
-static icu::UInitOnce gCanonicalLocationZonesInitOnce = U_INITONCE_INITIALIZER;
-
-U_CDECL_BEGIN
-static UBool U_CALLCONV timeZone_cleanup(void)
-{
-    U_NAMESPACE_USE
-    delete DEFAULT_ZONE;
-    DEFAULT_ZONE = NULL;
-    gDefaultZoneInitOnce.reset();
-
-    delete _GMT;
-    _GMT = NULL;
-    delete _UNKNOWN_ZONE;
-    _UNKNOWN_ZONE = NULL;
-    gStaticZonesInitOnce.reset();
-
-    uprv_memset(TZDATA_VERSION, 0, sizeof(TZDATA_VERSION));
-    gTZDataVersionInitOnce.reset();
-
-    LEN_SYSTEM_ZONES = 0;
-    uprv_free(MAP_SYSTEM_ZONES);
-    MAP_SYSTEM_ZONES = 0;
-    gSystemZonesInitOnce.reset();
-
-    LEN_CANONICAL_SYSTEM_ZONES = 0;
-    uprv_free(MAP_CANONICAL_SYSTEM_ZONES);
-    MAP_CANONICAL_SYSTEM_ZONES = 0;
-    gCanonicalZonesInitOnce.reset();
-
-    LEN_CANONICAL_SYSTEM_LOCATION_ZONES = 0;
-    uprv_free(MAP_CANONICAL_SYSTEM_LOCATION_ZONES);
-    MAP_CANONICAL_SYSTEM_LOCATION_ZONES = 0;
-    gCanonicalLocationZonesInitOnce.reset();
-
-    return TRUE;
-}
-U_CDECL_END
-
-U_NAMESPACE_BEGIN
-
-static int32_t findInStringArray(UResourceBundle* array, const UnicodeString& id, UErrorCode &status)
-{
-    UnicodeString copy;
-    const UChar *u;
-    int32_t len;
-
-    int32_t start = 0;
-    int32_t limit = ures_getSize(array);
-    int32_t mid;
-    int32_t lastMid = INT32_MAX;
-    if(U_FAILURE(status) || (limit < 1)) {
-        return -1;
-    }
-    U_DEBUG_TZ_MSG(("fisa: Looking for %s, between %d and %d\n", U_DEBUG_TZ_STR(UnicodeString(id).getTerminatedBuffer()), start, limit));
-
-    for (;;) {
-        mid = (int32_t)((start + limit) / 2);
-        if (lastMid == mid) {   /* Have we moved? */
-            break;  /* We haven't moved, and it wasn't found. */
-        }
-        lastMid = mid;
-        u = ures_getStringByIndex(array, mid, &len, &status);
-        if (U_FAILURE(status)) {
-            break;
-        }
-        U_DEBUG_TZ_MSG(("tz: compare to %s, %d .. [%d] .. %d\n", U_DEBUG_TZ_STR(u), start, mid, limit));
-        copy.setTo(TRUE, u, len);
-        int r = id.compare(copy);
-        if(r==0) {
-            U_DEBUG_TZ_MSG(("fisa: found at %d\n", mid));
-            return mid;
-        } else if(r<0) {
-            limit = mid;
-        } else {
-            start = mid;
-        }
-    }
-    U_DEBUG_TZ_MSG(("fisa: not found\n"));
-    return -1;
-}
-
-/**
- * Fetch a specific zone by name.  Replaces the getByKey call.
- * @param top Top timezone resource
- * @param id Time zone ID
- * @param oldbundle Bundle for reuse (or NULL).   see 'ures_open()'
- * @return the zone's bundle if found, or undefined if error.  Reuses oldbundle.
- */
-static UResourceBundle* getZoneByName(const UResourceBundle* top, const UnicodeString& id, UResourceBundle *oldbundle, UErrorCode& status) {
-    // load the Rules object
-    UResourceBundle *tmp = ures_getByKey(top, kNAMES, NULL, &status);
-
-    // search for the string
-    int32_t idx = findInStringArray(tmp, id, status);
-
-    if((idx == -1) && U_SUCCESS(status)) {
-        // not found
-        status = U_MISSING_RESOURCE_ERROR;
-        //ures_close(oldbundle);
-        //oldbundle = NULL;
-    } else {
-        U_DEBUG_TZ_MSG(("gzbn: oldbundle= size %d, type %d, %s\n", ures_getSize(tmp), ures_getType(tmp), u_errorName(status)));
-        tmp = ures_getByKey(top, kZONES, tmp, &status); // get Zones object from top
-        U_DEBUG_TZ_MSG(("gzbn: loaded ZONES, size %d, type %d, path %s %s\n", ures_getSize(tmp), ures_getType(tmp), ures_getPath(tmp), u_errorName(status)));
-        oldbundle = ures_getByIndex(tmp, idx, oldbundle, &status); // get nth Zone object
-        U_DEBUG_TZ_MSG(("gzbn: loaded z#%d, size %d, type %d, path %s, %s\n", idx, ures_getSize(oldbundle), ures_getType(oldbundle), ures_getPath(oldbundle),  u_errorName(status)));
-    }
-    ures_close(tmp);
-    if(U_FAILURE(status)) {
-        //ures_close(oldbundle);
-        return NULL;
-    } else {
-        return oldbundle;
-    }
-}
-
-
-UResourceBundle* TimeZone::loadRule(const UResourceBundle* top, const UnicodeString& ruleid, UResourceBundle* oldbundle, UErrorCode& status) {
-    char key[64];
-    ruleid.extract(0, sizeof(key)-1, key, (int32_t)sizeof(key)-1, US_INV);
-    U_DEBUG_TZ_MSG(("loadRule(%s)\n", key));
-    UResourceBundle *r = ures_getByKey(top, kRULES, oldbundle, &status);
-    U_DEBUG_TZ_MSG(("loadRule(%s) -> kRULES [%s]\n", key, u_errorName(status)));
-    r = ures_getByKey(r, key, r, &status);
-    U_DEBUG_TZ_MSG(("loadRule(%s) -> item [%s]\n", key, u_errorName(status)));
-    return r;
-}
-
-/**
- * Given an ID, open the appropriate resource for the given time zone.
- * Dereference aliases if necessary.
- * @param id zone id
- * @param res resource, which must be ready for use (initialized but not open)
- * @param ec input-output error code
- * @return top-level resource bundle
- */
-static UResourceBundle* openOlsonResource(const UnicodeString& id,
-                                          UResourceBundle& res,
-                                          UErrorCode& ec)
-{
-#if U_DEBUG_TZ
-    char buf[128];
-    id.extract(0, sizeof(buf)-1, buf, sizeof(buf), "");
-#endif
-    UResourceBundle *top = ures_openDirect(0, kZONEINFO, &ec);
-    U_DEBUG_TZ_MSG(("pre: res sz=%d\n", ures_getSize(&res)));
-    /* &res = */ getZoneByName(top, id, &res, ec);
-    // Dereference if this is an alias.  Docs say result should be 1
-    // but it is 0 in 2.8 (?).
-    U_DEBUG_TZ_MSG(("Loading zone '%s' (%s, size %d) - %s\n", buf, ures_getKey((UResourceBundle*)&res), ures_getSize(&res), u_errorName(ec)));
-    if (ures_getType(&res) == URES_INT) {
-        int32_t deref = ures_getInt(&res, &ec) + 0;
-        U_DEBUG_TZ_MSG(("getInt: %s - type is %d\n", u_errorName(ec), ures_getType(&res)));
-        UResourceBundle *ares = ures_getByKey(top, kZONES, NULL, &ec); // dereference Zones section
-        ures_getByIndex(ares, deref, &res, &ec);
-        ures_close(ares);
-        U_DEBUG_TZ_MSG(("alias to #%d (%s) - %s\n", deref, "??", u_errorName(ec)));
-    } else {
-        U_DEBUG_TZ_MSG(("not an alias - size %d\n", ures_getSize(&res)));
-    }
-    U_DEBUG_TZ_MSG(("%s - final status is %s\n", buf, u_errorName(ec)));
-    return top;
-}
-
-// -------------------------------------
-
-namespace {
-
-void U_CALLCONV initStaticTimeZones() {
-    // Initialize _GMT independently of other static data; it should
-    // be valid even if we can't load the time zone UDataMemory.
-    ucln_i18n_registerCleanup(UCLN_I18N_TIMEZONE, timeZone_cleanup);
-    _UNKNOWN_ZONE = new SimpleTimeZone(0, UnicodeString(TRUE, UNKNOWN_ZONE_ID, UNKNOWN_ZONE_ID_LENGTH));
-    _GMT = new SimpleTimeZone(0, UnicodeString(TRUE, GMT_ID, GMT_ID_LENGTH));
-}
-
-}  // anonymous namespace
-
-const TimeZone& U_EXPORT2
-TimeZone::getUnknown()
-{
-    umtx_initOnce(gStaticZonesInitOnce, &initStaticTimeZones);
-    return *_UNKNOWN_ZONE;
-}
-
-const TimeZone* U_EXPORT2
-TimeZone::getGMT(void)
-{
-    umtx_initOnce(gStaticZonesInitOnce, &initStaticTimeZones);
-    return _GMT;
-}
-
-// *****************************************************************************
-// class TimeZone
-// *****************************************************************************
-
-UOBJECT_DEFINE_ABSTRACT_RTTI_IMPLEMENTATION(TimeZone)
-
-TimeZone::TimeZone()
-    :   UObject(), fID()
-{
-}
-
-// -------------------------------------
-
-TimeZone::TimeZone(const UnicodeString &id)
-    :   UObject(), fID(id)
-{
-}
-
-// -------------------------------------
-
-TimeZone::~TimeZone()
-{
-}
-
-// -------------------------------------
-
-TimeZone::TimeZone(const TimeZone &source)
-    :   UObject(source), fID(source.fID)
-{
-}
-
-// -------------------------------------
-
-TimeZone &
-TimeZone::operator=(const TimeZone &right)
-{
-    if (this != &right) fID = right.fID;
-    return *this;
-}
-
-// -------------------------------------
-
-UBool
-TimeZone::operator==(const TimeZone& that) const
-{
-    return typeid(*this) == typeid(that) &&
-        fID == that.fID;
-}
-
-// -------------------------------------
-
-namespace {
-TimeZone*
-createSystemTimeZone(const UnicodeString& id, UErrorCode& ec) {
-    if (U_FAILURE(ec)) {
-        return NULL;
-    }
-    TimeZone* z = 0;
-    UResourceBundle res;
-    ures_initStackObject(&res);
-    U_DEBUG_TZ_MSG(("pre-err=%s\n", u_errorName(ec)));
-    UResourceBundle *top = openOlsonResource(id, res, ec);
-    U_DEBUG_TZ_MSG(("post-err=%s\n", u_errorName(ec)));
-    if (U_SUCCESS(ec)) {
-        z = new OlsonTimeZone(top, &res, id, ec);
-        if (z == NULL) {
-          U_DEBUG_TZ_MSG(("cstz: olson time zone failed to initialize - err %s\n", u_errorName(ec)));
-        }
-    }
-    ures_close(&res);
-    ures_close(top);
-    if (U_FAILURE(ec)) {
-        U_DEBUG_TZ_MSG(("cstz: failed to create, err %s\n", u_errorName(ec)));
-        delete z;
-        z = 0;
-    }
-    return z;
-}
-
-/**
- * Lookup the given name in our system zone table.  If found,
- * instantiate a new zone of that name and return it.  If not
- * found, return 0.
- */
-TimeZone*
-createSystemTimeZone(const UnicodeString& id) {
-    UErrorCode ec = U_ZERO_ERROR;
-    return createSystemTimeZone(id, ec);
-}
-
-}
-
-TimeZone* U_EXPORT2
-TimeZone::createTimeZone(const UnicodeString& ID)
-{
-    /* We first try to lookup the zone ID in our system list.  If this
-     * fails, we try to parse it as a custom string GMT[+-]hh:mm.  If
-     * all else fails, we return GMT, which is probably not what the
-     * user wants, but at least is a functioning TimeZone object.
-     *
-     * We cannot return NULL, because that would break compatibility
-     * with the JDK.
-     */
-    TimeZone* result = createSystemTimeZone(ID);
-
-    if (result == NULL) {
-        U_DEBUG_TZ_MSG(("failed to load system time zone with id - falling to custom"));
-        result = createCustomTimeZone(ID);
-    }
-    if (result == NULL) {
-        U_DEBUG_TZ_MSG(("failed to load time zone with id - falling to Etc/Unknown(GMT)"));
-        const TimeZone& unknown = getUnknown();
-        if (_UNKNOWN_ZONE == NULL) {                   // Cannot test (&unknown == NULL) because the
-          U_DEBUG_TZ_MSG(("failed to getUnknown()"));  // behavior of NULL references is undefined.
-        } else {
-          result = unknown.clone();
-        }
-    }
-    return result;
-}
-
-// -------------------------------------
-
-TimeZone* U_EXPORT2
-TimeZone::detectHostTimeZone()
-{
-    // We access system timezone data through TPlatformUtilities,
-    // including tzset(), timezone, and tzname[].
-    int32_t rawOffset = 0;
-    const char *hostID;
-
-    // First, try to create a system timezone, based
-    // on the string ID in tzname[0].
-
-    uprv_tzset(); // Initialize tz... system data
-
-    uprv_tzname_clear_cache();
-
-    // Get the timezone ID from the host.  This function should do
-    // any required host-specific remapping; e.g., on Windows this
-    // function maps the Date and Time control panel setting to an
-    // ICU timezone ID.
-    hostID = uprv_tzname(0);
-
-    // Invert sign because UNIX semantics are backwards
-    rawOffset = uprv_timezone() * -U_MILLIS_PER_SECOND;
-
-    TimeZone* hostZone = NULL;
-
-    /* Make sure that the string is NULL terminated to prevent BoundsChecker/Purify warnings. */
-    UnicodeString hostStrID(hostID, -1, US_INV);
-    hostStrID.append((UChar)0);
-    hostStrID.truncate(hostStrID.length()-1);
-    hostZone = createSystemTimeZone(hostStrID);
-
-#if U_PLATFORM_USES_ONLY_WIN32_API
-    // hostID points to a heap-allocated location on Windows.
-    uprv_free(const_cast<char *>(hostID));
-#endif
-
-    int32_t hostIDLen = hostStrID.length();
-    if (hostZone != NULL && rawOffset != hostZone->getRawOffset()
-        && (3 <= hostIDLen && hostIDLen <= 4))
-    {
-        // Uh oh. This probably wasn't a good id.
-        // It was probably an ambiguous abbreviation
-        delete hostZone;
-        hostZone = NULL;
-    }
-
-    // Construct a fixed standard zone with the host's ID
-    // and raw offset.
-    if (hostZone == NULL) {
-        hostZone = new SimpleTimeZone(rawOffset, hostStrID);
-    }
-
-    // If we _still_ don't have a time zone, use GMT.
-    //
-    // Note: This is extremely unlikely situation. If
-    // new SimpleTimeZone(...) above fails, the following
-    // code may also fail.
-    if (hostZone == NULL) {
-        const TimeZone* temptz = TimeZone::getGMT();
-        // If we can't use GMT, get out.
-        if (temptz == NULL) {
-            return NULL;
-        }
-        hostZone = temptz->clone();
-    }
-
-    return hostZone;
-}
-
-// -------------------------------------
-
-/**
- * Initialize DEFAULT_ZONE from the system default time zone.  
- * Upon return, DEFAULT_ZONE will not be NULL, unless operator new()
- * returns NULL.
- */
-static void U_CALLCONV initDefault()
-{
-    ucln_i18n_registerCleanup(UCLN_I18N_TIMEZONE, timeZone_cleanup);
-
-    // If setDefault() has already been called we can skip getting the
-    // default zone information from the system.
-    if (DEFAULT_ZONE != NULL) {
-        return;
-    }
-    
-    // NOTE:  this code is safely single threaded, being only
-    // run via umtx_initOnce().
-    //
-    // Some of the locale/timezone OS functions may not be thread safe,
-    //
-    // The operating system might actually use ICU to implement timezones.
-    // So we may have ICU calling ICU here, like on AIX.
-    // There shouldn't be a problem with this; initOnce does not hold a mutex
-    // while the init function is being run.
-
-    // The code detecting the host time zone was separated from this
-    // and implemented as TimeZone::detectHostTimeZone()
-
-    TimeZone *default_zone = TimeZone::detectHostTimeZone();
-
-    // The only way for DEFAULT_ZONE to be non-null at this point is if the user
-    // made a thread-unsafe call to setDefault() or adoptDefault() in another
-    // thread while this thread was doing something that required getting the default.
-    U_ASSERT(DEFAULT_ZONE == NULL);
-
-    DEFAULT_ZONE = default_zone;
-}
-
-// -------------------------------------
-
-TimeZone* U_EXPORT2
-TimeZone::createDefault()
-{
-    umtx_initOnce(gDefaultZoneInitOnce, initDefault);
-    return (DEFAULT_ZONE != NULL) ? DEFAULT_ZONE->clone() : NULL;
-}
-
-// -------------------------------------
-
-void U_EXPORT2
-TimeZone::adoptDefault(TimeZone* zone)
-{
-    if (zone != NULL)
-    {
-        TimeZone *old = DEFAULT_ZONE;
-        DEFAULT_ZONE = zone;
-        delete old;
-        ucln_i18n_registerCleanup(UCLN_I18N_TIMEZONE, timeZone_cleanup);
-    }
-}
-// -------------------------------------
-
-void U_EXPORT2
-TimeZone::setDefault(const TimeZone& zone)
-{
-    adoptDefault(zone.clone());
-}
-
-//----------------------------------------------------------------------
-
-
-static void U_CALLCONV initMap(USystemTimeZoneType type, UErrorCode& ec) {
-    ucln_i18n_registerCleanup(UCLN_I18N_TIMEZONE, timeZone_cleanup);
-
-    UResourceBundle *res = ures_openDirect(0, kZONEINFO, &ec);
-    res = ures_getByKey(res, kNAMES, res, &ec); // dereference Zones section
-    if (U_SUCCESS(ec)) {
-        int32_t size = ures_getSize(res);
-        int32_t *m = (int32_t *)uprv_malloc(size * sizeof(int32_t));
-        if (m == NULL) {
-            ec = U_MEMORY_ALLOCATION_ERROR;
-        } else {
-            int32_t numEntries = 0;
-            for (int32_t i = 0; i < size; i++) {
-                UnicodeString id = ures_getUnicodeStringByIndex(res, i, &ec);
-                if (U_FAILURE(ec)) {
-                    break;
-                }
-                if (0 == id.compare(UNKNOWN_ZONE_ID, UNKNOWN_ZONE_ID_LENGTH)) {
-                    // exclude Etc/Unknown
-                    continue;
-                }
-                if (type == UCAL_ZONE_TYPE_CANONICAL || type == UCAL_ZONE_TYPE_CANONICAL_LOCATION) {
-                    UnicodeString canonicalID;
-                    ZoneMeta::getCanonicalCLDRID(id, canonicalID, ec);
-                    if (U_FAILURE(ec)) {
-                        break;
-                    }
-                    if (canonicalID != id) {
-                        // exclude aliases
-                        continue;
-                    }
-                }
-                if (type == UCAL_ZONE_TYPE_CANONICAL_LOCATION) {
-                    const UChar *region = TimeZone::getRegion(id, ec);
-                    if (U_FAILURE(ec)) {
-                        break;
-                    }
-                    if (u_strcmp(region, WORLD) == 0) {
-                       // exclude non-location ("001")
-                        continue;
-                    }
-                }
-                m[numEntries++] = i;
-            }
-            if (U_SUCCESS(ec)) {
-                int32_t *tmp = m;
-                m = (int32_t *)uprv_realloc(tmp, numEntries * sizeof(int32_t));
-                if (m == NULL) {
-                    // realloc failed.. use the original one even it has unused
-                    // area at the end
-                    m = tmp;
-                }
-
-                switch(type) {
-                case UCAL_ZONE_TYPE_ANY:
-                    U_ASSERT(MAP_SYSTEM_ZONES == NULL);
-                    MAP_SYSTEM_ZONES = m;
-                    LEN_SYSTEM_ZONES = numEntries;
-                    break;
-                case UCAL_ZONE_TYPE_CANONICAL:
-                    U_ASSERT(MAP_CANONICAL_SYSTEM_ZONES == NULL);
-                    MAP_CANONICAL_SYSTEM_ZONES = m;
-                    LEN_CANONICAL_SYSTEM_ZONES = numEntries;
-                    break;
-                case UCAL_ZONE_TYPE_CANONICAL_LOCATION:
-                    U_ASSERT(MAP_CANONICAL_SYSTEM_LOCATION_ZONES == NULL);
-                    MAP_CANONICAL_SYSTEM_LOCATION_ZONES = m;
-                    LEN_CANONICAL_SYSTEM_LOCATION_ZONES = numEntries;
-                    break;
-                }
-            }
-        }
-    }
-    ures_close(res);
-}
-
-
-/**
- * This is the default implementation for subclasses that do not
- * override this method.  This implementation calls through to the
- * 8-argument getOffset() method after suitable computations, and
- * correctly adjusts GMT millis to local millis when necessary.
- */
-void TimeZone::getOffset(UDate date, UBool local, int32_t& rawOffset,
-                         int32_t& dstOffset, UErrorCode& ec) const {
-    if (U_FAILURE(ec)) {
-        return;
-    }
-
-    rawOffset = getRawOffset();
-    if (!local) {
-        date += rawOffset; // now in local standard millis
-    }
-
-    // When local == TRUE, date might not be in local standard
-    // millis.  getOffset taking 7 parameters used here assume
-    // the given time in day is local standard time.
-    // At STD->DST transition, there is a range of time which
-    // does not exist.  When 'date' is in this time range
-    // (and local == TRUE), this method interprets the specified
-    // local time as DST.  At DST->STD transition, there is a
-    // range of time which occurs twice.  In this case, this
-    // method interprets the specified local time as STD.
-    // To support the behavior above, we need to call getOffset
-    // (with 7 args) twice when local == true and DST is
-    // detected in the initial call.
-    for (int32_t pass=0; ; ++pass) {
-        int32_t year, month, dom, dow;
-        double day = uprv_floor(date / U_MILLIS_PER_DAY);
-        int32_t millis = (int32_t) (date - day * U_MILLIS_PER_DAY);
-
-        Grego::dayToFields(day, year, month, dom, dow);
-
-        dstOffset = getOffset(GregorianCalendar::AD, year, month, dom,
-                              (uint8_t) dow, millis,
-                              Grego::monthLength(year, month),
-                              ec) - rawOffset;
-
-        // Recompute if local==TRUE, dstOffset!=0.
-        if (pass!=0 || !local || dstOffset == 0) {
-            break;
-        }
-        // adjust to local standard millis
-        date -= dstOffset;
-    }
-}
-
-// -------------------------------------
-
-// New available IDs API as of ICU 2.4.  Uses StringEnumeration API.
-
-class TZEnumeration : public StringEnumeration {
-private:
-
-    // Map into to zones.  Our results are zone[map[i]] for
-    // i=0..len-1, where zone[i] is the i-th Olson zone.  If map==NULL
-    // then our results are zone[i] for i=0..len-1.  Len will be zero
-    // if the zone data could not be loaded.
-    int32_t* map;
-    int32_t* localMap;
-    int32_t  len;
-    int32_t  pos;
-
-    TZEnumeration(int32_t* mapData, int32_t mapLen, UBool adoptMapData) : pos(0) {
-        map = mapData;
-        localMap = adoptMapData ? mapData : NULL;
-        len = mapLen;
-    }
-
-    UBool getID(int32_t i) {
-        UErrorCode ec = U_ZERO_ERROR;
-        int32_t idLen = 0;
-        const UChar* id = NULL;
-        UResourceBundle *top = ures_openDirect(0, kZONEINFO, &ec);
-        top = ures_getByKey(top, kNAMES, top, &ec); // dereference Zones section
-        id = ures_getStringByIndex(top, i, &idLen, &ec);
-        if(U_FAILURE(ec)) {
-            unistr.truncate(0);
-        }
-        else {
-            unistr.fastCopyFrom(UnicodeString(TRUE, id, idLen));
-        }
-        ures_close(top);
-        return U_SUCCESS(ec);
-    }
-
-    static int32_t* getMap(USystemTimeZoneType type, int32_t& len, UErrorCode& ec) {
-        len = 0;
-        if (U_FAILURE(ec)) {
-            return NULL;
-        }
-        int32_t* m = NULL;
-        switch (type) {
-        case UCAL_ZONE_TYPE_ANY:
-            umtx_initOnce(gSystemZonesInitOnce, &initMap, type, ec);
-            m = MAP_SYSTEM_ZONES;
-            len = LEN_SYSTEM_ZONES;
-            break;
-        case UCAL_ZONE_TYPE_CANONICAL:
-            umtx_initOnce(gCanonicalZonesInitOnce, &initMap, type, ec);
-            m = MAP_CANONICAL_SYSTEM_ZONES;
-            len = LEN_CANONICAL_SYSTEM_ZONES;
-            break;
-        case UCAL_ZONE_TYPE_CANONICAL_LOCATION:
-            umtx_initOnce(gCanonicalLocationZonesInitOnce, &initMap, type, ec);
-            m = MAP_CANONICAL_SYSTEM_LOCATION_ZONES;
-            len = LEN_CANONICAL_SYSTEM_LOCATION_ZONES;
-            break;
-        default:
-            ec = U_ILLEGAL_ARGUMENT_ERROR;
-            m = NULL;
-            len = 0;
-            break;
-        }
-        return m;
-    }
-
-public:
-
-#define DEFAULT_FILTERED_MAP_SIZE 8
-#define MAP_INCREMENT_SIZE 8
-
-    static TZEnumeration* create(USystemTimeZoneType type, const char* region, const int32_t* rawOffset, UErrorCode& ec) {
-        if (U_FAILURE(ec)) {
-            return NULL;
-        }
-
-        int32_t baseLen;
-        int32_t *baseMap = getMap(type, baseLen, ec);
-
-        if (U_FAILURE(ec)) {
-            return NULL;
-        }
-
-        // If any additional conditions are available,
-        // create instance local map filtered by the conditions.
-
-        int32_t *filteredMap = NULL;
-        int32_t numEntries = 0;
-
-        if (region != NULL || rawOffset != NULL) {
-            int32_t filteredMapSize = DEFAULT_FILTERED_MAP_SIZE;
-            filteredMap = (int32_t *)uprv_malloc(filteredMapSize * sizeof(int32_t));
-            if (filteredMap == NULL) {
-                ec = U_MEMORY_ALLOCATION_ERROR;
-                return NULL;
-            }
-
-            // Walk through the base map
-            UResourceBundle *res = ures_openDirect(0, kZONEINFO, &ec);
-            res = ures_getByKey(res, kNAMES, res, &ec); // dereference Zones section
-            for (int32_t i = 0; i < baseLen; i++) {
-                int32_t zidx = baseMap[i];
-                UnicodeString id = ures_getUnicodeStringByIndex(res, zidx, &ec);
-                if (U_FAILURE(ec)) {
-                    break;
-                }
-                if (region != NULL) {
-                    // Filter by region
-                    char tzregion[4]; // max 3 letters + null term
-                    TimeZone::getRegion(id, tzregion, sizeof(tzregion), ec);
-                    if (U_FAILURE(ec)) {
-                        break;
-                    }
-                    if (uprv_stricmp(tzregion, region) != 0) {
-                        // region does not match
-                        continue;
-                    }
-                }
-                if (rawOffset != NULL) {
-                    // Filter by raw offset
-                    // Note: This is VERY inefficient
-                    TimeZone *z = createSystemTimeZone(id, ec);
-                    if (U_FAILURE(ec)) {
-                        break;
-                    }
-                    int32_t tzoffset = z->getRawOffset();
-                    delete z;
-
-                    if (tzoffset != *rawOffset) {
-                        continue;
-                    }
-                }
-
-                if (filteredMapSize <= numEntries) {
-                    filteredMapSize += MAP_INCREMENT_SIZE;
-                    int32_t *tmp = (int32_t *)uprv_realloc(filteredMap, filteredMapSize * sizeof(int32_t));
-                    if (tmp == NULL) {
-                        ec = U_MEMORY_ALLOCATION_ERROR;
-                        break;
-                    } else {
-                        filteredMap = tmp;
-                    }
-                }
-
-                filteredMap[numEntries++] = zidx;
-            }
-
-            if (U_FAILURE(ec)) {
-                uprv_free(filteredMap);
-                filteredMap = NULL;
-            }
-
-            ures_close(res);
-        }
-
-        TZEnumeration *result = NULL;
-        if (U_SUCCESS(ec)) {
-            // Finally, create a new enumeration instance
-            if (filteredMap == NULL) {
-                result = new TZEnumeration(baseMap, baseLen, FALSE);
-            } else {
-                result = new TZEnumeration(filteredMap, numEntries, TRUE);
-                filteredMap = NULL;
-            }
-            if (result == NULL) {
-                ec = U_MEMORY_ALLOCATION_ERROR;
-            }
-        }
-
-        if (filteredMap != NULL) {
-            uprv_free(filteredMap);
-        }
-
-        return result;
-    }
-
-    TZEnumeration(const TZEnumeration &other) : StringEnumeration(), map(NULL), localMap(NULL), len(0), pos(0) {
-        if (other.localMap != NULL) {
-            localMap = (int32_t *)uprv_malloc(other.len * sizeof(int32_t));
-            if (localMap != NULL) {
-                len = other.len;
-                uprv_memcpy(localMap, other.localMap, len * sizeof(int32_t));
-                pos = other.pos;
-                map = localMap;
-            } else {
-                len = 0;
-                pos = 0;
-                map = NULL;
-            }
-        } else {
-            map = other.map;
-            localMap = NULL;
-            len = other.len;
-            pos = other.pos;
-        }
-    }
-
-    virtual ~TZEnumeration();
-
-    virtual StringEnumeration *clone() const {
-        return new TZEnumeration(*this);
-    }
-
-    virtual int32_t count(UErrorCode& status) const {
-        return U_FAILURE(status) ? 0 : len;
-    }
-
-    virtual const UnicodeString* snext(UErrorCode& status) {
-        if (U_SUCCESS(status) && map != NULL && pos < len) {
-            getID(map[pos]);
-            ++pos;
-            return &unistr;
-        }
-        return 0;
-    }
-
-    virtual void reset(UErrorCode& /*status*/) {
-        pos = 0;
-    }
-
-public:
-    static UClassID U_EXPORT2 getStaticClassID(void);
-    virtual UClassID getDynamicClassID(void) const;
-};
-
-TZEnumeration::~TZEnumeration() {
-    if (localMap != NULL) {
-        uprv_free(localMap);
-    }
-}
-
-UOBJECT_DEFINE_RTTI_IMPLEMENTATION(TZEnumeration)
-
-StringEnumeration* U_EXPORT2
-TimeZone::createTimeZoneIDEnumeration(
-            USystemTimeZoneType zoneType,
-            const char* region,
-            const int32_t* rawOffset,
-            UErrorCode& ec) {
-    return TZEnumeration::create(zoneType, region, rawOffset, ec);
-}
-
-StringEnumeration* U_EXPORT2
-TimeZone::createEnumeration() {
-    UErrorCode ec = U_ZERO_ERROR;
-    return TZEnumeration::create(UCAL_ZONE_TYPE_ANY, NULL, NULL, ec);
-}
-
-StringEnumeration* U_EXPORT2
-TimeZone::createEnumeration(int32_t rawOffset) {
-    UErrorCode ec = U_ZERO_ERROR;
-    return TZEnumeration::create(UCAL_ZONE_TYPE_ANY, NULL, &rawOffset, ec);
-}
-
-StringEnumeration* U_EXPORT2
-TimeZone::createEnumeration(const char* country) {
-    UErrorCode ec = U_ZERO_ERROR;
-    return TZEnumeration::create(UCAL_ZONE_TYPE_ANY, country, NULL, ec);
-}
-
-// ---------------------------------------
-
-int32_t U_EXPORT2
-TimeZone::countEquivalentIDs(const UnicodeString& id) {
-    int32_t result = 0;
-    UErrorCode ec = U_ZERO_ERROR;
-    UResourceBundle res;
-    ures_initStackObject(&res);
-    U_DEBUG_TZ_MSG(("countEquivalentIDs..\n"));
-    UResourceBundle *top = openOlsonResource(id, res, ec);
-    if (U_SUCCESS(ec)) {
-        UResourceBundle r;
-        ures_initStackObject(&r);
-        ures_getByKey(&res, kLINKS, &r, &ec);
-        ures_getIntVector(&r, &result, &ec);
-        ures_close(&r);
-    }
-    ures_close(&res);
-    ures_close(top);
-    return result;
-}
-
-// ---------------------------------------
-
-const UnicodeString U_EXPORT2
-TimeZone::getEquivalentID(const UnicodeString& id, int32_t index) {
-    U_DEBUG_TZ_MSG(("gEI(%d)\n", index));
-    UnicodeString result;
-    UErrorCode ec = U_ZERO_ERROR;
-    UResourceBundle res;
-    ures_initStackObject(&res);
-    UResourceBundle *top = openOlsonResource(id, res, ec);
-    int32_t zone = -1;
-    if (U_SUCCESS(ec)) {
-        UResourceBundle r;
-        ures_initStackObject(&r);
-        int32_t size;
-        ures_getByKey(&res, kLINKS, &r, &ec);
-        const int32_t* v = ures_getIntVector(&r, &size, &ec);
-        if (U_SUCCESS(ec)) {
-            if (index >= 0 && index < size) {
-                zone = v[index];
-            }
-        }
-        ures_close(&r);
-    }
-    ures_close(&res);
-    if (zone >= 0) {
-        UResourceBundle *ares = ures_getByKey(top, kNAMES, NULL, &ec); // dereference Zones section
-        if (U_SUCCESS(ec)) {
-            int32_t idLen = 0;
-            const UChar* id = ures_getStringByIndex(ares, zone, &idLen, &ec);
-            result.fastCopyFrom(UnicodeString(TRUE, id, idLen));
-            U_DEBUG_TZ_MSG(("gei(%d) -> %d, len%d, %s\n", index, zone, result.length(), u_errorName(ec)));
-        }
-        ures_close(ares);
-    }
-    ures_close(top);
-#if defined(U_DEBUG_TZ)
-    if(result.length() ==0) {
-      U_DEBUG_TZ_MSG(("equiv [__, #%d] -> 0 (%s)\n", index, u_errorName(ec)));
-    }
-#endif
-    return result;
-}
-
-// ---------------------------------------
-
-// These methods are used by ZoneMeta class only.
-
-const UChar*
-TimeZone::findID(const UnicodeString& id) {
-    const UChar *result = NULL;
-    UErrorCode ec = U_ZERO_ERROR;
-    UResourceBundle *rb = ures_openDirect(NULL, kZONEINFO, &ec);
-
-    // resolve zone index by name
-    UResourceBundle *names = ures_getByKey(rb, kNAMES, NULL, &ec);
-    int32_t idx = findInStringArray(names, id, ec);
-    result = ures_getStringByIndex(names, idx, NULL, &ec);
-    if (U_FAILURE(ec)) {
-        result = NULL;
-    }
-    ures_close(names);
-    ures_close(rb);
-    return result;
-}
-
-
-const UChar*
-TimeZone::dereferOlsonLink(const UnicodeString& id) {
-    const UChar *result = NULL;
-    UErrorCode ec = U_ZERO_ERROR;
-    UResourceBundle *rb = ures_openDirect(NULL, kZONEINFO, &ec);
-
-    // resolve zone index by name
-    UResourceBundle *names = ures_getByKey(rb, kNAMES, NULL, &ec);
-    int32_t idx = findInStringArray(names, id, ec);
-    result = ures_getStringByIndex(names, idx, NULL, &ec);
-
-    // open the zone bundle by index
-    ures_getByKey(rb, kZONES, rb, &ec);
-    ures_getByIndex(rb, idx, rb, &ec); 
-
-    if (U_SUCCESS(ec)) {
-        if (ures_getType(rb) == URES_INT) {
-            // this is a link - dereference the link
-            int32_t deref = ures_getInt(rb, &ec);
-            const UChar* tmp = ures_getStringByIndex(names, deref, NULL, &ec);
-            if (U_SUCCESS(ec)) {
-                result = tmp;
-            }
-        }
-    }
-
-    ures_close(names);
-    ures_close(rb);
-
-    return result;
-}
-
-const UChar*
-TimeZone::getRegion(const UnicodeString& id) {
-    UErrorCode status = U_ZERO_ERROR;
-    return getRegion(id, status);
-}
-
-const UChar*
-TimeZone::getRegion(const UnicodeString& id, UErrorCode& status) {
-    if (U_FAILURE(status)) {
-        return NULL;
-    }
-    const UChar *result = NULL;
-    UResourceBundle *rb = ures_openDirect(NULL, kZONEINFO, &status);
-
-    // resolve zone index by name
-    UResourceBundle *res = ures_getByKey(rb, kNAMES, NULL, &status);
-    int32_t idx = findInStringArray(res, id, status);
-
-    // get region mapping
-    ures_getByKey(rb, kREGIONS, res, &status);
-    const UChar *tmp = ures_getStringByIndex(res, idx, NULL, &status);
-    if (U_SUCCESS(status)) {
-        result = tmp;
-    }
-
-    ures_close(res);
-    ures_close(rb);
-
-    return result;
-}
-
-
-// ---------------------------------------
-int32_t
-TimeZone::getRegion(const UnicodeString& id, char *region, int32_t capacity, UErrorCode& status)
-{
-    int32_t resultLen = 0;
-    *region = 0;
-    if (U_FAILURE(status)) {
-        return 0;
-    }
-
-    const UChar *uregion = NULL;
-    // "Etc/Unknown" is not a system zone ID,
-    // but in the zone data
-    if (id.compare(UNKNOWN_ZONE_ID, UNKNOWN_ZONE_ID_LENGTH) != 0) {
-        uregion = getRegion(id);
-    }
-    if (uregion == NULL) {
-        status = U_ILLEGAL_ARGUMENT_ERROR;
-        return 0;
-    }
-    resultLen = u_strlen(uregion);
-    // A region code is represented by invariant characters
-    u_UCharsToChars(uregion, region, uprv_min(resultLen, capacity));
-
-    if (capacity < resultLen) {
-        status = U_BUFFER_OVERFLOW_ERROR;
-        return resultLen;
-    }
-
-    return u_terminateChars(region, capacity, resultLen, &status);
-}
-
-// ---------------------------------------
-
-
-UnicodeString&
-TimeZone::getDisplayName(UnicodeString& result) const
-{
-    return getDisplayName(FALSE,LONG,Locale::getDefault(), result);
-}
-
-UnicodeString&
-TimeZone::getDisplayName(const Locale& locale, UnicodeString& result) const
-{
-    return getDisplayName(FALSE, LONG, locale, result);
-}
-
-UnicodeString&
-TimeZone::getDisplayName(UBool daylight, EDisplayType style, UnicodeString& result)  const
-{
-    return getDisplayName(daylight,style, Locale::getDefault(), result);
-}
-//--------------------------------------
-int32_t
-TimeZone::getDSTSavings()const {
-    if (useDaylightTime()) {
-        return 3600000;
-    }
-    return 0;
-}
-//---------------------------------------
-UnicodeString&
-TimeZone::getDisplayName(UBool daylight, EDisplayType style, const Locale& locale, UnicodeString& result) const
-{
-    UErrorCode status = U_ZERO_ERROR;
-    UDate date = Calendar::getNow();
-    UTimeZoneFormatTimeType timeType;
-    int32_t offset;
-
-    if (style == GENERIC_LOCATION || style == LONG_GENERIC || style == SHORT_GENERIC) {
-        LocalPointer<TimeZoneFormat> tzfmt(TimeZoneFormat::createInstance(locale, status));
-        if (U_FAILURE(status)) {
-            result.remove();
-            return result;
-        }
-        // Generic format
-        switch (style) {
-        case GENERIC_LOCATION:
-            tzfmt->format(UTZFMT_STYLE_GENERIC_LOCATION, *this, date, result, &timeType);
-            break;
-        case LONG_GENERIC:
-            tzfmt->format(UTZFMT_STYLE_GENERIC_LONG, *this, date, result, &timeType);
-            break;
-        case SHORT_GENERIC:
-            tzfmt->format(UTZFMT_STYLE_GENERIC_SHORT, *this, date, result, &timeType);
-            break;
-        default:
-            U_ASSERT(FALSE);
-        }
-        // Generic format many use Localized GMT as the final fallback.
-        // When Localized GMT format is used, the result might not be
-        // appropriate for the requested daylight value.
-        if ((daylight && timeType == UTZFMT_TIME_TYPE_STANDARD) || (!daylight && timeType == UTZFMT_TIME_TYPE_DAYLIGHT)) {
-            offset = daylight ? getRawOffset() + getDSTSavings() : getRawOffset();
-            if (style == SHORT_GENERIC) {
-                tzfmt->formatOffsetShortLocalizedGMT(offset, result, status);
-            } else {
-                tzfmt->formatOffsetLocalizedGMT(offset, result, status);
-            }
-        }
-    } else if (style == LONG_GMT || style == SHORT_GMT) {
-        LocalPointer<TimeZoneFormat> tzfmt(TimeZoneFormat::createInstance(locale, status));
-        if (U_FAILURE(status)) {
-            result.remove();
-            return result;
-        }
-        offset = daylight && useDaylightTime() ? getRawOffset() + getDSTSavings() : getRawOffset();
-        switch (style) {
-        case LONG_GMT:
-            tzfmt->formatOffsetLocalizedGMT(offset, result, status);
-            break;
-        case SHORT_GMT:
-            tzfmt->formatOffsetISO8601Basic(offset, FALSE, FALSE, FALSE, result, status);
-            break;
-        default:
-            U_ASSERT(FALSE);
-        }
-
-    } else {
-        U_ASSERT(style == LONG || style == SHORT || style == SHORT_COMMONLY_USED);
-        UTimeZoneNameType nameType = UTZNM_UNKNOWN;
-        switch (style) {
-        case LONG:
-            nameType = daylight ? UTZNM_LONG_DAYLIGHT : UTZNM_LONG_STANDARD;
-            break;
-        case SHORT:
-        case SHORT_COMMONLY_USED:
-            nameType = daylight ? UTZNM_SHORT_DAYLIGHT : UTZNM_SHORT_STANDARD;
-            break;
-        default:
-            U_ASSERT(FALSE);
-        }
-        LocalPointer<TimeZoneNames> tznames(TimeZoneNames::createInstance(locale, status));
-        if (U_FAILURE(status)) {
-            result.remove();
-            return result;
-        }
-        UnicodeString canonicalID(ZoneMeta::getCanonicalCLDRID(*this));
-        tznames->getDisplayName(canonicalID, nameType, date, result);
-        if (result.isEmpty()) {
-            // Fallback to localized GMT
-            LocalPointer<TimeZoneFormat> tzfmt(TimeZoneFormat::createInstance(locale, status));
-            offset = daylight && useDaylightTime() ? getRawOffset() + getDSTSavings() : getRawOffset();
-            if (style == LONG) {
-                tzfmt->formatOffsetLocalizedGMT(offset, result, status);
-            } else {
-                tzfmt->formatOffsetShortLocalizedGMT(offset, result, status);
-            }
-        }
-    }
-    if (U_FAILURE(status)) {
-        result.remove();
-    }
-    return  result;
-}
-
-/**
- * Parse a custom time zone identifier and return a corresponding zone.
- * @param id a string of the form GMT[+-]hh:mm, GMT[+-]hhmm, or
- * GMT[+-]hh.
- * @return a newly created SimpleTimeZone with the given offset and
- * no Daylight Savings Time, or null if the id cannot be parsed.
-*/
-TimeZone*
-TimeZone::createCustomTimeZone(const UnicodeString& id)
-{
-    int32_t sign, hour, min, sec;
-    if (parseCustomID(id, sign, hour, min, sec)) {
-        UnicodeString customID;
-        formatCustomID(hour, min, sec, (sign < 0), customID);
-        int32_t offset = sign * ((hour * 60 + min) * 60 + sec) * 1000;
-        return new SimpleTimeZone(offset, customID);
-    }
-    return NULL;
-}
-
-UnicodeString&
-TimeZone::getCustomID(const UnicodeString& id, UnicodeString& normalized, UErrorCode& status) {
-    normalized.remove();
-    if (U_FAILURE(status)) {
-        return normalized;
-    }
-    int32_t sign, hour, min, sec;
-    if (parseCustomID(id, sign, hour, min, sec)) {
-        formatCustomID(hour, min, sec, (sign < 0), normalized);
-    } else {
-        status = U_ILLEGAL_ARGUMENT_ERROR;
-    }
-    return normalized;
-}
-
-UBool
-TimeZone::parseCustomID(const UnicodeString& id, int32_t& sign,
-                        int32_t& hour, int32_t& min, int32_t& sec) {
-    static const int32_t         kParseFailed = -99999;
-
-    NumberFormat* numberFormat = 0;
-    UnicodeString idUppercase = id;
-    idUppercase.toUpper("");
-
-    if (id.length() > GMT_ID_LENGTH &&
-        idUppercase.startsWith(GMT_ID, GMT_ID_LENGTH))
-    {
-        ParsePosition pos(GMT_ID_LENGTH);
-        sign = 1;
-        hour = 0;
-        min = 0;
-        sec = 0;
-
-        if (id[pos.getIndex()] == MINUS /*'-'*/) {
-            sign = -1;
-        } else if (id[pos.getIndex()] != PLUS /*'+'*/) {
-            return FALSE;
-        }
-        pos.setIndex(pos.getIndex() + 1);
-
-        UErrorCode success = U_ZERO_ERROR;
-        numberFormat = NumberFormat::createInstance(success);
-        if(U_FAILURE(success)){
-            return FALSE;
-        }
-        numberFormat->setParseIntegerOnly(TRUE);
-        //numberFormat->setLenient(TRUE); // TODO: May need to set this, depends on latest timezone parsing
-
-        // Look for either hh:mm, hhmm, or hh
-        int32_t start = pos.getIndex();
-        Formattable n(kParseFailed);
-        numberFormat->parse(id, n, pos);
-        if (pos.getIndex() == start) {
-            delete numberFormat;
-            return FALSE;
-        }
-        hour = n.getLong();
-
-        if (pos.getIndex() < id.length()) {
-            if (pos.getIndex() - start > 2
-                || id[pos.getIndex()] != COLON) {
-                delete numberFormat;
-                return FALSE;
-            }
-            // hh:mm
-            pos.setIndex(pos.getIndex() + 1);
-            int32_t oldPos = pos.getIndex();
-            n.setLong(kParseFailed);
-            numberFormat->parse(id, n, pos);
-            if ((pos.getIndex() - oldPos) != 2) {
-                // must be 2 digits
-                delete numberFormat;
-                return FALSE;
-            }
-            min = n.getLong();
-            if (pos.getIndex() < id.length()) {
-                if (id[pos.getIndex()] != COLON) {
-                    delete numberFormat;
-                    return FALSE;
-                }
-                // [:ss]
-                pos.setIndex(pos.getIndex() + 1);
-                oldPos = pos.getIndex();
-                n.setLong(kParseFailed);
-                numberFormat->parse(id, n, pos);
-                if (pos.getIndex() != id.length()
-                        || (pos.getIndex() - oldPos) != 2) {
-                    delete numberFormat;
-                    return FALSE;
-                }
-                sec = n.getLong();
-            }
-        } else {
-            // Supported formats are below -
-            //
-            // HHmmss
-            // Hmmss
-            // HHmm
-            // Hmm
-            // HH
-            // H
-
-            int32_t length = pos.getIndex() - start;
-            if (length <= 0 || 6 < length) {
-                // invalid length
-                delete numberFormat;
-                return FALSE;
-            }
-            switch (length) {
-                case 1:
-                case 2:
-                    // already set to hour
-                    break;
-                case 3:
-                case 4:
-                    min = hour % 100;
-                    hour /= 100;
-                    break;
-                case 5:
-                case 6:
-                    sec = hour % 100;
-                    min = (hour/100) % 100;
-                    hour /= 10000;
-                    break;
-            }
-        }
-
-        delete numberFormat;
-
-        if (hour > kMAX_CUSTOM_HOUR || min > kMAX_CUSTOM_MIN || sec > kMAX_CUSTOM_SEC) {
-            return FALSE;
-        }
-        return TRUE;
-    }
-    return FALSE;
-}
-
-UnicodeString&
-TimeZone::formatCustomID(int32_t hour, int32_t min, int32_t sec,
-                         UBool negative, UnicodeString& id) {
-    // Create time zone ID - GMT[+|-]hhmm[ss]
-    id.setTo(GMT_ID, GMT_ID_LENGTH);
-    if (hour | min | sec) {
-        if (negative) {
-            id += (UChar)MINUS;
-        } else {
-            id += (UChar)PLUS;
-        }
-
-        if (hour < 10) {
-            id += (UChar)ZERO_DIGIT;
-        } else {
-            id += (UChar)(ZERO_DIGIT + hour/10);
-        }
-        id += (UChar)(ZERO_DIGIT + hour%10);
-        id += (UChar)COLON;
-        if (min < 10) {
-            id += (UChar)ZERO_DIGIT;
-        } else {
-            id += (UChar)(ZERO_DIGIT + min/10);
-        }
-        id += (UChar)(ZERO_DIGIT + min%10);
-
-        if (sec) {
-            id += (UChar)COLON;
-            if (sec < 10) {
-                id += (UChar)ZERO_DIGIT;
-            } else {
-                id += (UChar)(ZERO_DIGIT + sec/10);
-            }
-            id += (UChar)(ZERO_DIGIT + sec%10);
-        }
-    }
-    return id;
-}
-
-
-UBool
-TimeZone::hasSameRules(const TimeZone& other) const
-{
-    return (getRawOffset() == other.getRawOffset() &&
-            useDaylightTime() == other.useDaylightTime());
-}
-
-static void U_CALLCONV initTZDataVersion(UErrorCode &status) {
-    ucln_i18n_registerCleanup(UCLN_I18N_TIMEZONE, timeZone_cleanup);
-    int32_t len = 0;
-    UResourceBundle *bundle = ures_openDirect(NULL, kZONEINFO, &status);
-    const UChar *tzver = ures_getStringByKey(bundle, kTZVERSION, &len, &status);
-
-    if (U_SUCCESS(status)) {
-        if (len >= (int32_t)sizeof(TZDATA_VERSION)) {
-            // Ensure that there is always space for a trailing nul in TZDATA_VERSION
-            len = sizeof(TZDATA_VERSION) - 1;
-        }
-        u_UCharsToChars(tzver, TZDATA_VERSION, len);
-    }
-    ures_close(bundle);
-
-}
-
-const char*
-TimeZone::getTZDataVersion(UErrorCode& status)
-{
-    umtx_initOnce(gTZDataVersionInitOnce, &initTZDataVersion, status);
-    return (const char*)TZDATA_VERSION;
-}
-
-UnicodeString&
-TimeZone::getCanonicalID(const UnicodeString& id, UnicodeString& canonicalID, UErrorCode& status)
-{
-    UBool isSystemID = FALSE;
-    return getCanonicalID(id, canonicalID, isSystemID, status);
-}
-
-UnicodeString&
-TimeZone::getCanonicalID(const UnicodeString& id, UnicodeString& canonicalID, UBool& isSystemID,
-                         UErrorCode& status)
-{
-    canonicalID.remove();
-    isSystemID = FALSE;
-    if (U_FAILURE(status)) {
-        return canonicalID;
-    }
-    if (id.compare(UNKNOWN_ZONE_ID, UNKNOWN_ZONE_ID_LENGTH) == 0) {
-        // special case - Etc/Unknown is a canonical ID, but not system ID
-        canonicalID.fastCopyFrom(id);
-        isSystemID = FALSE;
-    } else {
-        ZoneMeta::getCanonicalCLDRID(id, canonicalID, status);
-        if (U_SUCCESS(status)) {
-            isSystemID = TRUE;
-        } else {
-            // Not a system ID
-            status = U_ZERO_ERROR;
-            getCustomID(id, canonicalID, status);
-        }
-    }
-    return canonicalID;
-}
-
-UnicodeString&
-TimeZone::getWindowsID(const UnicodeString& id, UnicodeString& winid, UErrorCode& status) {
-    winid.remove();
-    if (U_FAILURE(status)) {
-        return winid;
-    }
-
-    // canonicalize the input ID
-    UnicodeString canonicalID;
-    UBool isSystemID = FALSE;
-
-    getCanonicalID(id, canonicalID, isSystemID, status);
-    if (U_FAILURE(status) || !isSystemID) {
-        // mapping data is only applicable to tz database IDs
-        if (status == U_ILLEGAL_ARGUMENT_ERROR) {
-            // getWindowsID() sets an empty string where
-            // getCanonicalID() sets a U_ILLEGAL_ARGUMENT_ERROR.
-            status = U_ZERO_ERROR;
-        }
-        return winid;
-    }
-
-    UResourceBundle *mapTimezones = ures_openDirect(NULL, "windowsZones", &status);
-    ures_getByKey(mapTimezones, "mapTimezones", mapTimezones, &status);
-
-    if (U_FAILURE(status)) {
-        return winid;
-    }
-
-    UResourceBundle *winzone = NULL;
-    UBool found = FALSE;
-    while (ures_hasNext(mapTimezones) && !found) {
-        winzone = ures_getNextResource(mapTimezones, winzone, &status);
-        if (U_FAILURE(status)) {
-            break;
-        }
-        if (ures_getType(winzone) != URES_TABLE) {
-            continue;
-        }
-        UResourceBundle *regionalData = NULL;
-        while (ures_hasNext(winzone) && !found) {
-            regionalData = ures_getNextResource(winzone, regionalData, &status);
-            if (U_FAILURE(status)) {
-                break;
-            }
-            if (ures_getType(regionalData) != URES_STRING) {
-                continue;
-            }
-            int32_t len;
-            const UChar *tzids = ures_getString(regionalData, &len, &status);
-            if (U_FAILURE(status)) {
-                break;
-            }
-
-            const UChar *start = tzids;
-            UBool hasNext = TRUE;
-            while (hasNext) {
-                const UChar *end = u_strchr(start, (UChar)0x20);
-                if (end == NULL) {
-                    end = tzids + len;
-                    hasNext = FALSE;
-                }
-                if (canonicalID.compare(start, end - start) == 0) {
-                    winid = UnicodeString(ures_getKey(winzone), -1 , US_INV);
-                    found = TRUE;
-                    break;
-                }
-                start = end + 1;
-            }
-        }
-        ures_close(regionalData);
-    }
-    ures_close(winzone);
-    ures_close(mapTimezones);
-
-    return winid;
-}
-
-#define MAX_WINDOWS_ID_SIZE 128
-
-UnicodeString&
-TimeZone::getIDForWindowsID(const UnicodeString& winid, const char* region, UnicodeString& id, UErrorCode& status) {
-    id.remove();
-    if (U_FAILURE(status)) {
-        return id;
-    }
-
-    UResourceBundle *zones = ures_openDirect(NULL, "windowsZones", &status);
-    ures_getByKey(zones, "mapTimezones", zones, &status);
-    if (U_FAILURE(status)) {
-        ures_close(zones);
-        return id;
-    }
-
-    UErrorCode tmperr = U_ZERO_ERROR;
-    char winidKey[MAX_WINDOWS_ID_SIZE];
-    int32_t winKeyLen = winid.extract(0, winid.length(), winidKey, sizeof(winidKey) - 1, US_INV);
-
-    if (winKeyLen == 0 || winKeyLen >= (int32_t)sizeof(winidKey)) {
-        ures_close(zones);
-        return id;
-    }
-    winidKey[winKeyLen] = 0;
-
-    ures_getByKey(zones, winidKey, zones, &tmperr); // use tmperr, because windows mapping might not
-                                                    // be avaiable by design
-    if (U_FAILURE(tmperr)) {
-        ures_close(zones);
-        return id;
-    }
-
-    const UChar *tzid = NULL;
-    int32_t len = 0;
-    UBool gotID = FALSE;
-    if (region) {
-        const UChar *tzids = ures_getStringByKey(zones, region, &len, &tmperr); // use tmperr, because
-                                                                                // regional mapping is optional
-        if (U_SUCCESS(tmperr)) {
-            // first ID delimited by space is the defasult one
-            const UChar *end = u_strchr(tzids, (UChar)0x20);
-            if (end == NULL) {
-                id.setTo(tzids, -1);
-            } else {
-                id.setTo(tzids, end - tzids);
-            }
-            gotID = TRUE;
-        }
-    }
-
-    if (!gotID) {
-        tzid = ures_getStringByKey(zones, "001", &len, &status);    // using status, because "001" must be
-                                                                // available at this point
-        if (U_SUCCESS(status)) {
-            id.setTo(tzid, len);
-        }
-    }
-
-    ures_close(zones);
-    return id;
-}
-
-
-U_NAMESPACE_END
-
-#endif /* #if !UCONFIG_NO_FORMATTING */
-
-//eof
